import{a as ce}from"./chunk-DVZH33S7.js";import"./chunk-XMZSZHZZ.js";import{b as me}from"./chunk-2FKGSZ6Y.js";import{a as se,b as de}from"./chunk-QZIFPMOZ.js";import{a as ge}from"./chunk-IHOIJJLM.js";import{b as Z,c as $,f as ee,h as te,i as ne,j as ie,k as re,l as ae,n as oe}from"./chunk-3XLOQSKB.js";import{a as le}from"./chunk-KD2IJGWA.js";import{d as U,e as W,f as H,i as Y,s as J,t as K,u as Q,w as X}from"./chunk-PGUYAPD4.js";import{$b as P,Ab as a,Bb as o,Cb as g,Gb as D,Lb as b,Nb as x,Vb as s,Wb as G,Xb as k,Zb as E,_a as F,_b as O,bc as B,cc as I,db as c,dc as R,eb as S,f as ue,h as V,na as A,tb as C,vb as u,wa as w,xa as _,ya as j}from"./chunk-7ZC2CAVG.js";var d=ue(ge());var N="0123456789bcdefghjkmnpqrstuvwxyz",T=class r{static encode(e,t,n){if(typeof n>"u"){for(let f=1;f<=12;f++){let v=r.encode(e,t,f),q=r.decode(v);if(q.lat==e&&q.lon==t)return v}n=12}if(e=Number(e),t=Number(t),n=Number(n),isNaN(e)||isNaN(t)||isNaN(n))throw new Error("Invalid geohash");let i=0,l=0,m=!0,p="",h=-90,L=90,M=-180,y=180;for(;p.length<n;){if(m){let f=(M+y)/2;t>=f?(i=i*2+1,M=f):(i=i*2,y=f)}else{let f=(h+L)/2;e>=f?(i=i*2+1,h=f):(i=i*2,L=f)}m=!m,++l==5&&(p+=N.charAt(i),l=0,i=0)}return p}static decode(e){let t=r.bounds(e),n=t.sw.lat,i=t.sw.lon,l=t.ne.lat,m=t.ne.lon,p=(n+l)/2,h=(i+m)/2;return p=p.toFixed(Math.floor(2-Math.log(l-n)/Math.LN10)),h=h.toFixed(Math.floor(2-Math.log(m-i)/Math.LN10)),{lat:Number(p),lon:Number(h)}}static bounds(e){if(e.length==0)throw new Error("Invalid geohash");e=e.toLowerCase();let t=!0,n=-90,i=90,l=-180,m=180;for(let h=0;h<e.length;h++){let L=e.charAt(h),M=N.indexOf(L);if(M==-1)throw new Error("Invalid geohash");for(let y=4;y>=0;y--){let f=M>>y&1;if(t){let v=(l+m)/2;f==1?l=v:m=v}else{let v=(n+i)/2;f==1?n=v:i=v}t=!t}}return{sw:{lat:n,lon:l},ne:{lat:i,lon:m}}}static adjacent(e,t){if(e=e.toLowerCase(),t=t.toLowerCase(),e.length==0)throw new Error("Invalid geohash");if("nsew".indexOf(t)==-1)throw new Error("Invalid direction");let n={n:["p0r21436x8zb9dcf5h7kjnmqesgutwvy","bc01fg45238967deuvhjyznpkmstqrwx"],s:["14365h7k9dcfesgujnmqp0r2twvyx8zb","238967debc01fg45kmstqrwxuvhjyznp"],e:["bc01fg45238967deuvhjyznpkmstqrwx","p0r21436x8zb9dcf5h7kjnmqesgutwvy"],w:["238967debc01fg45kmstqrwxuvhjyznp","14365h7k9dcfesgujnmqp0r2twvyx8zb"]},i={n:["prxz","bcfguvyz"],s:["028b","0145hjnp"],e:["bcfguvyz","prxz"],w:["0145hjnp","028b"]},l=e.slice(-1),m=e.slice(0,-1),p=e.length%2;return i[t][p].indexOf(l)!=-1&&m!=""&&(m=r.adjacent(m,t)),m+N.charAt(n[t][p].indexOf(l))}static neighbours(e){return{n:r.adjacent(e,"n"),ne:r.adjacent(r.adjacent(e,"n"),"e"),e:r.adjacent(e,"e"),se:r.adjacent(r.adjacent(e,"s"),"e"),s:r.adjacent(e,"s"),sw:r.adjacent(r.adjacent(e,"s"),"w"),w:r.adjacent(e,"w"),nw:r.adjacent(r.adjacent(e,"n"),"w")}}},z=T;var he=r=>({"border-b":r}),fe=()=>({exact:!0});function be(r,e){r&1&&(j(),a(0,"svg",39),g(1,"path",40),o())}function xe(r,e){r&1&&(j(),a(0,"svg",39),g(1,"path",41),o())}function ve(r,e){if(r&1){let t=D();a(0,"div",42)(1,"ul",43)(2,"li")(3,"a",44),b("click",function(){w(t);let i=x();return _(i.open=!1)}),g(4,"i",9),s(5," Home "),o()(),a(6,"li")(7,"a",45),b("click",function(){w(t);let i=x();return _(i.open=!1)}),g(8,"i",11),s(9," Events "),o()(),a(10,"li")(11,"a",46),b("click",function(){w(t);let i=x();return _(i.open=!1)}),g(12,"i",13),s(13," Forum "),o()(),a(14,"li")(15,"a",47),b("click",function(){w(t);let i=x();return _(i.open=!1)}),g(16,"i",15),s(17," Profile "),o()()()()}r&2&&(c(3),u("routerLinkActiveOptions",I(1,fe)))}function ye(r,e){r&1&&g(0,"div",48)}function we(r,e){r&1&&(a(0,"div",57),s(1," Loading garden details... "),o())}function _e(r,e){if(r&1&&(a(0,"swiper-slide"),g(1,"img",69),o()),r&2){let t=e.index,n=x(3);c(),u("src",n.garden.images[t],F)}}function Ce(r,e){if(r&1&&(a(0,"div",58)(1,"div")(2,"div",59)(3,"h2",60),s(4),o(),a(5,"p",61),s(6," Size: "),a(7,"span",62),s(8),o()()(),a(9,"swiper-container",63),C(10,_e,2,1,"swiper-slide",64),o(),a(11,"div",65)(12,"h3",66),s(13,"Garden Details"),o(),a(14,"p",67),s(15),o(),a(16,"p",67),s(17),o(),a(18,"p",68),s(19),o()()()()),r&2){let t=x(2);c(4),G(t.garden.name),c(4),k("",t.garden.sqft," sqft"),c(),u("slidesPerView",1.14)("centeredSlides",!0)("initialSlide",0)("threshold",5)("mousewheel",!1)("spaceBetween",20),c(),u("ngForOf",t.garden.images),c(5),k("Created by: ",t.garden.username,""),c(2),k("Type: ",t.garden.type,""),c(2),G(t.garden.description)}}function Me(r,e){if(r&1){let t=D();a(0,"div",49)(1,"div",50)(2,"h2",51),s(3,"Garden Details"),o(),a(4,"div",52),C(5,we,2,0,"div",53)(6,Ce,20,12,"div",54),a(7,"div",55)(8,"button",56),b("click",function(){w(t);let i=x();return _(i.closeModal())}),s(9," Close "),o()()()()()}if(r&2){let t=x();c(5),u("ngIf",!t.garden),c(),u("ngIf",t.garden)}}var pe=class r{constructor(e,t,n,i){this.authService=e;this.dialog=t;this.router=n;this.gardenService=i}nearbyGardens=[];map;searchControl;userMarker;filter={distance:5,category:"",minSqft:0,maxSqft:100};radiusCircle=null;selectedCenter=null;templatlong;showModal=!1;garden;open=!1;ngOnInit(){this.initMap(),this.getUserLocation(),d.Icon.Default.imagePath="assets/",this.map.on("click",e=>{console.log("event",e),this.setSelectedCenter(e.latlng)})}navigateTo(e){}uploadGarden(){}manageGarden(){}showNearbyGardens(){}filterGardens(){}initMap(){this.map=d.map("map").setView([51.505,-.09],50);let e=new de;this.searchControl=new se({provider:e}),this.map.addControl(this.searchControl),d.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"\xA9 OpenStreetMap contributors"}).addTo(this.map);let t=d.control.attribution({position:"topright"});t.onAdd=n=>{let i=d.DomUtil.create("div","leaflet-control-locate leaflet-bar leaflet-control"),l=d.DomUtil.create("a","leaflet-bar-part leaflet-bar-part-single",i);return l.title="My location",l.innerHTML='<i class="fas fa-map-marker-alt"></i>',d.DomEvent.on(l,"click",m=>{d.DomEvent.stopPropagation(m),this.clearPreviousPoint(),this.getUserLocation()}),i},t.addTo(this.map)}getUserLocation(){navigator.geolocation?navigator.geolocation.getCurrentPosition(e=>{let t=e.coords.latitude,n=e.coords.longitude,i={lat:t,lng:n};this.selectedCenter=i,this.showPositionOnMap(t,n),this.fetchNearbyGardens(t,n),this.templatlong=i},e=>{console.error("Error getting location",e)}):console.error("Geolocation is not supported by this browser.")}showPositionOnMap(e,t){this.map.setView([e,t],13),d.marker([e,t]).addTo(this.map).bindPopup("You are here!").openPopup(),this.updateRadiusCircle(e,t,this.filter.distance)}openUploadGardenPage(){this.router.navigate(["/garden/upload-garden"])}logout(){this.authService.logout()}updateRadiusCircle(e,t,n){this.radiusCircle&&this.map.removeLayer(this.radiusCircle),this.radiusCircle=d.circle([e,t],{color:"blue",fillColor:"#3388ff",fillOpacity:.1,radius:n*1e3}).addTo(this.map)}showGardensOnMap(e){for(let t of e){let n=t.images&&t.images.length>0?t.images[0]:"assets/default-garden-icon.png",i=d.divIcon({className:"custom-garden-icon",html:`
          <div class="rounded-full border-4 border-blue-500 overflow-hidden" style="width: 40px; height: 40px;">
            <img src="${n}" alt="Garden Image" class="w-full h-full object-cover">
          </div>
        `});d.marker([t.latitude,t.longitude],{icon:i}).addTo(this.map).on("click",()=>{this.showModal=!0,this.garden=t})}}fetchNearbyGardens(e,t){return this.gardenService.getNearbyGardens(e,t,this.filter.distance).then(({matchingDocs:n,bounds:i})=>{this.nearbyGardens=n,console.log("garden",this.nearbyGardens),this.showGardensOnMap(n)}).catch(n=>{console.error("Error fetching nearby gardens:",n)})}applyFilters(){let e=this.selectedCenter||this.map.getCenter();if(console.log("this.map.getCenter();",this.map.getCenter()),console.log("this.selectedCenter",this.selectedCenter),console.log("filter",this.filter),console.log("center",e),!e){console.log("center is not there");return}this.fetchNearbyGardens(e.lat,e.lng).then(()=>V(this,null,function*(){yield this.filterNearbyGardens(),this.showGardensOnMap(this.nearbyGardens),this.updateRadiusCircle(e.lat,e.lng,this.filter.distance)}))}filterNearbyGardens(){this.nearbyGardens=this.nearbyGardens.filter(e=>{let t=this.filter.category===""||e.type===this.filter.category,n=(this.filter.minSqft===0||e.sqft>=this.filter.minSqft)&&(this.filter.maxSqft===0||e.sqft<=this.filter.maxSqft);return t&&n}),this.clearGardenMarkers()}clearGardenMarkers(){this.map.eachLayer(e=>{e instanceof d.Marker&&e!==this.userMarker&&this.map.removeLayer(e)}),console.log("this.templatlong",this.templatlong),this.setSelectedCenter(this.templatlong)}setSelectedCenter(e){console.log("latlng",e),this.selectedCenter=e,this.clearPreviousPoint(),d.marker(e).addTo(this.map).bindPopup("Selected Center").openPopup(),this.templatlong=e,console.log("this.templatlong",this.templatlong)}clearPreviousPoint(){this.map.eachLayer(e=>{e instanceof d.Marker&&e!==this.userMarker&&this.map.removeLayer(e)})}getGardens(e,t){}drawGeohashBoundsOnMap(e){e.forEach(t=>{let n=t[0],i=t[1],l=z.bounds(n),m=z.bounds(i),p=[[l.sw.lat,l.sw.lon],[l.sw.lat,m.ne.lon],[m.ne.lat,m.ne.lon],[m.ne.lat,l.sw.lon]];console.log("Drawing geohash rectangle:",p),d.rectangle(p,{color:"#FF0000",weight:2,opacity:.8,fillColor:"#FF0000",fillOpacity:.35}).addTo(this.map)})}closeModal(){this.showModal=!1}copyGardenUrl(){}static \u0275fac=function(t){return new(t||r)(S(le),S(ce),S(J),S(me))};static \u0275cmp=A({type:r,selectors:[["app-dashboard"]],standalone:!0,features:[B],decls:63,vars:14,consts:[[1,"flex","flex-col","h-screen"],[1,"navbar","bg-base-100","shadow-md",3,"ngClass"],[1,"navbar-start","flex","items-center"],["aria-label","Toggle navigation",1,"lg:hidden","p-2","focus:outline-none",3,"click"],["class","w-6 h-6 text-gray-600","fill","none","stroke","currentColor","viewBox","0 0 24 24","xmlns","http://www.w3.org/2000/svg",4,"ngIf"],[1,"btn","btn-ghost","normal-case","text-xl","ml-2"],[1,"navbar-center","hidden","lg:flex"],[1,"menu","menu-horizontal","px-1","space-x-4"],["routerLink","/user/dashboard","routerLinkActive","text-primary",3,"routerLinkActiveOptions"],[1,"fas","fa-home","mr-2"],["routerLink","/event/overview"],[1,"fas","fa-calendar","mr-2"],["routerLink","/forum/overview"],[1,"fas","fa-comments","mr-2"],["routerLink","/user/profile"],[1,"fas","fa-user","mr-2"],[1,"navbar-end"],[1,"btn","btn-primary",3,"click"],["class","lg:hidden z-20 absolute top-14 left-0 right-0 bg-base-100 shadow-lg",4,"ngIf"],[1,"relative","flex-1"],[1,"absolute","inset-0","z-0"],["id","map",1,"w-full","h-full"],[1,"absolute","bottom-0","left-0","w-full","bg-base-200","shadow-lg","p-4","flex","flex-wrap","justify-center","items-center","space-x-4","z-10"],[1,"form-control","w-48"],["for","distance",1,"label"],[1,"label-text"],["type","range","id","distance","name","distance","min","1","max","20",1,"range","range-primary",3,"ngModelChange","ngModel"],[1,"text-sm","text-gray-500","mt-1"],["for","category",1,"label"],["id","category","name","category",1,"select","select-bordered","w-full",3,"ngModelChange","ngModel"],["value",""],["value","community"],["value","private"],["for","maxSqft",1,"label"],["type","number","id","maxSqft","name","maxSqft",1,"input","input-bordered","w-full",3,"ngModelChange","ngModel"],[1,"btn","mt-3","btn-primary","w-48","md:mt-5",3,"click"],["routerLink","/garden/manage-garden",1,"btn","mt-3","btn-primary","w-48","md:mt-5"],["class","fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity z-50","aria-hidden","true",4,"ngIf"],["class","fixed inset-0 flex items-center justify-center z-50 bg-base-300 bg-opacity-75",4,"ngIf"],["fill","none","stroke","currentColor","viewBox","0 0 24 24","xmlns","http://www.w3.org/2000/svg",1,"w-6","h-6","text-gray-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M4 6h16M4 12h16m-7 6h7"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M6 18L18 6M6 6l12 12"],[1,"lg:hidden","z-20","absolute","top-14","left-0","right-0","bg-base-100","shadow-lg"],[1,"menu","p-4","space-y-2"],["routerLink","/user/dashboard","routerLinkActive","text-primary",3,"click","routerLinkActiveOptions"],["routerLink","/event/overview",3,"click"],["routerLink","/forum/overview",3,"click"],["routerLink","/user/profile",3,"click"],["aria-hidden","true",1,"fixed","inset-0","bg-gray-500","bg-opacity-75","transition-opacity","z-50"],[1,"fixed","inset-0","flex","items-center","justify-center","z-50","bg-base-300","bg-opacity-75"],[1,"bg-base-100","rounded-lg","shadow-lg","p-6","max-w-4xl","w-full","mx-4"],[1,"text-2xl","font-bold","mb-4","text-base-content"],[1,"p-6","rounded-lg"],["class","text-center text-base-content py-8",4,"ngIf"],["class","flex flex-col gap-8",4,"ngIf"],[1,"mt-6","flex","justify-center"],[1,"btn","btn-secondary",3,"click"],[1,"text-center","text-base-content","py-8"],[1,"flex","flex-col","gap-8"],[1,"mb-6"],[1,"text-3xl","font-extrabold","text-base-content","mb-4"],[1,"text-lg","font-medium","text-base-content"],[1,"text-primary","font-bold"],[1,"swiper","mySwiper","rounded-lg",2,"height","320px",3,"slidesPerView","centeredSlides","initialSlide","threshold","mousewheel","spaceBetween"],[4,"ngFor","ngForOf"],[1,"mt-6"],[1,"text-xl","font-bold","text-base-content","mb-3"],[1,"text-base-content","mb-2"],[1,"text-base-content"],[1,"rounded-lg","w-full",3,"src"]],template:function(t,n){t&1&&(a(0,"div",0)(1,"header",1)(2,"div",2)(3,"button",3),b("click",function(){return n.open=!n.open}),C(4,be,2,0,"svg",4)(5,xe,2,0,"svg",4),o(),a(6,"a",5),s(7,"UrbanRoots"),o()(),a(8,"div",6)(9,"ul",7)(10,"li")(11,"a",8),g(12,"i",9),s(13," Home "),o()(),a(14,"li")(15,"a",10),g(16,"i",11),s(17," Events "),o()(),a(18,"li")(19,"a",12),g(20,"i",13),s(21," Forum "),o()(),a(22,"li")(23,"a",14),g(24,"i",15),s(25," Profile "),o()()()(),a(26,"div",16)(27,"button",17),b("click",function(){return n.logout()}),s(28,"Log Out"),o()()(),C(29,ve,18,2,"div",18),a(30,"main",19)(31,"div",20),g(32,"div",21),o(),a(33,"div",22)(34,"div",23)(35,"label",24)(36,"span",25),s(37,"Distance (km)"),o()(),a(38,"input",26),P("ngModelChange",function(l){return O(n.filter.distance,l)||(n.filter.distance=l),l}),o(),a(39,"p",27),s(40),o()(),a(41,"div",23)(42,"label",28)(43,"span",25),s(44,"Category"),o()(),a(45,"select",29),P("ngModelChange",function(l){return O(n.filter.category,l)||(n.filter.category=l),l}),a(46,"option",30),s(47,"All"),o(),a(48,"option",31),s(49,"Community"),o(),a(50,"option",32),s(51,"Private"),o()()(),a(52,"div",23)(53,"label",33)(54,"span",25),s(55,"Max Sqft"),o()(),a(56,"input",34),P("ngModelChange",function(l){return O(n.filter.maxSqft,l)||(n.filter.maxSqft=l),l}),o()(),a(57,"button",35),b("click",function(){return n.applyFilters()}),s(58," Apply Filters "),o(),a(59,"button",36),s(60," Manage My Gardens "),o()(),C(61,ye,1,0,"div",37)(62,Me,10,2,"div",38),o()()),t&2&&(c(),u("ngClass",R(11,he,!n.open)),c(3),u("ngIf",!n.open),c(),u("ngIf",n.open),c(6),u("routerLinkActiveOptions",I(13,fe)),c(18),u("ngIf",n.open),c(9),E("ngModel",n.filter.distance),c(2),k("Selected: ",n.filter.distance," km"),c(5),E("ngModel",n.filter.category),c(11),E("ngModel",n.filter.maxSqft),c(5),u("ngIf",n.showModal),c(),u("ngIf",n.showModal))},dependencies:[K,X,Q,Y,U,W,H,oe,re,ae,Z,te,ne,ie,$,ee],styles:[".dashboard-container[_ngcontent-%COMP%]{display:flex;height:100vh}.sidebar[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:200px;background-color:#f4f4f4;padding:20px;box-shadow:2px 0 5px #0000001a}.sidebar[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin:10px 0;padding:10px;font-size:16px;cursor:pointer;background-color:#007bff;color:#fff;border:none;border-radius:5px}.main-content[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;padding:20px;position:relative}.bottom-buttons[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin-bottom:20px}.bottom-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{flex:1;margin:0 10px;padding:10px;font-size:16px;cursor:pointer;background-color:#28a745;color:#fff;border:none;border-radius:5px}.nearby-filter[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.nearby-filter[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{flex:1;margin:0 10px;padding:10px;font-size:16px;cursor:pointer;background-color:#17a2b8;color:#fff;border:none;border-radius:5px}.map-container[_ngcontent-%COMP%]{height:55%!important;width:100%;margin:0 0 20px;padding:0;border:1px solid #ccc}.custom-garden-icon[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;box-shadow:0 2px 5px #0003}"]})};export{pe as DashboardComponent};
