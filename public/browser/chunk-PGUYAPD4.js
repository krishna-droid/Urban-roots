import{$ as Ve,$a as nv,A as le,Aa as $h,Ac as wv,B as Iu,Ba as jh,C as vt,Ca as Rt,Cb as uv,D as fo,Da as go,E as x_,Ea as Zn,F as Lh,Fa as Pe,Ga as zh,Ha as Ci,Ia as H_,J as mn,Ja as qh,Jb as Pt,Ka as K_,Kb as Be,L as Di,La as Ct,Lb as cv,M as Qn,Na as Gh,O as Vh,Oa as Wh,P as Si,Pa as $r,Q as F_,Qa as Pi,Qb as lv,Ra as Q_,S as Ur,Sa as Y_,Sb as hv,T as Yn,Ta as J_,Tb as dv,U as Uh,Ua as X_,V as L_,Va as Z_,W as V_,Wa as ev,Xa as tv,Y as U_,Ya as jr,Z as wt,_ as B_,a as q,aa as we,b as Qe,ba as $_,bc as fv,c as R_,cb as Ni,da as X,e as Kb,ea as Jn,eb as De,fa as j_,fb as rv,g as Ht,ga as te,gb as Hh,h as y,ha as Bh,hc as mo,i as C_,ia as Y,ib as iv,ic as pv,j as P_,ja as j,jb as ki,jc as Tu,k as bi,ka as Ue,kb as Kh,kc as Jh,l as kh,la as z_,lc as Xh,m as Oh,ma as po,mb as sv,mc as yo,n as Hn,na as q_,nb as Oi,nc as _o,o as Dt,oa as Xn,oc as Zh,p as N_,pa as yn,pc as Au,q as k_,qa as G_,qb as Qh,r as Kn,ra as gt,rb as ov,rc as gv,s as Mh,sa as W_,sb as Yh,sc as Mi,t as xh,ta as Br,tc as mv,u as Fh,ua as St,ub as av,uc as yv,v as ot,va as Ri,vc as _v,w as K,wc as vv,x as ho,xc as vo,y as O_,z as M_}from"./chunk-7ZC2CAVG.js";var Rv=null;function xi(){return Rv}function Cv(n){Rv??=n}var Ou=class{};var Ye=new te(""),ud=(()=>{let e=class e{historyGo(r){throw new Error("")}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=X({token:e,factory:()=>j(Qb),providedIn:"platform"});let n=e;return n})(),Pv=new te(""),Qb=(()=>{let e=class e extends ud{constructor(){super(),this._doc=j(Ye),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return xi().getBaseHref(this._doc)}onPopState(r){let i=xi().getGlobalEventTarget(this._doc,"window");return i.addEventListener("popstate",r,!1),()=>i.removeEventListener("popstate",r)}onHashChange(r){let i=xi().getGlobalEventTarget(this._doc,"window");return i.addEventListener("hashchange",r,!1),()=>i.removeEventListener("hashchange",r)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(r){this._location.pathname=r}pushState(r,i,s){this._history.pushState(r,i,s)}replaceState(r,i,s){this._history.replaceState(r,i,s)}forward(){this._history.forward()}back(){this._history.back()}historyGo(r=0){this._history.go(r)}getState(){return this._history.state}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=X({token:e,factory:()=>new e,providedIn:"platform"});let n=e;return n})();function cd(n,e){if(n.length==0)return e;if(e.length==0)return n;let t=0;return n.endsWith("/")&&t++,e.startsWith("/")&&t++,t==2?n+e.substring(1):t==1?n+e:n+"/"+e}function Ev(n){let e=n.match(/#|\?|$/),t=e&&e.index||n.length,r=t-(n[t-1]==="/"?1:0);return n.slice(0,r)+n.slice(t)}function vn(n){return n&&n[0]!=="?"?"?"+n:n}var En=(()=>{let e=class e{historyGo(r){throw new Error("")}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=X({token:e,factory:()=>j(ld),providedIn:"root"});let n=e;return n})(),Nv=new te(""),ld=(()=>{let e=class e extends En{constructor(r,i){super(),this._platformLocation=r,this._removeListenerFns=[],this._baseHref=i??this._platformLocation.getBaseHrefFromDOM()??j(Ye).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(r){this._removeListenerFns.push(this._platformLocation.onPopState(r),this._platformLocation.onHashChange(r))}getBaseHref(){return this._baseHref}prepareExternalUrl(r){return cd(this._baseHref,r)}path(r=!1){let i=this._platformLocation.pathname+vn(this._platformLocation.search),s=this._platformLocation.hash;return s&&r?`${i}${s}`:i}pushState(r,i,s,o){let a=this.prepareExternalUrl(s+vn(o));this._platformLocation.pushState(r,i,a)}replaceState(r,i,s,o){let a=this.prepareExternalUrl(s+vn(o));this._platformLocation.replaceState(r,i,a)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(r=0){this._platformLocation.historyGo?.(r)}};e.\u0275fac=function(i){return new(i||e)(Y(ud),Y(Nv,8))},e.\u0275prov=X({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),kv=(()=>{let e=class e extends En{constructor(r,i){super(),this._platformLocation=r,this._baseHref="",this._removeListenerFns=[],i!=null&&(this._baseHref=i)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(r){this._removeListenerFns.push(this._platformLocation.onPopState(r),this._platformLocation.onHashChange(r))}getBaseHref(){return this._baseHref}path(r=!1){let i=this._platformLocation.hash??"#";return i.length>0?i.substring(1):i}prepareExternalUrl(r){let i=cd(this._baseHref,r);return i.length>0?"#"+i:i}pushState(r,i,s,o){let a=this.prepareExternalUrl(s+vn(o));a.length==0&&(a=this._platformLocation.pathname),this._platformLocation.pushState(r,i,a)}replaceState(r,i,s,o){let a=this.prepareExternalUrl(s+vn(o));a.length==0&&(a=this._platformLocation.pathname),this._platformLocation.replaceState(r,i,a)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(r=0){this._platformLocation.historyGo?.(r)}};e.\u0275fac=function(i){return new(i||e)(Y(ud),Y(Nv,8))},e.\u0275prov=X({token:e,factory:e.\u0275fac});let n=e;return n})(),Li=(()=>{let e=class e{constructor(r){this._subject=new Zn,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=r;let i=this._locationStrategy.getBaseHref();this._basePath=Xb(Ev(Iv(i))),this._locationStrategy.onPopState(s=>{this._subject.emit({url:this.path(!0),pop:!0,state:s.state,type:s.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(r=!1){return this.normalize(this._locationStrategy.path(r))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(r,i=""){return this.path()==this.normalize(r+vn(i))}normalize(r){return e.stripTrailingSlash(Jb(this._basePath,Iv(r)))}prepareExternalUrl(r){return r&&r[0]!=="/"&&(r="/"+r),this._locationStrategy.prepareExternalUrl(r)}go(r,i="",s=null){this._locationStrategy.pushState(s,"",r,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(r+vn(i)),s)}replaceState(r,i="",s=null){this._locationStrategy.replaceState(s,"",r,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(r+vn(i)),s)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(r=0){this._locationStrategy.historyGo?.(r)}onUrlChange(r){return this._urlChangeListeners.push(r),this._urlChangeSubscription??=this.subscribe(i=>{this._notifyUrlChangeListeners(i.url,i.state)}),()=>{let i=this._urlChangeListeners.indexOf(r);this._urlChangeListeners.splice(i,1),this._urlChangeListeners.length===0&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(r="",i){this._urlChangeListeners.forEach(s=>s(r,i))}subscribe(r,i,s){return this._subject.subscribe({next:r,error:i,complete:s})}};e.normalizeQueryParams=vn,e.joinWithSlash=cd,e.stripTrailingSlash=Ev,e.\u0275fac=function(i){return new(i||e)(Y(En))},e.\u0275prov=X({token:e,factory:()=>Yb(),providedIn:"root"});let n=e;return n})();function Yb(){return new Li(Y(En))}function Jb(n,e){if(!n||!e.startsWith(n))return e;let t=e.substring(n.length);return t===""||["/",";","?","#"].includes(t[0])?t:e}function Iv(n){return n.replace(/\/index.html$/,"")}function Xb(n){if(new RegExp("^(https?:)?//").test(n)){let[,t]=n.split(/\/\/[^\/]+/);return t}return n}var dt=function(n){return n[n.Format=0]="Format",n[n.Standalone=1]="Standalone",n}(dt||{}),ye=function(n){return n[n.Narrow=0]="Narrow",n[n.Abbreviated=1]="Abbreviated",n[n.Wide=2]="Wide",n[n.Short=3]="Short",n}(ye||{}),Et=function(n){return n[n.Short=0]="Short",n[n.Medium=1]="Medium",n[n.Long=2]="Long",n[n.Full=3]="Full",n}(Et||{}),er={Decimal:0,Group:1,List:2,PercentSign:3,PlusSign:4,MinusSign:5,Exponential:6,SuperscriptingExponent:7,PerMille:8,Infinity:9,NaN:10,TimeSeparator:11,CurrencyDecimal:12,CurrencyGroup:13};function Zb(n){return Pt(n)[Be.LocaleId]}function eD(n,e,t){let r=Pt(n),i=[r[Be.DayPeriodsFormat],r[Be.DayPeriodsStandalone]],s=Nt(i,e);return Nt(s,t)}function tD(n,e,t){let r=Pt(n),i=[r[Be.DaysFormat],r[Be.DaysStandalone]],s=Nt(i,e);return Nt(s,t)}function nD(n,e,t){let r=Pt(n),i=[r[Be.MonthsFormat],r[Be.MonthsStandalone]],s=Nt(i,e);return Nt(s,t)}function rD(n,e){let r=Pt(n)[Be.Eras];return Nt(r,e)}function bu(n,e){let t=Pt(n);return Nt(t[Be.DateFormat],e)}function Du(n,e){let t=Pt(n);return Nt(t[Be.TimeFormat],e)}function Su(n,e){let r=Pt(n)[Be.DateTimeFormat];return Nt(r,e)}function xu(n,e){let t=Pt(n),r=t[Be.NumberSymbols][e];if(typeof r>"u"){if(e===er.CurrencyDecimal)return t[Be.NumberSymbols][er.Decimal];if(e===er.CurrencyGroup)return t[Be.NumberSymbols][er.Group]}return r}function Ov(n){if(!n[Be.ExtraData])throw new Error(`Missing extra locale data for the locale "${n[Be.LocaleId]}". Use "registerLocaleData" to load new data. See the "I18n guide" on angular.io to know more.`)}function iD(n){let e=Pt(n);return Ov(e),(e[Be.ExtraData][2]||[]).map(r=>typeof r=="string"?ed(r):[ed(r[0]),ed(r[1])])}function sD(n,e,t){let r=Pt(n);Ov(r);let i=[r[Be.ExtraData][0],r[Be.ExtraData][1]],s=Nt(i,e)||[];return Nt(s,t)||[]}function Nt(n,e){for(let t=e;t>-1;t--)if(typeof n[t]<"u")return n[t];throw new Error("Locale data API: locale data undefined")}function ed(n){let[e,t]=n.split(":");return{hours:+e,minutes:+t}}var oD=/^(\d{4,})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,Ru={},aD=/((?:[^BEGHLMOSWYZabcdhmswyz']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|Y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|c{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/,wn=function(n){return n[n.Short=0]="Short",n[n.ShortGMT=1]="ShortGMT",n[n.Long=2]="Long",n[n.Extended=3]="Extended",n}(wn||{}),de=function(n){return n[n.FullYear=0]="FullYear",n[n.Month=1]="Month",n[n.Date=2]="Date",n[n.Hours=3]="Hours",n[n.Minutes=4]="Minutes",n[n.Seconds=5]="Seconds",n[n.FractionalSeconds=6]="FractionalSeconds",n[n.Day=7]="Day",n}(de||{}),he=function(n){return n[n.DayPeriods=0]="DayPeriods",n[n.Days=1]="Days",n[n.Months=2]="Months",n[n.Eras=3]="Eras",n}(he||{});function uD(n,e,t,r){let i=yD(n);e=_n(t,e)||e;let o=[],a;for(;e;)if(a=aD.exec(e),a){o=o.concat(a.slice(1));let d=o.pop();if(!d)break;e=d}else{o.push(e);break}let c=i.getTimezoneOffset();r&&(c=xv(r,c),i=mD(i,r,!0));let l="";return o.forEach(d=>{let p=pD(d);l+=p?p(i,t,c):d==="''"?"'":d.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),l}function Mu(n,e,t){let r=new Date(0);return r.setFullYear(n,e,t),r.setHours(0,0,0),r}function _n(n,e){let t=Zb(n);if(Ru[t]??={},Ru[t][e])return Ru[t][e];let r="";switch(e){case"shortDate":r=bu(n,Et.Short);break;case"mediumDate":r=bu(n,Et.Medium);break;case"longDate":r=bu(n,Et.Long);break;case"fullDate":r=bu(n,Et.Full);break;case"shortTime":r=Du(n,Et.Short);break;case"mediumTime":r=Du(n,Et.Medium);break;case"longTime":r=Du(n,Et.Long);break;case"fullTime":r=Du(n,Et.Full);break;case"short":let i=_n(n,"shortTime"),s=_n(n,"shortDate");r=Cu(Su(n,Et.Short),[i,s]);break;case"medium":let o=_n(n,"mediumTime"),a=_n(n,"mediumDate");r=Cu(Su(n,Et.Medium),[o,a]);break;case"long":let c=_n(n,"longTime"),l=_n(n,"longDate");r=Cu(Su(n,Et.Long),[c,l]);break;case"full":let d=_n(n,"fullTime"),p=_n(n,"fullDate");r=Cu(Su(n,Et.Full),[d,p]);break}return r&&(Ru[t][e]=r),r}function Cu(n,e){return e&&(n=n.replace(/\{([^}]+)}/g,function(t,r){return e!=null&&r in e?e[r]:t})),n}function Vt(n,e,t="-",r,i){let s="";(n<0||i&&n<=0)&&(i?n=-n+1:(n=-n,s=t));let o=String(n);for(;o.length<e;)o="0"+o;return r&&(o=o.slice(o.length-e)),s+o}function cD(n,e){return Vt(n,3).substring(0,e)}function $e(n,e,t=0,r=!1,i=!1){return function(s,o){let a=lD(n,s);if((t>0||a>-t)&&(a+=t),n===de.Hours)a===0&&t===-12&&(a=12);else if(n===de.FractionalSeconds)return cD(a,e);let c=xu(o,er.MinusSign);return Vt(a,e,c,r,i)}}function lD(n,e){switch(n){case de.FullYear:return e.getFullYear();case de.Month:return e.getMonth();case de.Date:return e.getDate();case de.Hours:return e.getHours();case de.Minutes:return e.getMinutes();case de.Seconds:return e.getSeconds();case de.FractionalSeconds:return e.getMilliseconds();case de.Day:return e.getDay();default:throw new Error(`Unknown DateType value "${n}".`)}}function Ee(n,e,t=dt.Format,r=!1){return function(i,s){return hD(i,s,n,e,t,r)}}function hD(n,e,t,r,i,s){switch(t){case he.Months:return nD(e,i,r)[n.getMonth()];case he.Days:return tD(e,i,r)[n.getDay()];case he.DayPeriods:let o=n.getHours(),a=n.getMinutes();if(s){let l=iD(e),d=sD(e,i,r),p=l.findIndex(m=>{if(Array.isArray(m)){let[w,D]=m,k=o>=w.hours&&a>=w.minutes,S=o<D.hours||o===D.hours&&a<D.minutes;if(w.hours<D.hours){if(k&&S)return!0}else if(k||S)return!0}else if(m.hours===o&&m.minutes===a)return!0;return!1});if(p!==-1)return d[p]}return eD(e,i,r)[o<12?0:1];case he.Eras:return rD(e,r)[n.getFullYear()<=0?0:1];default:let c=t;throw new Error(`unexpected translation type ${c}`)}}function Pu(n){return function(e,t,r){let i=-1*r,s=xu(t,er.MinusSign),o=i>0?Math.floor(i/60):Math.ceil(i/60);switch(n){case wn.Short:return(i>=0?"+":"")+Vt(o,2,s)+Vt(Math.abs(i%60),2,s);case wn.ShortGMT:return"GMT"+(i>=0?"+":"")+Vt(o,1,s);case wn.Long:return"GMT"+(i>=0?"+":"")+Vt(o,2,s)+":"+Vt(Math.abs(i%60),2,s);case wn.Extended:return r===0?"Z":(i>=0?"+":"")+Vt(o,2,s)+":"+Vt(Math.abs(i%60),2,s);default:throw new Error(`Unknown zone width "${n}"`)}}}var dD=0,ku=4;function fD(n){let e=Mu(n,dD,1).getDay();return Mu(n,0,1+(e<=ku?ku:ku+7)-e)}function Mv(n){let e=n.getDay(),t=e===0?-3:ku-e;return Mu(n.getFullYear(),n.getMonth(),n.getDate()+t)}function td(n,e=!1){return function(t,r){let i;if(e){let s=new Date(t.getFullYear(),t.getMonth(),1).getDay()-1,o=t.getDate();i=1+Math.floor((o+s)/7)}else{let s=Mv(t),o=fD(s.getFullYear()),a=s.getTime()-o.getTime();i=1+Math.round(a/6048e5)}return Vt(i,n,xu(r,er.MinusSign))}}function Nu(n,e=!1){return function(t,r){let s=Mv(t).getFullYear();return Vt(s,n,xu(r,er.MinusSign),e)}}var nd={};function pD(n){if(nd[n])return nd[n];let e;switch(n){case"G":case"GG":case"GGG":e=Ee(he.Eras,ye.Abbreviated);break;case"GGGG":e=Ee(he.Eras,ye.Wide);break;case"GGGGG":e=Ee(he.Eras,ye.Narrow);break;case"y":e=$e(de.FullYear,1,0,!1,!0);break;case"yy":e=$e(de.FullYear,2,0,!0,!0);break;case"yyy":e=$e(de.FullYear,3,0,!1,!0);break;case"yyyy":e=$e(de.FullYear,4,0,!1,!0);break;case"Y":e=Nu(1);break;case"YY":e=Nu(2,!0);break;case"YYY":e=Nu(3);break;case"YYYY":e=Nu(4);break;case"M":case"L":e=$e(de.Month,1,1);break;case"MM":case"LL":e=$e(de.Month,2,1);break;case"MMM":e=Ee(he.Months,ye.Abbreviated);break;case"MMMM":e=Ee(he.Months,ye.Wide);break;case"MMMMM":e=Ee(he.Months,ye.Narrow);break;case"LLL":e=Ee(he.Months,ye.Abbreviated,dt.Standalone);break;case"LLLL":e=Ee(he.Months,ye.Wide,dt.Standalone);break;case"LLLLL":e=Ee(he.Months,ye.Narrow,dt.Standalone);break;case"w":e=td(1);break;case"ww":e=td(2);break;case"W":e=td(1,!0);break;case"d":e=$e(de.Date,1);break;case"dd":e=$e(de.Date,2);break;case"c":case"cc":e=$e(de.Day,1);break;case"ccc":e=Ee(he.Days,ye.Abbreviated,dt.Standalone);break;case"cccc":e=Ee(he.Days,ye.Wide,dt.Standalone);break;case"ccccc":e=Ee(he.Days,ye.Narrow,dt.Standalone);break;case"cccccc":e=Ee(he.Days,ye.Short,dt.Standalone);break;case"E":case"EE":case"EEE":e=Ee(he.Days,ye.Abbreviated);break;case"EEEE":e=Ee(he.Days,ye.Wide);break;case"EEEEE":e=Ee(he.Days,ye.Narrow);break;case"EEEEEE":e=Ee(he.Days,ye.Short);break;case"a":case"aa":case"aaa":e=Ee(he.DayPeriods,ye.Abbreviated);break;case"aaaa":e=Ee(he.DayPeriods,ye.Wide);break;case"aaaaa":e=Ee(he.DayPeriods,ye.Narrow);break;case"b":case"bb":case"bbb":e=Ee(he.DayPeriods,ye.Abbreviated,dt.Standalone,!0);break;case"bbbb":e=Ee(he.DayPeriods,ye.Wide,dt.Standalone,!0);break;case"bbbbb":e=Ee(he.DayPeriods,ye.Narrow,dt.Standalone,!0);break;case"B":case"BB":case"BBB":e=Ee(he.DayPeriods,ye.Abbreviated,dt.Format,!0);break;case"BBBB":e=Ee(he.DayPeriods,ye.Wide,dt.Format,!0);break;case"BBBBB":e=Ee(he.DayPeriods,ye.Narrow,dt.Format,!0);break;case"h":e=$e(de.Hours,1,-12);break;case"hh":e=$e(de.Hours,2,-12);break;case"H":e=$e(de.Hours,1);break;case"HH":e=$e(de.Hours,2);break;case"m":e=$e(de.Minutes,1);break;case"mm":e=$e(de.Minutes,2);break;case"s":e=$e(de.Seconds,1);break;case"ss":e=$e(de.Seconds,2);break;case"S":e=$e(de.FractionalSeconds,1);break;case"SS":e=$e(de.FractionalSeconds,2);break;case"SSS":e=$e(de.FractionalSeconds,3);break;case"Z":case"ZZ":case"ZZZ":e=Pu(wn.Short);break;case"ZZZZZ":e=Pu(wn.Extended);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":e=Pu(wn.ShortGMT);break;case"OOOO":case"ZZZZ":case"zzzz":e=Pu(wn.Long);break;default:return null}return nd[n]=e,e}function xv(n,e){n=n.replace(/:/g,"");let t=Date.parse("Jan 01, 1970 00:00:00 "+n)/6e4;return isNaN(t)?e:t}function gD(n,e){return n=new Date(n.getTime()),n.setMinutes(n.getMinutes()+e),n}function mD(n,e,t){let r=t?-1:1,i=n.getTimezoneOffset(),s=xv(e,i);return gD(n,r*(s-i))}function yD(n){if(Tv(n))return n;if(typeof n=="number"&&!isNaN(n))return new Date(n);if(typeof n=="string"){if(n=n.trim(),/^(\d{4}(-\d{1,2}(-\d{1,2})?)?)$/.test(n)){let[i,s=1,o=1]=n.split("-").map(a=>+a);return Mu(i,s-1,o)}let t=parseFloat(n);if(!isNaN(n-t))return new Date(t);let r;if(r=n.match(oD))return _D(r)}let e=new Date(n);if(!Tv(e))throw new Error(`Unable to convert "${n}" into a date`);return e}function _D(n){let e=new Date(0),t=0,r=0,i=n[8]?e.setUTCFullYear:e.setFullYear,s=n[8]?e.setUTCHours:e.setHours;n[9]&&(t=Number(n[9]+n[10]),r=Number(n[9]+n[11])),i.call(e,Number(n[1]),Number(n[2])-1,Number(n[3]));let o=Number(n[4]||0)-t,a=Number(n[5]||0)-r,c=Number(n[6]||0),l=Math.floor(parseFloat("0."+(n[7]||0))*1e3);return s.call(e,o,a,c,l),e}function Tv(n){return n instanceof Date&&!isNaN(n.valueOf())}function Fu(n,e){e=encodeURIComponent(e);for(let t of n.split(";")){let r=t.indexOf("="),[i,s]=r==-1?[t,""]:[t.slice(0,r),t.slice(r+1)];if(i.trim()===e)return decodeURIComponent(s)}return null}var rd=/\s+/,Av=[],VF=(()=>{let e=class e{constructor(r,i){this._ngEl=r,this._renderer=i,this.initialClasses=Av,this.stateMap=new Map}set klass(r){this.initialClasses=r!=null?r.trim().split(rd):Av}set ngClass(r){this.rawClass=typeof r=="string"?r.trim().split(rd):r}ngDoCheck(){for(let i of this.initialClasses)this._updateState(i,!0);let r=this.rawClass;if(Array.isArray(r)||r instanceof Set)for(let i of r)this._updateState(i,!0);else if(r!=null)for(let i of Object.keys(r))this._updateState(i,!!r[i]);this._applyStateDiff()}_updateState(r,i){let s=this.stateMap.get(r);s!==void 0?(s.enabled!==i&&(s.changed=!0,s.enabled=i),s.touched=!0):this.stateMap.set(r,{enabled:i,changed:!0,touched:!0})}_applyStateDiff(){for(let r of this.stateMap){let i=r[0],s=r[1];s.changed?(this._toggleClass(i,s.enabled),s.changed=!1):s.touched||(s.enabled&&this._toggleClass(i,!1),this.stateMap.delete(i)),s.touched=!1}}_toggleClass(r,i){r=r.trim(),r.length>0&&r.split(rd).forEach(s=>{i?this._renderer.addClass(this._ngEl.nativeElement,s):this._renderer.removeClass(this._ngEl.nativeElement,s)})}};e.\u0275fac=function(i){return new(i||e)(De(Ci),De(ki))},e.\u0275dir=yn({type:e,selectors:[["","ngClass",""]],inputs:{klass:[0,"class","klass"],ngClass:"ngClass"},standalone:!0});let n=e;return n})();var id=class{constructor(e,t,r,i){this.$implicit=e,this.ngForOf=t,this.index=r,this.count=i}get first(){return this.index===0}get last(){return this.index===this.count-1}get even(){return this.index%2===0}get odd(){return!this.even}},UF=(()=>{let e=class e{set ngForOf(r){this._ngForOf=r,this._ngForOfDirty=!0}set ngForTrackBy(r){this._trackByFn=r}get ngForTrackBy(){return this._trackByFn}constructor(r,i,s){this._viewContainer=r,this._template=i,this._differs=s,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForTemplate(r){r&&(this._template=r)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;let r=this._ngForOf;if(!this._differ&&r)if(0)try{}catch{}else this._differ=this._differs.find(r).create(this.ngForTrackBy)}if(this._differ){let r=this._differ.diff(this._ngForOf);r&&this._applyChanges(r)}}_applyChanges(r){let i=this._viewContainer;r.forEachOperation((s,o,a)=>{if(s.previousIndex==null)i.createEmbeddedView(this._template,new id(s.item,this._ngForOf,-1,-1),a===null?void 0:a);else if(a==null)i.remove(o===null?void 0:o);else if(o!==null){let c=i.get(o);i.move(c,a),bv(c,s)}});for(let s=0,o=i.length;s<o;s++){let c=i.get(s).context;c.index=s,c.count=o,c.ngForOf=this._ngForOf}r.forEachIdentityChange(s=>{let o=i.get(s.currentIndex);bv(o,s)})}static ngTemplateContextGuard(r,i){return!0}};e.\u0275fac=function(i){return new(i||e)(De(Oi),De(Hh),De(mv))},e.\u0275dir=yn({type:e,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0});let n=e;return n})();function bv(n,e){n.context.$implicit=e.item}var BF=(()=>{let e=class e{constructor(r,i){this._viewContainer=r,this._context=new sd,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=i}set ngIf(r){this._context.$implicit=this._context.ngIf=r,this._updateView()}set ngIfThen(r){Dv("ngIfThen",r),this._thenTemplateRef=r,this._thenViewRef=null,this._updateView()}set ngIfElse(r){Dv("ngIfElse",r),this._elseTemplateRef=r,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(r,i){return!0}};e.\u0275fac=function(i){return new(i||e)(De(Oi),De(Hh))},e.\u0275dir=yn({type:e,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0});let n=e;return n})(),sd=class{constructor(){this.$implicit=null,this.ngIf=null}};function Dv(n,e){if(!!!(!e||e.createEmbeddedView))throw new Error(`${n} must be a TemplateRef, but received '${$_(e)}'.`)}var $F=(()=>{let e=class e{constructor(r){this._viewContainerRef=r,this._viewRef=null,this.ngTemplateOutletContext=null,this.ngTemplateOutlet=null,this.ngTemplateOutletInjector=null}ngOnChanges(r){if(this._shouldRecreateView(r)){let i=this._viewContainerRef;if(this._viewRef&&i.remove(i.indexOf(this._viewRef)),!this.ngTemplateOutlet){this._viewRef=null;return}let s=this._createContextForwardProxy();this._viewRef=i.createEmbeddedView(this.ngTemplateOutlet,s,{injector:this.ngTemplateOutletInjector??void 0})}}_shouldRecreateView(r){return!!r.ngTemplateOutlet||!!r.ngTemplateOutletInjector}_createContextForwardProxy(){return new Proxy({},{set:(r,i,s)=>this.ngTemplateOutletContext?Reflect.set(this.ngTemplateOutletContext,i,s):!1,get:(r,i,s)=>{if(this.ngTemplateOutletContext)return Reflect.get(this.ngTemplateOutletContext,i,s)}})}};e.\u0275fac=function(i){return new(i||e)(De(Oi))},e.\u0275dir=yn({type:e,selectors:[["","ngTemplateOutlet",""]],inputs:{ngTemplateOutletContext:"ngTemplateOutletContext",ngTemplateOutlet:"ngTemplateOutlet",ngTemplateOutletInjector:"ngTemplateOutletInjector"},standalone:!0,features:[Ri]});let n=e;return n})();function vD(n,e){return new we(2100,!1)}var wD="mediumDate",ED=new te(""),ID=new te(""),jF=(()=>{let e=class e{constructor(r,i,s){this.locale=r,this.defaultTimezone=i,this.defaultOptions=s}transform(r,i,s,o){if(r==null||r===""||r!==r)return null;try{let a=i??this.defaultOptions?.dateFormat??wD,c=s??this.defaultOptions?.timezone??this.defaultTimezone??void 0;return uD(r,a,o||this.locale,c)}catch(a){throw vD(e,a.message)}}};e.\u0275fac=function(i){return new(i||e)(De(gv,16),De(ED,24),De(ID,24))},e.\u0275pipe=G_({name:"date",type:e,pure:!0,standalone:!0});let n=e;return n})();var TD=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=Xn({type:e}),e.\u0275inj=Jn({});let n=e;return n})(),hd="browser",AD="server";function bD(n){return n===hd}function Eo(n){return n===AD}var Fv=(()=>{let e=class e{};e.\u0275prov=X({token:e,providedIn:"root",factory:()=>bD(j(Ct))?new od(j(Ye),window):new ad});let n=e;return n})(),od=class{constructor(e,t){this.document=e,this.window=t,this.offset=()=>[0,0]}setOffset(e){Array.isArray(e)?this.offset=()=>e:this.offset=e}getScrollPosition(){return[this.window.scrollX,this.window.scrollY]}scrollToPosition(e){this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){let t=DD(this.document,e);t&&(this.scrollToElement(t),t.focus())}setHistoryScrollRestoration(e){this.window.history.scrollRestoration=e}scrollToElement(e){let t=e.getBoundingClientRect(),r=t.left+this.window.pageXOffset,i=t.top+this.window.pageYOffset,s=this.offset();this.window.scrollTo(r-s[0],i-s[1])}};function DD(n,e){let t=n.getElementById(e)||n.getElementsByName(e)[0];if(t)return t;if(typeof n.createTreeWalker=="function"&&n.body&&typeof n.body.attachShadow=="function"){let r=n.createTreeWalker(n.body,NodeFilter.SHOW_ELEMENT),i=r.currentNode;for(;i;){let s=i.shadowRoot;if(s){let o=s.getElementById(e)||s.querySelector(`[name="${e}"]`);if(o)return o}i=r.nextNode()}}return null}var ad=class{setOffset(e){}getScrollPosition(){return[0,0]}scrollToPosition(e){}scrollToAnchor(e){}setHistoryScrollRestoration(e){}},Fi=class{};var To=class{},Uu=class{},Kt=class n{constructor(e){this.normalizedNames=new Map,this.lazyUpdate=null,e?typeof e=="string"?this.lazyInit=()=>{this.headers=new Map,e.split(`
`).forEach(t=>{let r=t.indexOf(":");if(r>0){let i=t.slice(0,r),s=i.toLowerCase(),o=t.slice(r+1).trim();this.maybeSetNormalizedName(i,s),this.headers.has(s)?this.headers.get(s).push(o):this.headers.set(s,[o])}})}:typeof Headers<"u"&&e instanceof Headers?(this.headers=new Map,e.forEach((t,r)=>{this.setHeaderEntries(r,t)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(e).forEach(([t,r])=>{this.setHeaderEntries(t,r)})}:this.headers=new Map}has(e){return this.init(),this.headers.has(e.toLowerCase())}get(e){this.init();let t=this.headers.get(e.toLowerCase());return t&&t.length>0?t[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(e){return this.init(),this.headers.get(e.toLowerCase())||null}append(e,t){return this.clone({name:e,value:t,op:"a"})}set(e,t){return this.clone({name:e,value:t,op:"s"})}delete(e,t){return this.clone({name:e,value:t,op:"d"})}maybeSetNormalizedName(e,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,e)}init(){this.lazyInit&&(this.lazyInit instanceof n?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(e=>this.applyUpdate(e)),this.lazyUpdate=null))}copyFrom(e){e.init(),Array.from(e.headers.keys()).forEach(t=>{this.headers.set(t,e.headers.get(t)),this.normalizedNames.set(t,e.normalizedNames.get(t))})}clone(e){let t=new n;return t.lazyInit=this.lazyInit&&this.lazyInit instanceof n?this.lazyInit:this,t.lazyUpdate=(this.lazyUpdate||[]).concat([e]),t}applyUpdate(e){let t=e.name.toLowerCase();switch(e.op){case"a":case"s":let r=e.value;if(typeof r=="string"&&(r=[r]),r.length===0)return;this.maybeSetNormalizedName(e.name,t);let i=(e.op==="a"?this.headers.get(t):void 0)||[];i.push(...r),this.headers.set(t,i);break;case"d":let s=e.value;if(!s)this.headers.delete(t),this.normalizedNames.delete(t);else{let o=this.headers.get(t);if(!o)return;o=o.filter(a=>s.indexOf(a)===-1),o.length===0?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,o)}break}}setHeaderEntries(e,t){let r=(Array.isArray(t)?t:[t]).map(s=>s.toString()),i=e.toLowerCase();this.headers.set(i,r),this.maybeSetNormalizedName(e,i)}forEach(e){this.init(),Array.from(this.normalizedNames.keys()).forEach(t=>e(this.normalizedNames.get(t),this.headers.get(t)))}};var fd=class{encodeKey(e){return Vv(e)}encodeValue(e){return Vv(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}};function SD(n,e){let t=new Map;return n.length>0&&n.replace(/^\?/,"").split("&").forEach(i=>{let s=i.indexOf("="),[o,a]=s==-1?[e.decodeKey(i),""]:[e.decodeKey(i.slice(0,s)),e.decodeValue(i.slice(s+1))],c=t.get(o)||[];c.push(a),t.set(o,c)}),t}var RD=/%(\d[a-f0-9])/gi,CD={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function Vv(n){return encodeURIComponent(n).replace(RD,(e,t)=>CD[t]??e)}function Lu(n){return`${n}`}var nr=class n{constructor(e={}){if(this.updates=null,this.cloneFrom=null,this.encoder=e.encoder||new fd,e.fromString){if(e.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=SD(e.fromString,this.encoder)}else e.fromObject?(this.map=new Map,Object.keys(e.fromObject).forEach(t=>{let r=e.fromObject[t],i=Array.isArray(r)?r.map(Lu):[Lu(r)];this.map.set(t,i)})):this.map=null}has(e){return this.init(),this.map.has(e)}get(e){this.init();let t=this.map.get(e);return t?t[0]:null}getAll(e){return this.init(),this.map.get(e)||null}keys(){return this.init(),Array.from(this.map.keys())}append(e,t){return this.clone({param:e,value:t,op:"a"})}appendAll(e){let t=[];return Object.keys(e).forEach(r=>{let i=e[r];Array.isArray(i)?i.forEach(s=>{t.push({param:r,value:s,op:"a"})}):t.push({param:r,value:i,op:"a"})}),this.clone(t)}set(e,t){return this.clone({param:e,value:t,op:"s"})}delete(e,t){return this.clone({param:e,value:t,op:"d"})}toString(){return this.init(),this.keys().map(e=>{let t=this.encoder.encodeKey(e);return this.map.get(e).map(r=>t+"="+this.encoder.encodeValue(r)).join("&")}).filter(e=>e!=="").join("&")}clone(e){let t=new n({encoder:this.encoder});return t.cloneFrom=this.cloneFrom||this,t.updates=(this.updates||[]).concat(e),t}init(){this.map===null&&(this.map=new Map),this.cloneFrom!==null&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(e=>this.map.set(e,this.cloneFrom.map.get(e))),this.updates.forEach(e=>{switch(e.op){case"a":case"s":let t=(e.op==="a"?this.map.get(e.param):void 0)||[];t.push(Lu(e.value)),this.map.set(e.param,t);break;case"d":if(e.value!==void 0){let r=this.map.get(e.param)||[],i=r.indexOf(Lu(e.value));i!==-1&&r.splice(i,1),r.length>0?this.map.set(e.param,r):this.map.delete(e.param)}else{this.map.delete(e.param);break}}}),this.cloneFrom=this.updates=null)}};var pd=class{constructor(){this.map=new Map}set(e,t){return this.map.set(e,t),this}get(e){return this.map.has(e)||this.map.set(e,e.defaultValue()),this.map.get(e)}delete(e){return this.map.delete(e),this}has(e){return this.map.has(e)}keys(){return this.map.keys()}};function PD(n){switch(n){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}function Uv(n){return typeof ArrayBuffer<"u"&&n instanceof ArrayBuffer}function Bv(n){return typeof Blob<"u"&&n instanceof Blob}function $v(n){return typeof FormData<"u"&&n instanceof FormData}function ND(n){return typeof URLSearchParams<"u"&&n instanceof URLSearchParams}var Io=class n{constructor(e,t,r,i){this.url=t,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=e.toUpperCase();let s;if(PD(this.method)||i?(this.body=r!==void 0?r:null,s=i):s=r,s&&(this.reportProgress=!!s.reportProgress,this.withCredentials=!!s.withCredentials,s.responseType&&(this.responseType=s.responseType),s.headers&&(this.headers=s.headers),s.context&&(this.context=s.context),s.params&&(this.params=s.params),this.transferCache=s.transferCache),this.headers??=new Kt,this.context??=new pd,!this.params)this.params=new nr,this.urlWithParams=t;else{let o=this.params.toString();if(o.length===0)this.urlWithParams=t;else{let a=t.indexOf("?"),c=a===-1?"?":a<t.length-1?"&":"";this.urlWithParams=t+c+o}}}serializeBody(){return this.body===null?null:typeof this.body=="string"||Uv(this.body)||Bv(this.body)||$v(this.body)||ND(this.body)?this.body:this.body instanceof nr?this.body.toString():typeof this.body=="object"||typeof this.body=="boolean"||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return this.body===null||$v(this.body)?null:Bv(this.body)?this.body.type||null:Uv(this.body)?null:typeof this.body=="string"?"text/plain":this.body instanceof nr?"application/x-www-form-urlencoded;charset=UTF-8":typeof this.body=="object"||typeof this.body=="number"||typeof this.body=="boolean"?"application/json":null}clone(e={}){let t=e.method||this.method,r=e.url||this.url,i=e.responseType||this.responseType,s=e.transferCache??this.transferCache,o=e.body!==void 0?e.body:this.body,a=e.withCredentials??this.withCredentials,c=e.reportProgress??this.reportProgress,l=e.headers||this.headers,d=e.params||this.params,p=e.context??this.context;return e.setHeaders!==void 0&&(l=Object.keys(e.setHeaders).reduce((m,w)=>m.set(w,e.setHeaders[w]),l)),e.setParams&&(d=Object.keys(e.setParams).reduce((m,w)=>m.set(w,e.setParams[w]),d)),new n(t,r,o,{params:d,headers:l,context:p,reportProgress:c,responseType:i,withCredentials:a,transferCache:s})}},rr=function(n){return n[n.Sent=0]="Sent",n[n.UploadProgress=1]="UploadProgress",n[n.ResponseHeader=2]="ResponseHeader",n[n.DownloadProgress=3]="DownloadProgress",n[n.Response=4]="Response",n[n.User=5]="User",n}(rr||{}),Ao=class{constructor(e,t=200,r="OK"){this.headers=e.headers||new Kt,this.status=e.status!==void 0?e.status:t,this.statusText=e.statusText||r,this.url=e.url||null,this.ok=this.status>=200&&this.status<300}},Bu=class n extends Ao{constructor(e={}){super(e),this.type=rr.ResponseHeader}clone(e={}){return new n({headers:e.headers||this.headers,status:e.status!==void 0?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}},zr=class n extends Ao{constructor(e={}){super(e),this.type=rr.Response,this.body=e.body!==void 0?e.body:null}clone(e={}){return new n({body:e.body!==void 0?e.body:this.body,headers:e.headers||this.headers,status:e.status!==void 0?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}},tr=class extends Ao{constructor(e){super(e,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.status>=200&&this.status<300?this.message=`Http failure during parsing for ${e.url||"(unknown url)"}`:this.message=`Http failure response for ${e.url||"(unknown url)"}: ${e.status} ${e.statusText}`,this.error=e.error||null}},Zv=200,kD=204;function dd(n,e){return{body:e,headers:n.headers,context:n.context,observe:n.observe,params:n.params,reportProgress:n.reportProgress,responseType:n.responseType,withCredentials:n.withCredentials,transferCache:n.transferCache}}var OD=(()=>{let e=class e{constructor(r){this.handler=r}request(r,i,s={}){let o;if(r instanceof Io)o=r;else{let l;s.headers instanceof Kt?l=s.headers:l=new Kt(s.headers);let d;s.params&&(s.params instanceof nr?d=s.params:d=new nr({fromObject:s.params})),o=new Io(r,i,s.body!==void 0?s.body:null,{headers:l,context:s.context,params:d,reportProgress:s.reportProgress,responseType:s.responseType||"json",withCredentials:s.withCredentials,transferCache:s.transferCache})}let a=K(o).pipe(Qn(l=>this.handler.handle(l)));if(r instanceof Io||s.observe==="events")return a;let c=a.pipe(mn(l=>l instanceof zr));switch(s.observe||"body"){case"body":switch(o.responseType){case"arraybuffer":return c.pipe(le(l=>{if(l.body!==null&&!(l.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return l.body}));case"blob":return c.pipe(le(l=>{if(l.body!==null&&!(l.body instanceof Blob))throw new Error("Response is not a Blob.");return l.body}));case"text":return c.pipe(le(l=>{if(l.body!==null&&typeof l.body!="string")throw new Error("Response is not a string.");return l.body}));case"json":default:return c.pipe(le(l=>l.body))}case"response":return c;default:throw new Error(`Unreachable: unhandled observe type ${s.observe}}`)}}delete(r,i={}){return this.request("DELETE",r,i)}get(r,i={}){return this.request("GET",r,i)}head(r,i={}){return this.request("HEAD",r,i)}jsonp(r,i){return this.request("JSONP",r,{params:new nr().append(i,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(r,i={}){return this.request("OPTIONS",r,i)}patch(r,i,s={}){return this.request("PATCH",r,dd(s,i))}post(r,i,s={}){return this.request("POST",r,dd(s,i))}put(r,i,s={}){return this.request("PUT",r,dd(s,i))}};e.\u0275fac=function(i){return new(i||e)(Y(To))},e.\u0275prov=X({token:e,factory:e.\u0275fac});let n=e;return n})(),MD=/^\)\]\}',?\n/,xD="X-Request-URL";function jv(n){if(n.url)return n.url;let e=xD.toLocaleLowerCase();return n.headers.get(e)}var FD=(()=>{let e=class e{constructor(){this.fetchImpl=j(gd,{optional:!0})?.fetch??fetch.bind(globalThis),this.ngZone=j(Pe)}handle(r){return new bi(i=>{let s=new AbortController;return this.doRequest(r,s.signal,i).then(md,o=>i.error(new tr({error:o}))),()=>s.abort()})}doRequest(r,i,s){return y(this,null,function*(){let o=this.createRequestInit(r),a;try{let D=this.ngZone.runOutsideAngular(()=>this.fetchImpl(r.urlWithParams,q({signal:i},o)));LD(D),s.next({type:rr.Sent}),a=yield D}catch(D){s.error(new tr({error:D,status:D.status??0,statusText:D.statusText,url:r.urlWithParams,headers:D.headers}));return}let c=new Kt(a.headers),l=a.statusText,d=jv(a)??r.urlWithParams,p=a.status,m=null;if(r.reportProgress&&s.next(new Bu({headers:c,status:p,statusText:l,url:d})),a.body){let D=a.headers.get("content-length"),k=[],S=a.body.getReader(),x=0,$,F,U=typeof Zone<"u"&&Zone.current;yield this.ngZone.runOutsideAngular(()=>y(this,null,function*(){for(;;){let{done:W,value:I}=yield S.read();if(W)break;if(k.push(I),x+=I.length,r.reportProgress){F=r.responseType==="text"?(F??"")+($??=new TextDecoder).decode(I,{stream:!0}):void 0;let _=()=>s.next({type:rr.DownloadProgress,total:D?+D:void 0,loaded:x,partialText:F});U?U.run(_):_()}}}));let J=this.concatChunks(k,x);try{let W=a.headers.get("Content-Type")??"";m=this.parseBody(r,J,W)}catch(W){s.error(new tr({error:W,headers:new Kt(a.headers),status:a.status,statusText:a.statusText,url:jv(a)??r.urlWithParams}));return}}p===0&&(p=m?Zv:0),p>=200&&p<300?(s.next(new zr({body:m,headers:c,status:p,statusText:l,url:d})),s.complete()):s.error(new tr({error:m,headers:c,status:p,statusText:l,url:d}))})}parseBody(r,i,s){switch(r.responseType){case"json":let o=new TextDecoder().decode(i).replace(MD,"");return o===""?null:JSON.parse(o);case"text":return new TextDecoder().decode(i);case"blob":return new Blob([i],{type:s});case"arraybuffer":return i.buffer}}createRequestInit(r){let i={},s=r.withCredentials?"include":void 0;if(r.headers.forEach((o,a)=>i[o]=a.join(",")),r.headers.has("Accept")||(i.Accept="application/json, text/plain, */*"),!r.headers.has("Content-Type")){let o=r.detectContentTypeHeader();o!==null&&(i["Content-Type"]=o)}return{body:r.serializeBody(),method:r.method,headers:i,credentials:s}}concatChunks(r,i){let s=new Uint8Array(i),o=0;for(let a of r)s.set(a,o),o+=a.length;return s}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=X({token:e,factory:e.\u0275fac});let n=e;return n})(),gd=class{};function md(){}function LD(n){n.then(md,md)}function ew(n,e){return e(n)}function VD(n,e){return(t,r)=>e.intercept(t,{handle:i=>n(i,r)})}function UD(n,e,t){return(r,i)=>St(t,()=>e(r,s=>n(s,i)))}var BD=new te(""),yd=new te(""),tw=new te(""),nw=new te("",{providedIn:"root",factory:()=>!0});function $D(){let n=null;return(e,t)=>{n===null&&(n=(j(BD,{optional:!0})??[]).reduceRight(VD,ew));let r=j(go);if(j(nw)){let s=r.add();return n(e,t).pipe(Ur(()=>r.remove(s)))}else return n(e,t)}}var zv=(()=>{let e=class e extends To{constructor(r,i){super(),this.backend=r,this.injector=i,this.chain=null,this.pendingTasks=j(go),this.contributeToStability=j(nw)}handle(r){if(this.chain===null){let i=Array.from(new Set([...this.injector.get(yd),...this.injector.get(tw,[])]));this.chain=i.reduceRight((s,o)=>UD(s,o,this.injector),ew)}if(this.contributeToStability){let i=this.pendingTasks.add();return this.chain(r,s=>this.backend.handle(s)).pipe(Ur(()=>this.pendingTasks.remove(i)))}else return this.chain(r,i=>this.backend.handle(i))}};e.\u0275fac=function(i){return new(i||e)(Y(Uu),Y(Br))},e.\u0275prov=X({token:e,factory:e.\u0275fac});let n=e;return n})();var jD=/^\)\]\}',?\n/;function zD(n){return"responseURL"in n&&n.responseURL?n.responseURL:/^X-Request-URL:/m.test(n.getAllResponseHeaders())?n.getResponseHeader("X-Request-URL"):null}var qv=(()=>{let e=class e{constructor(r){this.xhrFactory=r}handle(r){if(r.method==="JSONP")throw new we(-2800,!1);let i=this.xhrFactory;return(i.\u0275loadImpl?ot(i.\u0275loadImpl()):K(null)).pipe(wt(()=>new bi(o=>{let a=i.build();if(a.open(r.method,r.urlWithParams),r.withCredentials&&(a.withCredentials=!0),r.headers.forEach((S,x)=>a.setRequestHeader(S,x.join(","))),r.headers.has("Accept")||a.setRequestHeader("Accept","application/json, text/plain, */*"),!r.headers.has("Content-Type")){let S=r.detectContentTypeHeader();S!==null&&a.setRequestHeader("Content-Type",S)}if(r.responseType){let S=r.responseType.toLowerCase();a.responseType=S!=="json"?S:"text"}let c=r.serializeBody(),l=null,d=()=>{if(l!==null)return l;let S=a.statusText||"OK",x=new Kt(a.getAllResponseHeaders()),$=zD(a)||r.url;return l=new Bu({headers:x,status:a.status,statusText:S,url:$}),l},p=()=>{let{headers:S,status:x,statusText:$,url:F}=d(),U=null;x!==kD&&(U=typeof a.response>"u"?a.responseText:a.response),x===0&&(x=U?Zv:0);let J=x>=200&&x<300;if(r.responseType==="json"&&typeof U=="string"){let W=U;U=U.replace(jD,"");try{U=U!==""?JSON.parse(U):null}catch(I){U=W,J&&(J=!1,U={error:I,text:U})}}J?(o.next(new zr({body:U,headers:S,status:x,statusText:$,url:F||void 0})),o.complete()):o.error(new tr({error:U,headers:S,status:x,statusText:$,url:F||void 0}))},m=S=>{let{url:x}=d(),$=new tr({error:S,status:a.status||0,statusText:a.statusText||"Unknown Error",url:x||void 0});o.error($)},w=!1,D=S=>{w||(o.next(d()),w=!0);let x={type:rr.DownloadProgress,loaded:S.loaded};S.lengthComputable&&(x.total=S.total),r.responseType==="text"&&a.responseText&&(x.partialText=a.responseText),o.next(x)},k=S=>{let x={type:rr.UploadProgress,loaded:S.loaded};S.lengthComputable&&(x.total=S.total),o.next(x)};return a.addEventListener("load",p),a.addEventListener("error",m),a.addEventListener("timeout",m),a.addEventListener("abort",m),r.reportProgress&&(a.addEventListener("progress",D),c!==null&&a.upload&&a.upload.addEventListener("progress",k)),a.send(c),o.next({type:rr.Sent}),()=>{a.removeEventListener("error",m),a.removeEventListener("abort",m),a.removeEventListener("load",p),a.removeEventListener("timeout",m),r.reportProgress&&(a.removeEventListener("progress",D),c!==null&&a.upload&&a.upload.removeEventListener("progress",k)),a.readyState!==a.DONE&&a.abort()}})))}};e.\u0275fac=function(i){return new(i||e)(Y(Fi))},e.\u0275prov=X({token:e,factory:e.\u0275fac});let n=e;return n})(),rw=new te(""),qD="XSRF-TOKEN",GD=new te("",{providedIn:"root",factory:()=>qD}),WD="X-XSRF-TOKEN",HD=new te("",{providedIn:"root",factory:()=>WD}),$u=class{},KD=(()=>{let e=class e{constructor(r,i,s){this.doc=r,this.platform=i,this.cookieName=s,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if(this.platform==="server")return null;let r=this.doc.cookie||"";return r!==this.lastCookieString&&(this.parseCount++,this.lastToken=Fu(r,this.cookieName),this.lastCookieString=r),this.lastToken}};e.\u0275fac=function(i){return new(i||e)(Y(Ye),Y(Ct),Y(GD))},e.\u0275prov=X({token:e,factory:e.\u0275fac});let n=e;return n})();function QD(n,e){let t=n.url.toLowerCase();if(!j(rw)||n.method==="GET"||n.method==="HEAD"||t.startsWith("http://")||t.startsWith("https://"))return e(n);let r=j($u).getToken(),i=j(HD);return r!=null&&!n.headers.has(i)&&(n=n.clone({headers:n.headers.set(i,r)})),e(n)}var iw=function(n){return n[n.Interceptors=0]="Interceptors",n[n.LegacyInterceptors=1]="LegacyInterceptors",n[n.CustomXsrfConfiguration=2]="CustomXsrfConfiguration",n[n.NoXsrfProtection=3]="NoXsrfProtection",n[n.JsonpSupport=4]="JsonpSupport",n[n.RequestsMadeViaParent=5]="RequestsMadeViaParent",n[n.Fetch=6]="Fetch",n}(iw||{});function YD(n,e){return{\u0275kind:n,\u0275providers:e}}function eL(...n){let e=[OD,qv,zv,{provide:To,useExisting:zv},{provide:Uu,useFactory:()=>j(FD,{optional:!0})??j(qv)},{provide:yd,useValue:QD,multi:!0},{provide:rw,useValue:!0},{provide:$u,useClass:KD}];for(let t of n)e.push(...t.\u0275providers);return gt(e)}var Gv=new te("");function tL(){return YD(iw.LegacyInterceptors,[{provide:Gv,useFactory:$D},{provide:yd,useExisting:Gv,multi:!0}])}var JD=new te(""),Wv="b",Hv="h",Kv="s",Qv="st",Yv="u",Jv="rt",Vu=new te(""),XD=["GET","HEAD"];function ZD(n,e){let w=j(Vu),{isCacheActive:t}=w,r=R_(w,["isCacheActive"]),{transferCache:i,method:s}=n;if(!t||i===!1||s==="POST"&&!r.includePostRequests&&!i||s!=="POST"&&!XD.includes(s)||!r.includeRequestsWithAuthHeaders&&eS(n)||r.filter?.(n)===!1)return e(n);let o=j(Wh),a=j(JD,{optional:!0}),c=Eo(j(Ct));if(a&&!c)throw new we(2803,!1);let l=c&&a?iS(n.url,a):n.url,d=nS(n,l),p=o.get(d,null),m=r.includeHeaders;if(typeof i=="object"&&i.includeHeaders&&(m=i.includeHeaders),p){let{[Wv]:D,[Jv]:k,[Hv]:S,[Kv]:x,[Qv]:$,[Yv]:F}=p,U=D;switch(k){case"arraybuffer":U=new TextEncoder().encode(D).buffer;break;case"blob":U=new Blob([D]);break}let J=new Kt(S);return K(new zr({body:U,headers:J,status:x,statusText:$,url:F}))}return e(n).pipe(Ve(D=>{D instanceof zr&&c&&o.set(d,{[Wv]:D.body,[Hv]:tS(D.headers,m),[Kv]:D.status,[Qv]:D.statusText,[Yv]:l,[Jv]:n.responseType})}))}function eS(n){return n.headers.has("authorization")||n.headers.has("proxy-authorization")}function tS(n,e){if(!e)return{};let t={};for(let r of e){let i=n.getAll(r);i!==null&&(t[r]=i)}return t}function Xv(n){return[...n.keys()].sort().map(e=>`${e}=${n.getAll(e)}`).join("&")}function nS(n,e){let{params:t,method:r,responseType:i}=n,s=Xv(t),o=n.serializeBody();o instanceof URLSearchParams?o=Xv(o):typeof o!="string"&&(o="");let a=[r,i,e,o,s].join("|"),c=rS(a);return c}function rS(n){let e=0;for(let t of n)e=Math.imul(31,e)+t.charCodeAt(0)<<0;return e+=2147483648,e.toString()}function sw(n){return[{provide:Vu,useFactory:()=>(Kh("NgHttpTransferCache"),q({isCacheActive:!0},n))},{provide:tw,useValue:ZD,multi:!0,deps:[Wh,Vu]},{provide:yo,multi:!0,useFactory:()=>{let e=j(_o),t=j(Vu);return()=>{Zh(e).then(()=>{t.isCacheActive=!1})}}}]}function iS(n,e){let t=new URL(n,"resolve://").origin,r=e[t];return r?n.replace(t,r):n}var wd=class extends Ou{constructor(){super(...arguments),this.supportsDOMEvents=!0}},Ed=class n extends wd{static makeCurrent(){Cv(new n)}onAndCancel(e,t,r){return e.addEventListener(t,r),()=>{e.removeEventListener(t,r)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.remove()}createElement(e,t){return t=t||this.getDefaultDocument(),t.createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return t==="window"?window:t==="document"?e:t==="body"?e.body:null}getBaseHref(e){let t=oS();return t==null?null:aS(t)}resetBaseElement(){bo=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return Fu(document.cookie,e)}},bo=null;function oS(){return bo=bo||document.querySelector("base"),bo?bo.getAttribute("href"):null}function aS(n){return new URL(n,document.baseURI).pathname}var uS=(()=>{let e=class e{build(){return new XMLHttpRequest}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=X({token:e,factory:e.\u0275fac});let n=e;return n})(),ju=new te(""),cw=(()=>{let e=class e{constructor(r,i){this._zone=i,this._eventNameToPlugin=new Map,r.forEach(s=>{s.manager=this}),this._plugins=r.slice().reverse()}addEventListener(r,i,s){return this._findPluginFor(i).addEventListener(r,i,s)}getZone(){return this._zone}_findPluginFor(r){let i=this._eventNameToPlugin.get(r);if(i)return i;if(i=this._plugins.find(o=>o.supports(r)),!i)throw new we(5101,!1);return this._eventNameToPlugin.set(r,i),i}};e.\u0275fac=function(i){return new(i||e)(Y(ju),Y(Pe))},e.\u0275prov=X({token:e,factory:e.\u0275fac});let n=e;return n})(),Do=class{constructor(e){this._doc=e}},_d="ng-app-id",lw=(()=>{let e=class e{constructor(r,i,s,o={}){this.doc=r,this.appId=i,this.nonce=s,this.platformId=o,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=Eo(o),this.resetHostNodes()}addStyles(r){for(let i of r)this.changeUsageCount(i,1)===1&&this.onStyleAdded(i)}removeStyles(r){for(let i of r)this.changeUsageCount(i,-1)<=0&&this.onStyleRemoved(i)}ngOnDestroy(){let r=this.styleNodesInDOM;r&&(r.forEach(i=>i.remove()),r.clear());for(let i of this.getAllStyles())this.onStyleRemoved(i);this.resetHostNodes()}addHost(r){this.hostNodes.add(r);for(let i of this.getAllStyles())this.addStyleToHost(r,i)}removeHost(r){this.hostNodes.delete(r)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(r){for(let i of this.hostNodes)this.addStyleToHost(i,r)}onStyleRemoved(r){let i=this.styleRef;i.get(r)?.elements?.forEach(s=>s.remove()),i.delete(r)}collectServerRenderedStyles(){let r=this.doc.head?.querySelectorAll(`style[${_d}="${this.appId}"]`);if(r?.length){let i=new Map;return r.forEach(s=>{s.textContent!=null&&i.set(s.textContent,s)}),i}return null}changeUsageCount(r,i){let s=this.styleRef;if(s.has(r)){let o=s.get(r);return o.usage+=i,o.usage}return s.set(r,{usage:i,elements:[]}),i}getStyleElement(r,i){let s=this.styleNodesInDOM,o=s?.get(i);if(o?.parentNode===r)return s.delete(i),o.removeAttribute(_d),o;{let a=this.doc.createElement("style");return this.nonce&&a.setAttribute("nonce",this.nonce),a.textContent=i,this.platformIsServer&&a.setAttribute(_d,this.appId),r.appendChild(a),a}}addStyleToHost(r,i){let s=this.getStyleElement(r,i),o=this.styleRef,a=o.get(i)?.elements;a?a.push(s):o.set(i,{elements:[s],usage:1})}resetHostNodes(){let r=this.hostNodes;r.clear(),r.add(this.doc.head)}};e.\u0275fac=function(i){return new(i||e)(Y(Ye),Y(qh),Y(Gh,8),Y(Ct))},e.\u0275prov=X({token:e,factory:e.\u0275fac});let n=e;return n})(),vd={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/Math/MathML"},Ad=/%COMP%/g,hw="%COMP%",cS=`_nghost-${hw}`,lS=`_ngcontent-${hw}`,hS=!0,dS=new te("",{providedIn:"root",factory:()=>hS});function fS(n){return lS.replace(Ad,n)}function pS(n){return cS.replace(Ad,n)}function dw(n,e){return e.map(t=>t.replace(Ad,n))}var ow=(()=>{let e=class e{constructor(r,i,s,o,a,c,l,d=null){this.eventManager=r,this.sharedStylesHost=i,this.appId=s,this.removeStylesOnCompDestroy=o,this.doc=a,this.platformId=c,this.ngZone=l,this.nonce=d,this.rendererByCompId=new Map,this.platformIsServer=Eo(c),this.defaultRenderer=new So(r,a,l,this.platformIsServer)}createRenderer(r,i){if(!r||!i)return this.defaultRenderer;this.platformIsServer&&i.encapsulation===po.ShadowDom&&(i=Qe(q({},i),{encapsulation:po.Emulated}));let s=this.getOrCreateRenderer(r,i);return s instanceof zu?s.applyToHost(r):s instanceof Ro&&s.applyStyles(),s}getOrCreateRenderer(r,i){let s=this.rendererByCompId,o=s.get(i.id);if(!o){let a=this.doc,c=this.ngZone,l=this.eventManager,d=this.sharedStylesHost,p=this.removeStylesOnCompDestroy,m=this.platformIsServer;switch(i.encapsulation){case po.Emulated:o=new zu(l,d,i,this.appId,p,a,c,m);break;case po.ShadowDom:return new Id(l,d,r,i,a,c,this.nonce,m);default:o=new Ro(l,d,i,p,a,c,m);break}s.set(i.id,o)}return o}ngOnDestroy(){this.rendererByCompId.clear()}};e.\u0275fac=function(i){return new(i||e)(Y(cw),Y(lw),Y(qh),Y(dS),Y(Ye),Y(Ct),Y(Pe),Y(Gh))},e.\u0275prov=X({token:e,factory:e.\u0275fac});let n=e;return n})(),So=class{constructor(e,t,r,i){this.eventManager=e,this.doc=t,this.ngZone=r,this.platformIsServer=i,this.data=Object.create(null),this.throwOnSyntheticProps=!0,this.destroyNode=null}destroy(){}createElement(e,t){return t?this.doc.createElementNS(vd[t]||t,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,t){(aw(e)?e.content:e).appendChild(t)}insertBefore(e,t,r){e&&(aw(e)?e.content:e).insertBefore(t,r)}removeChild(e,t){t.remove()}selectRootElement(e,t){let r=typeof e=="string"?this.doc.querySelector(e):e;if(!r)throw new we(-5104,!1);return t||(r.textContent=""),r}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,r,i){if(i){t=i+":"+t;let s=vd[i];s?e.setAttributeNS(s,t,r):e.setAttribute(t,r)}else e.setAttribute(t,r)}removeAttribute(e,t,r){if(r){let i=vd[r];i?e.removeAttributeNS(i,t):e.removeAttribute(`${r}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,r,i){i&(Ni.DashCase|Ni.Important)?e.style.setProperty(t,r,i&Ni.Important?"important":""):e.style[t]=r}removeStyle(e,t,r){r&Ni.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,r){e!=null&&(e[t]=r)}setValue(e,t){e.nodeValue=t}listen(e,t,r){if(typeof e=="string"&&(e=xi().getGlobalEventTarget(this.doc,e),!e))throw new Error(`Unsupported event target ${e} for event ${t}`);return this.eventManager.addEventListener(e,t,this.decoratePreventDefault(r))}decoratePreventDefault(e){return t=>{if(t==="__ngUnwrap__")return e;(this.platformIsServer?this.ngZone.runGuarded(()=>e(t)):e(t))===!1&&t.preventDefault()}}};function aw(n){return n.tagName==="TEMPLATE"&&n.content!==void 0}var Id=class extends So{constructor(e,t,r,i,s,o,a,c){super(e,s,o,c),this.sharedStylesHost=t,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let l=dw(i.id,i.styles);for(let d of l){let p=document.createElement("style");a&&p.setAttribute("nonce",a),p.textContent=d,this.shadowRoot.appendChild(p)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,r){return super.insertBefore(this.nodeOrShadowRoot(e),t,r)}removeChild(e,t){return super.removeChild(null,t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},Ro=class extends So{constructor(e,t,r,i,s,o,a,c){super(e,s,o,a),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=i,this.styles=c?dw(c,r.styles):r.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}},zu=class extends Ro{constructor(e,t,r,i,s,o,a,c){let l=i+"-"+r.id;super(e,t,r,s,o,a,c,l),this.contentAttr=fS(l),this.hostAttr=pS(l)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){let r=super.createElement(e,t);return super.setAttribute(r,this.contentAttr,""),r}},gS=(()=>{let e=class e extends Do{constructor(r){super(r)}supports(r){return!0}addEventListener(r,i,s){return r.addEventListener(i,s,!1),()=>this.removeEventListener(r,i,s)}removeEventListener(r,i,s){return r.removeEventListener(i,s)}};e.\u0275fac=function(i){return new(i||e)(Y(Ye))},e.\u0275prov=X({token:e,factory:e.\u0275fac});let n=e;return n})(),mS=(()=>{let e=class e extends Do{constructor(r){super(r),this.delegate=j(_v,{optional:!0})}supports(r){return this.delegate?this.delegate.supports(r):!1}addEventListener(r,i,s){return this.delegate.addEventListener(r,i,s)}removeEventListener(r,i,s){return this.delegate.removeEventListener(r,i,s)}};e.\u0275fac=function(i){return new(i||e)(Y(Ye))},e.\u0275prov=X({token:e,factory:e.\u0275fac});let n=e;return n})(),uw=["alt","control","meta","shift"],yS={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},_S={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey},vS=(()=>{let e=class e extends Do{constructor(r){super(r)}supports(r){return e.parseEventName(r)!=null}addEventListener(r,i,s){let o=e.parseEventName(i),a=e.eventCallback(o.fullKey,s,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>xi().onAndCancel(r,o.domEventName,a))}static parseEventName(r){let i=r.toLowerCase().split("."),s=i.shift();if(i.length===0||!(s==="keydown"||s==="keyup"))return null;let o=e._normalizeKey(i.pop()),a="",c=i.indexOf("code");if(c>-1&&(i.splice(c,1),a="code."),uw.forEach(d=>{let p=i.indexOf(d);p>-1&&(i.splice(p,1),a+=d+".")}),a+=o,i.length!=0||o.length===0)return null;let l={};return l.domEventName=s,l.fullKey=a,l}static matchEventFullKeyCode(r,i){let s=yS[r.key]||r.key,o="";return i.indexOf("code.")>-1&&(s=r.code,o="code."),s==null||!s?!1:(s=s.toLowerCase(),s===" "?s="space":s==="."&&(s="dot"),uw.forEach(a=>{if(a!==s){let c=_S[a];c(r)&&(o+=a+".")}}),o+=s,o===i)}static eventCallback(r,i,s){return o=>{e.matchEventFullKeyCode(o,r)&&s.runGuarded(()=>i(o))}}static _normalizeKey(r){return r==="esc"?"escape":r}};e.\u0275fac=function(i){return new(i||e)(Y(Ye))},e.\u0275prov=X({token:e,factory:e.\u0275fac});let n=e;return n})();function TL(n,e){return yv(q({rootComponent:n},wS(e)))}function wS(n){return{appProviders:[...bS,...n?.providers??[]],platformProviders:AS}}function ES(){Ed.makeCurrent()}function IS(){return new zh}function TS(){return H_(document),document}var AS=[{provide:Ct,useValue:hd},{provide:K_,useValue:ES,multi:!0},{provide:Ye,useFactory:TS,deps:[]}];var bS=[{provide:W_,useValue:"root"},{provide:zh,useFactory:IS,deps:[]},{provide:ju,useClass:gS,multi:!0,deps:[Ye,Pe,Ct]},{provide:ju,useClass:vS,multi:!0,deps:[Ye]},{provide:ju,useClass:mS,multi:!0},ow,lw,cw,{provide:iv,useExisting:ow},{provide:Fi,useClass:uS,deps:[]},[]];var fw=(()=>{let e=class e{constructor(r){this._doc=r}getTitle(){return this._doc.title}setTitle(r){this._doc.title=r||""}};e.\u0275fac=function(i){return new(i||e)(Y(Ye))},e.\u0275prov=X({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();var DS=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=X({token:e,factory:function(i){let s=null;return i?s=new(i||e):s=Y(SS),s},providedIn:"root"});let n=e;return n})(),SS=(()=>{let e=class e extends DS{constructor(r){super(),this._doc=r}sanitize(r,i){if(i==null)return null;switch(r){case jr.NONE:return i;case jr.HTML:return Pi(i,"HTML")?$r(i):tv(this._doc,String(i)).toString();case jr.STYLE:return Pi(i,"Style")?$r(i):i;case jr.SCRIPT:if(Pi(i,"Script"))return $r(i);throw new we(5200,!1);case jr.URL:return Pi(i,"URL")?$r(i):ev(String(i));case jr.RESOURCE_URL:if(Pi(i,"ResourceURL"))return $r(i);throw new we(5201,!1);default:throw new we(5202,!1)}}bypassSecurityTrustHtml(r){return Q_(r)}bypassSecurityTrustStyle(r){return Y_(r)}bypassSecurityTrustScript(r){return J_(r)}bypassSecurityTrustUrl(r){return X_(r)}bypassSecurityTrustResourceUrl(r){return Z_(r)}};e.\u0275fac=function(i){return new(i||e)(Y(Ye))},e.\u0275prov=X({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),Td=function(n){return n[n.NoHttpTransferCache=0]="NoHttpTransferCache",n[n.HttpTransferCacheOptions=1]="HttpTransferCacheOptions",n[n.I18nSupport=2]="I18nSupport",n[n.EventReplay=3]="EventReplay",n}(Td||{});function AL(...n){let e=[],t=new Set,r=t.has(Td.HttpTransferCacheOptions);for(let{\u0275providers:i,\u0275kind:s}of n)t.add(s),i.length&&e.push(i);return gt([[],vv(),t.has(Td.NoHttpTransferCache)||r?[]:sw({}),e])}var ne="primary",zo=Symbol("RouteTitle"),Cd=class{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}};function zi(n){return new Cd(n)}function CS(n,e,t){let r=t.path.split("/");if(r.length>n.length||t.pathMatch==="full"&&(e.hasChildren()||r.length<n.length))return null;let i={};for(let s=0;s<r.length;s++){let o=r[s],a=n[s];if(o[0]===":")i[o.substring(1)]=a;else if(o!==a.path)return null}return{consumed:n.slice(0,r.length),posParams:i}}function PS(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(!Qt(n[t],e[t]))return!1;return!0}function Qt(n,e){let t=n?Pd(n):void 0,r=e?Pd(e):void 0;if(!t||!r||t.length!=r.length)return!1;let i;for(let s=0;s<t.length;s++)if(i=t[s],!bw(n[i],e[i]))return!1;return!0}function Pd(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}function bw(n,e){if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return!1;let t=[...n].sort(),r=[...e].sort();return t.every((i,s)=>r[s]===i)}else return n===e}function Dw(n){return n.length>0?n[n.length-1]:null}function or(n){return O_(n)?n:Jh(n)?ot(Promise.resolve(n)):K(n)}var NS={exact:Rw,subset:Cw},Sw={exact:kS,subset:OS,ignored:()=>!0};function pw(n,e,t){return NS[t.paths](n.root,e.root,t.matrixParams)&&Sw[t.queryParams](n.queryParams,e.queryParams)&&!(t.fragment==="exact"&&n.fragment!==e.fragment)}function kS(n,e){return Qt(n,e)}function Rw(n,e,t){if(!Gr(n.segments,e.segments)||!Wu(n.segments,e.segments,t)||n.numberOfChildren!==e.numberOfChildren)return!1;for(let r in e.children)if(!n.children[r]||!Rw(n.children[r],e.children[r],t))return!1;return!0}function OS(n,e){return Object.keys(e).length<=Object.keys(n).length&&Object.keys(e).every(t=>bw(n[t],e[t]))}function Cw(n,e,t){return Pw(n,e,e.segments,t)}function Pw(n,e,t,r){if(n.segments.length>t.length){let i=n.segments.slice(0,t.length);return!(!Gr(i,t)||e.hasChildren()||!Wu(i,t,r))}else if(n.segments.length===t.length){if(!Gr(n.segments,t)||!Wu(n.segments,t,r))return!1;for(let i in e.children)if(!n.children[i]||!Cw(n.children[i],e.children[i],r))return!1;return!0}else{let i=t.slice(0,n.segments.length),s=t.slice(n.segments.length);return!Gr(n.segments,i)||!Wu(n.segments,i,r)||!n.children[ne]?!1:Pw(n.children[ne],e,s,r)}}function Wu(n,e,t){return e.every((r,i)=>Sw[t](n[i].parameters,r.parameters))}var Tn=class{constructor(e=new pe([],{}),t={},r=null){this.root=e,this.queryParams=t,this.fragment=r}get queryParamMap(){return this._queryParamMap??=zi(this.queryParams),this._queryParamMap}toString(){return FS.serialize(this)}},pe=class{constructor(e,t){this.segments=e,this.children=t,this.parent=null,Object.values(t).forEach(r=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Hu(this)}},qr=class{constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap??=zi(this.parameters),this._parameterMap}toString(){return kw(this)}};function MS(n,e){return Gr(n,e)&&n.every((t,r)=>Qt(t.parameters,e[r].parameters))}function Gr(n,e){return n.length!==e.length?!1:n.every((t,r)=>t.path===e[r].path)}function xS(n,e){let t=[];return Object.entries(n.children).forEach(([r,i])=>{r===ne&&(t=t.concat(e(i,r)))}),Object.entries(n.children).forEach(([r,i])=>{r!==ne&&(t=t.concat(e(i,r)))}),t}var qo=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=X({token:e,factory:()=>new qi,providedIn:"root"});let n=e;return n})(),qi=class{parse(e){let t=new kd(e);return new Tn(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){let t=`/${Co(e.root,!0)}`,r=US(e.queryParams),i=typeof e.fragment=="string"?`#${LS(e.fragment)}`:"";return`${t}${r}${i}`}},FS=new qi;function Hu(n){return n.segments.map(e=>kw(e)).join("/")}function Co(n,e){if(!n.hasChildren())return Hu(n);if(e){let t=n.children[ne]?Co(n.children[ne],!1):"",r=[];return Object.entries(n.children).forEach(([i,s])=>{i!==ne&&r.push(`${i}:${Co(s,!1)}`)}),r.length>0?`${t}(${r.join("//")})`:t}else{let t=xS(n,(r,i)=>i===ne?[Co(n.children[ne],!1)]:[`${i}:${Co(r,!1)}`]);return Object.keys(n.children).length===1&&n.children[ne]!=null?`${Hu(n)}/${t[0]}`:`${Hu(n)}/(${t.join("//")})`}}function Nw(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function qu(n){return Nw(n).replace(/%3B/gi,";")}function LS(n){return encodeURI(n)}function Nd(n){return Nw(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Ku(n){return decodeURIComponent(n)}function gw(n){return Ku(n.replace(/\+/g,"%20"))}function kw(n){return`${Nd(n.path)}${VS(n.parameters)}`}function VS(n){return Object.entries(n).map(([e,t])=>`;${Nd(e)}=${Nd(t)}`).join("")}function US(n){let e=Object.entries(n).map(([t,r])=>Array.isArray(r)?r.map(i=>`${qu(t)}=${qu(i)}`).join("&"):`${qu(t)}=${qu(r)}`).filter(t=>t);return e.length?`?${e.join("&")}`:""}var BS=/^[^\/()?;#]+/;function bd(n){let e=n.match(BS);return e?e[0]:""}var $S=/^[^\/()?;=#]+/;function jS(n){let e=n.match($S);return e?e[0]:""}var zS=/^[^=?&#]+/;function qS(n){let e=n.match(zS);return e?e[0]:""}var GS=/^[^&#]+/;function WS(n){let e=n.match(GS);return e?e[0]:""}var kd=class{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new pe([],{}):new pe([],this.parseChildren())}parseQueryParams(){let e={};if(this.consumeOptional("?"))do this.parseQueryParam(e);while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(r[ne]=new pe(e,t)),r}parseSegment(){let e=bd(this.remaining);if(e===""&&this.peekStartsWith(";"))throw new we(4009,!1);return this.capture(e),new qr(Ku(e),this.parseMatrixParams())}parseMatrixParams(){let e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){let t=jS(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){let i=bd(this.remaining);i&&(r=i,this.capture(r))}e[Ku(t)]=Ku(r)}parseQueryParam(e){let t=qS(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){let o=WS(this.remaining);o&&(r=o,this.capture(r))}let i=gw(t),s=gw(r);if(e.hasOwnProperty(i)){let o=e[i];Array.isArray(o)||(o=[o],e[i]=o),o.push(s)}else e[i]=s}parseParens(e){let t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let r=bd(this.remaining),i=this.remaining[r.length];if(i!=="/"&&i!==")"&&i!==";")throw new we(4010,!1);let s;r.indexOf(":")>-1?(s=r.slice(0,r.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=ne);let o=this.parseChildren();t[s]=Object.keys(o).length===1?o[ne]:new pe([],o),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return this.peekStartsWith(e)?(this.remaining=this.remaining.substring(e.length),!0):!1}capture(e){if(!this.consumeOptional(e))throw new we(4011,!1)}};function Ow(n){return n.segments.length>0?new pe([],{[ne]:n}):n}function Mw(n){let e={};for(let[r,i]of Object.entries(n.children)){let s=Mw(i);if(r===ne&&s.segments.length===0&&s.hasChildren())for(let[o,a]of Object.entries(s.children))e[o]=a;else(s.segments.length>0||s.hasChildren())&&(e[r]=s)}let t=new pe(n.segments,e);return HS(t)}function HS(n){if(n.numberOfChildren===1&&n.children[ne]){let e=n.children[ne];return new pe(n.segments.concat(e.segments),e.children)}return n}function Wr(n){return n instanceof Tn}function KS(n,e,t=null,r=null){let i=xw(n);return Fw(i,e,t,r)}function xw(n){let e;function t(s){let o={};for(let c of s.children){let l=t(c);o[c.outlet]=l}let a=new pe(s.url,o);return s===n&&(e=a),a}let r=t(n.root),i=Ow(r);return e??i}function Fw(n,e,t,r){let i=n;for(;i.parent;)i=i.parent;if(e.length===0)return Dd(i,i,i,t,r);let s=QS(e);if(s.toRoot())return Dd(i,i,new pe([],{}),t,r);let o=YS(s,i,n),a=o.processChildren?ko(o.segmentGroup,o.index,s.commands):Vw(o.segmentGroup,o.index,s.commands);return Dd(i,o.segmentGroup,a,t,r)}function Qu(n){return typeof n=="object"&&n!=null&&!n.outlets&&!n.segmentPath}function xo(n){return typeof n=="object"&&n!=null&&n.outlets}function Dd(n,e,t,r,i){let s={};r&&Object.entries(r).forEach(([c,l])=>{s[c]=Array.isArray(l)?l.map(d=>`${d}`):`${l}`});let o;n===e?o=t:o=Lw(n,e,t);let a=Ow(Mw(o));return new Tn(a,s,i)}function Lw(n,e,t){let r={};return Object.entries(n.children).forEach(([i,s])=>{s===e?r[i]=t:r[i]=Lw(s,e,t)}),new pe(n.segments,r)}var Yu=class{constructor(e,t,r){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=r,e&&r.length>0&&Qu(r[0]))throw new we(4003,!1);let i=r.find(xo);if(i&&i!==Dw(r))throw new we(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function QS(n){if(typeof n[0]=="string"&&n.length===1&&n[0]==="/")return new Yu(!0,0,n);let e=0,t=!1,r=n.reduce((i,s,o)=>{if(typeof s=="object"&&s!=null){if(s.outlets){let a={};return Object.entries(s.outlets).forEach(([c,l])=>{a[c]=typeof l=="string"?l.split("/"):l}),[...i,{outlets:a}]}if(s.segmentPath)return[...i,s.segmentPath]}return typeof s!="string"?[...i,s]:o===0?(s.split("/").forEach((a,c)=>{c==0&&a==="."||(c==0&&a===""?t=!0:a===".."?e++:a!=""&&i.push(a))}),i):[...i,s]},[]);return new Yu(t,e,r)}var Bi=class{constructor(e,t,r){this.segmentGroup=e,this.processChildren=t,this.index=r}};function YS(n,e,t){if(n.isAbsolute)return new Bi(e,!0,0);if(!t)return new Bi(e,!1,NaN);if(t.parent===null)return new Bi(t,!0,0);let r=Qu(n.commands[0])?0:1,i=t.segments.length-1+r;return JS(t,i,n.numberOfDoubleDots)}function JS(n,e,t){let r=n,i=e,s=t;for(;s>i;){if(s-=i,r=r.parent,!r)throw new we(4005,!1);i=r.segments.length}return new Bi(r,!1,i-s)}function XS(n){return xo(n[0])?n[0].outlets:{[ne]:n}}function Vw(n,e,t){if(n??=new pe([],{}),n.segments.length===0&&n.hasChildren())return ko(n,e,t);let r=ZS(n,e,t),i=t.slice(r.commandIndex);if(r.match&&r.pathIndex<n.segments.length){let s=new pe(n.segments.slice(0,r.pathIndex),{});return s.children[ne]=new pe(n.segments.slice(r.pathIndex),n.children),ko(s,0,i)}else return r.match&&i.length===0?new pe(n.segments,{}):r.match&&!n.hasChildren()?Od(n,e,t):r.match?ko(n,0,i):Od(n,e,t)}function ko(n,e,t){if(t.length===0)return new pe(n.segments,{});{let r=XS(t),i={};if(Object.keys(r).some(s=>s!==ne)&&n.children[ne]&&n.numberOfChildren===1&&n.children[ne].segments.length===0){let s=ko(n.children[ne],e,t);return new pe(n.segments,s.children)}return Object.entries(r).forEach(([s,o])=>{typeof o=="string"&&(o=[o]),o!==null&&(i[s]=Vw(n.children[s],e,o))}),Object.entries(n.children).forEach(([s,o])=>{r[s]===void 0&&(i[s]=o)}),new pe(n.segments,i)}}function ZS(n,e,t){let r=0,i=e,s={match:!1,pathIndex:0,commandIndex:0};for(;i<n.segments.length;){if(r>=t.length)return s;let o=n.segments[i],a=t[r];if(xo(a))break;let c=`${a}`,l=r<t.length-1?t[r+1]:null;if(i>0&&c===void 0)break;if(c&&l&&typeof l=="object"&&l.outlets===void 0){if(!yw(c,l,o))return s;r+=2}else{if(!yw(c,{},o))return s;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}function Od(n,e,t){let r=n.segments.slice(0,e),i=0;for(;i<t.length;){let s=t[i];if(xo(s)){let c=eR(s.outlets);return new pe(r,c)}if(i===0&&Qu(t[0])){let c=n.segments[e];r.push(new qr(c.path,mw(t[0]))),i++;continue}let o=xo(s)?s.outlets[ne]:`${s}`,a=i<t.length-1?t[i+1]:null;o&&a&&Qu(a)?(r.push(new qr(o,mw(a))),i+=2):(r.push(new qr(o,{})),i++)}return new pe(r,{})}function eR(n){let e={};return Object.entries(n).forEach(([t,r])=>{typeof r=="string"&&(r=[r]),r!==null&&(e[t]=Od(new pe([],{}),0,r))}),e}function mw(n){let e={};return Object.entries(n).forEach(([t,r])=>e[t]=`${r}`),e}function yw(n,e,t){return n==t.path&&Qt(e,t.parameters)}var Oo="imperative",Je=function(n){return n[n.NavigationStart=0]="NavigationStart",n[n.NavigationEnd=1]="NavigationEnd",n[n.NavigationCancel=2]="NavigationCancel",n[n.NavigationError=3]="NavigationError",n[n.RoutesRecognized=4]="RoutesRecognized",n[n.ResolveStart=5]="ResolveStart",n[n.ResolveEnd=6]="ResolveEnd",n[n.GuardsCheckStart=7]="GuardsCheckStart",n[n.GuardsCheckEnd=8]="GuardsCheckEnd",n[n.RouteConfigLoadStart=9]="RouteConfigLoadStart",n[n.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",n[n.ChildActivationStart=11]="ChildActivationStart",n[n.ChildActivationEnd=12]="ChildActivationEnd",n[n.ActivationStart=13]="ActivationStart",n[n.ActivationEnd=14]="ActivationEnd",n[n.Scroll=15]="Scroll",n[n.NavigationSkipped=16]="NavigationSkipped",n}(Je||{}),kt=class{constructor(e,t){this.id=e,this.url=t}},Gi=class extends kt{constructor(e,t,r="imperative",i=null){super(e,t),this.type=Je.NavigationStart,this.navigationTrigger=r,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},Bt=class extends kt{constructor(e,t,r){super(e,t),this.urlAfterRedirects=r,this.type=Je.NavigationEnd}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},Tt=function(n){return n[n.Redirect=0]="Redirect",n[n.SupersededByNewNavigation=1]="SupersededByNewNavigation",n[n.NoDataFromResolver=2]="NoDataFromResolver",n[n.GuardRejected=3]="GuardRejected",n}(Tt||{}),Ju=function(n){return n[n.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",n[n.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",n}(Ju||{}),In=class extends kt{constructor(e,t,r,i){super(e,t),this.reason=r,this.code=i,this.type=Je.NavigationCancel}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},ir=class extends kt{constructor(e,t,r,i){super(e,t),this.reason=r,this.code=i,this.type=Je.NavigationSkipped}},Fo=class extends kt{constructor(e,t,r,i){super(e,t),this.error=r,this.target=i,this.type=Je.NavigationError}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},Xu=class extends kt{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=Je.RoutesRecognized}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Md=class extends kt{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=Je.GuardsCheckStart}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},xd=class extends kt{constructor(e,t,r,i,s){super(e,t),this.urlAfterRedirects=r,this.state=i,this.shouldActivate=s,this.type=Je.GuardsCheckEnd}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},Fd=class extends kt{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=Je.ResolveStart}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Ld=class extends kt{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=Je.ResolveEnd}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Vd=class{constructor(e){this.route=e,this.type=Je.RouteConfigLoadStart}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},Ud=class{constructor(e){this.route=e,this.type=Je.RouteConfigLoadEnd}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},Bd=class{constructor(e){this.snapshot=e,this.type=Je.ChildActivationStart}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},$d=class{constructor(e){this.snapshot=e,this.type=Je.ChildActivationEnd}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},jd=class{constructor(e){this.snapshot=e,this.type=Je.ActivationStart}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},zd=class{constructor(e){this.snapshot=e,this.type=Je.ActivationEnd}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Zu=class{constructor(e,t,r){this.routerEvent=e,this.position=t,this.anchor=r,this.type=Je.Scroll}toString(){let e=this.position?`${this.position[0]}, ${this.position[1]}`:null;return`Scroll(anchor: '${this.anchor}', position: '${e}')`}},Lo=class{},Wi=class{constructor(e,t){this.url=e,this.navigationBehaviorOptions=t}};function tR(n,e){return n.providers&&!n._injector&&(n._injector=Yh(n.providers,e,`Route: ${n.path}`)),n._injector??e}function Ut(n){return n.outlet||ne}function nR(n,e){let t=n.filter(r=>Ut(r)===e);return t.push(...n.filter(r=>Ut(r)!==e)),t}function Go(n){if(!n)return null;if(n.routeConfig?._injector)return n.routeConfig._injector;for(let e=n.parent;e;e=e.parent){let t=e.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}var qd=class{get injector(){return Go(this.route?.snapshot)??this.rootInjector}set injector(e){}constructor(e){this.rootInjector=e,this.outlet=null,this.route=null,this.children=new Wo(this.rootInjector),this.attachRef=null}},Wo=(()=>{let e=class e{constructor(r){this.rootInjector=r,this.contexts=new Map}onChildOutletCreated(r,i){let s=this.getOrCreateContext(r);s.outlet=i,this.contexts.set(r,s)}onChildOutletDestroyed(r){let i=this.getContext(r);i&&(i.outlet=null,i.attachRef=null)}onOutletDeactivated(){let r=this.contexts;return this.contexts=new Map,r}onOutletReAttached(r){this.contexts=r}getOrCreateContext(r){let i=this.getContext(r);return i||(i=new qd(this.rootInjector),this.contexts.set(r,i)),i}getContext(r){return this.contexts.get(r)||null}};e.\u0275fac=function(i){return new(i||e)(Y(Br))},e.\u0275prov=X({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),ec=class{constructor(e){this._root=e}get root(){return this._root.value}parent(e){let t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){let t=Gd(e,this._root);return t?t.children.map(r=>r.value):[]}firstChild(e){let t=Gd(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){let t=Wd(e,this._root);return t.length<2?[]:t[t.length-2].children.map(i=>i.value).filter(i=>i!==e)}pathFromRoot(e){return Wd(e,this._root).map(t=>t.value)}};function Gd(n,e){if(n===e.value)return e;for(let t of e.children){let r=Gd(n,t);if(r)return r}return null}function Wd(n,e){if(n===e.value)return[e];for(let t of e.children){let r=Wd(n,t);if(r.length)return r.unshift(e),r}return[]}var It=class{constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}};function Ui(n){let e={};return n&&n.children.forEach(t=>e[t.value.outlet]=t),e}var tc=class extends ec{constructor(e,t){super(e),this.snapshot=t,tf(this,e)}toString(){return this.snapshot.toString()}};function Uw(n){let e=rR(n),t=new Dt([new qr("",{})]),r=new Dt({}),i=new Dt({}),s=new Dt({}),o=new Dt(""),a=new sr(t,r,s,o,i,ne,n,e.root);return a.snapshot=e.root,new tc(new It(a,[]),e)}function rR(n){let e={},t={},r={},i="",s=new $i([],e,r,i,t,ne,n,null,{});return new rc("",new It(s,[]))}var sr=class{constructor(e,t,r,i,s,o,a,c){this.urlSubject=e,this.paramsSubject=t,this.queryParamsSubject=r,this.fragmentSubject=i,this.dataSubject=s,this.outlet=o,this.component=a,this._futureSnapshot=c,this.title=this.dataSubject?.pipe(le(l=>l[zo]))??K(void 0),this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=s}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(le(e=>zi(e))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(le(e=>zi(e))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function nc(n,e,t="emptyOnly"){let r,{routeConfig:i}=n;return e!==null&&(t==="always"||i?.path===""||!e.component&&!e.routeConfig?.loadComponent)?r={params:q(q({},e.params),n.params),data:q(q({},e.data),n.data),resolve:q(q(q(q({},n.data),e.data),i?.data),n._resolvedData)}:r={params:q({},n.params),data:q({},n.data),resolve:q(q({},n.data),n._resolvedData??{})},i&&$w(i)&&(r.resolve[zo]=i.title),r}var $i=class{get title(){return this.data?.[zo]}constructor(e,t,r,i,s,o,a,c,l){this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=s,this.outlet=o,this.component=a,this.routeConfig=c,this._resolve=l}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=zi(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=zi(this.queryParams),this._queryParamMap}toString(){let e=this.url.map(r=>r.toString()).join("/"),t=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${e}', path:'${t}')`}},rc=class extends ec{constructor(e,t){super(t),this.url=e,tf(this,t)}toString(){return Bw(this._root)}};function tf(n,e){e.value._routerState=n,e.children.forEach(t=>tf(n,t))}function Bw(n){let e=n.children.length>0?` { ${n.children.map(Bw).join(", ")} } `:"";return`${n.value}${e}`}function Sd(n){if(n.snapshot){let e=n.snapshot,t=n._futureSnapshot;n.snapshot=t,Qt(e.queryParams,t.queryParams)||n.queryParamsSubject.next(t.queryParams),e.fragment!==t.fragment&&n.fragmentSubject.next(t.fragment),Qt(e.params,t.params)||n.paramsSubject.next(t.params),PS(e.url,t.url)||n.urlSubject.next(t.url),Qt(e.data,t.data)||n.dataSubject.next(t.data)}else n.snapshot=n._futureSnapshot,n.dataSubject.next(n._futureSnapshot.data)}function Hd(n,e){let t=Qt(n.params,e.params)&&MS(n.url,e.url),r=!n.parent!=!e.parent;return t&&!r&&(!n.parent||Hd(n.parent,e.parent))}function $w(n){return typeof n.title=="string"||n.title===null}var iR=(()=>{let e=class e{constructor(){this.activated=null,this._activatedRoute=null,this.name=ne,this.activateEvents=new Zn,this.deactivateEvents=new Zn,this.attachEvents=new Zn,this.detachEvents=new Zn,this.parentContexts=j(Wo),this.location=j(Oi),this.changeDetector=j(Mi),this.inputBinder=j(ac,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(r){if(r.name){let{firstChange:i,previousValue:s}=r.name;if(i)return;this.isTrackedInParentContexts(s)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(s)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(r){return this.parentContexts.getContext(r)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let r=this.parentContexts.getContext(this.name);r?.route&&(r.attachRef?this.attach(r.attachRef,r.route):this.activateWith(r.route,r.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new we(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new we(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new we(4012,!1);this.location.detach();let r=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(r.instance),r}attach(r,i){this.activated=r,this._activatedRoute=i,this.location.insert(r.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(r.instance)}deactivate(){if(this.activated){let r=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(r)}}activateWith(r,i){if(this.isActivated)throw new we(4013,!1);this._activatedRoute=r;let s=this.location,a=r.snapshot.component,c=this.parentContexts.getOrCreateContext(this.name).children,l=new Kd(r,c,s.injector);this.activated=s.createComponent(a,{index:s.length,injector:l,environmentInjector:i}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275dir=yn({type:e,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[Ri]});let n=e;return n})(),Kd=class n{__ngOutletInjector(e){return new n(this.route,this.childContexts,e)}constructor(e,t,r){this.route=e,this.childContexts=t,this.parent=r}get(e,t){return e===sr?this.route:e===Wo?this.childContexts:this.parent.get(e,t)}},ac=new te(""),_w=(()=>{let e=class e{constructor(){this.outletDataSubscriptions=new Map}bindActivatedRouteToOutletComponent(r){this.unsubscribeFromRouteData(r),this.subscribeToRouteData(r)}unsubscribeFromRouteData(r){this.outletDataSubscriptions.get(r)?.unsubscribe(),this.outletDataSubscriptions.delete(r)}subscribeToRouteData(r){let{activatedRoute:i}=r,s=Iu([i.queryParams,i.params,i.data]).pipe(wt(([o,a,c],l)=>(c=q(q(q({},o),a),c),l===0?K(c):Promise.resolve(c)))).subscribe(o=>{if(!r.isActivated||!r.activatedComponentRef||r.activatedRoute!==i||i.component===null){this.unsubscribeFromRouteData(r);return}let a=wv(i.component);if(!a){this.unsubscribeFromRouteData(r);return}for(let{templateName:c}of a.inputs)r.activatedComponentRef.setInput(c,o[c])});this.outletDataSubscriptions.set(r,s)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=X({token:e,factory:e.\u0275fac});let n=e;return n})();function sR(n,e,t){let r=Vo(n,e._root,t?t._root:void 0);return new tc(r,e)}function Vo(n,e,t){if(t&&n.shouldReuseRoute(e.value,t.value.snapshot)){let r=t.value;r._futureSnapshot=e.value;let i=oR(n,e,t);return new It(r,i)}else{if(n.shouldAttach(e.value)){let s=n.retrieve(e.value);if(s!==null){let o=s.route;return o.value._futureSnapshot=e.value,o.children=e.children.map(a=>Vo(n,a)),o}}let r=aR(e.value),i=e.children.map(s=>Vo(n,s));return new It(r,i)}}function oR(n,e,t){return e.children.map(r=>{for(let i of t.children)if(n.shouldReuseRoute(r.value,i.value.snapshot))return Vo(n,r,i);return Vo(n,r)})}function aR(n){return new sr(new Dt(n.url),new Dt(n.params),new Dt(n.queryParams),new Dt(n.fragment),new Dt(n.data),n.outlet,n.component,n)}var Uo=class{constructor(e,t){this.redirectTo=e,this.navigationBehaviorOptions=t}},jw="ngNavigationCancelingError";function ic(n,e){let{redirectTo:t,navigationBehaviorOptions:r}=Wr(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,i=zw(!1,Tt.Redirect);return i.url=t,i.navigationBehaviorOptions=r,i}function zw(n,e){let t=new Error(`NavigationCancelingError: ${n||""}`);return t[jw]=!0,t.cancellationCode=e,t}function uR(n){return qw(n)&&Wr(n.url)}function qw(n){return!!n&&n[jw]}var cR=(n,e,t,r)=>le(i=>(new Qd(e,i.targetRouterState,i.currentRouterState,t,r).activate(n),i)),Qd=class{constructor(e,t,r,i,s){this.routeReuseStrategy=e,this.futureState=t,this.currState=r,this.forwardEvent=i,this.inputBindingEnabled=s}activate(e){let t=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,r,e),Sd(this.futureState.root),this.activateChildRoutes(t,r,e)}deactivateChildRoutes(e,t,r){let i=Ui(t);e.children.forEach(s=>{let o=s.value.outlet;this.deactivateRoutes(s,i[o],r),delete i[o]}),Object.values(i).forEach(s=>{this.deactivateRouteAndItsChildren(s,r)})}deactivateRoutes(e,t,r){let i=e.value,s=t?t.value:null;if(i===s)if(i.component){let o=r.getContext(i.outlet);o&&this.deactivateChildRoutes(e,t,o.children)}else this.deactivateChildRoutes(e,t,r);else s&&this.deactivateRouteAndItsChildren(t,r)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){let r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,s=Ui(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,i);if(r&&r.outlet){let o=r.outlet.detach(),a=r.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:o,route:e,contexts:a})}}deactivateRouteAndOutlet(e,t){let r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,s=Ui(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,i);r&&(r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated()),r.attachRef=null,r.route=null)}activateChildRoutes(e,t,r){let i=Ui(t);e.children.forEach(s=>{this.activateRoutes(s,i[s.value.outlet],r),this.forwardEvent(new zd(s.value.snapshot))}),e.children.length&&this.forwardEvent(new $d(e.value.snapshot))}activateRoutes(e,t,r){let i=e.value,s=t?t.value:null;if(Sd(i),i===s)if(i.component){let o=r.getOrCreateContext(i.outlet);this.activateChildRoutes(e,t,o.children)}else this.activateChildRoutes(e,t,r);else if(i.component){let o=r.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){let a=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),o.children.onOutletReAttached(a.contexts),o.attachRef=a.componentRef,o.route=a.route.value,o.outlet&&o.outlet.attach(a.componentRef,a.route.value),Sd(a.route.value),this.activateChildRoutes(e,null,o.children)}else o.attachRef=null,o.route=i,o.outlet&&o.outlet.activateWith(i,o.injector),this.activateChildRoutes(e,null,o.children)}else this.activateChildRoutes(e,null,r)}},sc=class{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}},ji=class{constructor(e,t){this.component=e,this.route=t}};function lR(n,e,t){let r=n._root,i=e?e._root:null;return Po(r,i,t,[r.value])}function hR(n){let e=n.routeConfig?n.routeConfig.canActivateChild:null;return!e||e.length===0?null:{node:n,guards:e}}function Ki(n,e){let t=Symbol(),r=e.get(n,t);return r===t?typeof n=="function"&&!j_(n)?n:e.get(n):r}function Po(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=Ui(e);return n.children.forEach(o=>{dR(o,s[o.value.outlet],t,r.concat([o.value]),i),delete s[o.value.outlet]}),Object.entries(s).forEach(([o,a])=>Mo(a,t.getContext(o),i)),i}function dR(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=n.value,o=e?e.value:null,a=t?t.getContext(n.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){let c=fR(o,s,s.routeConfig.runGuardsAndResolvers);c?i.canActivateChecks.push(new sc(r)):(s.data=o.data,s._resolvedData=o._resolvedData),s.component?Po(n,e,a?a.children:null,r,i):Po(n,e,t,r,i),c&&a&&a.outlet&&a.outlet.isActivated&&i.canDeactivateChecks.push(new ji(a.outlet.component,o))}else o&&Mo(e,a,i),i.canActivateChecks.push(new sc(r)),s.component?Po(n,null,a?a.children:null,r,i):Po(n,null,t,r,i);return i}function fR(n,e,t){if(typeof t=="function")return t(n,e);switch(t){case"pathParamsChange":return!Gr(n.url,e.url);case"pathParamsOrQueryParamsChange":return!Gr(n.url,e.url)||!Qt(n.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!Hd(n,e)||!Qt(n.queryParams,e.queryParams);case"paramsChange":default:return!Hd(n,e)}}function Mo(n,e,t){let r=Ui(n),i=n.value;Object.entries(r).forEach(([s,o])=>{i.component?e?Mo(o,e.children.getContext(s),t):Mo(o,null,t):Mo(o,e,t)}),i.component?e&&e.outlet&&e.outlet.isActivated?t.canDeactivateChecks.push(new ji(e.outlet.component,i)):t.canDeactivateChecks.push(new ji(null,i)):t.canDeactivateChecks.push(new ji(null,i))}function Ho(n){return typeof n=="function"}function pR(n){return typeof n=="boolean"}function gR(n){return n&&Ho(n.canLoad)}function mR(n){return n&&Ho(n.canActivate)}function yR(n){return n&&Ho(n.canActivateChild)}function _R(n){return n&&Ho(n.canDeactivate)}function vR(n){return n&&Ho(n.canMatch)}function Gw(n){return n instanceof M_||n?.name==="EmptyError"}var Gu=Symbol("INITIAL_VALUE");function Hi(){return wt(n=>Iu(n.map(e=>e.pipe(Si(1),U_(Gu)))).pipe(le(e=>{for(let t of e)if(t!==!0){if(t===Gu)return Gu;if(t===!1||wR(t))return t}return!0}),mn(e=>e!==Gu),Si(1)))}function wR(n){return Wr(n)||n instanceof Uo}function ER(n,e){return vt(t=>{let{targetSnapshot:r,currentSnapshot:i,guards:{canActivateChecks:s,canDeactivateChecks:o}}=t;return o.length===0&&s.length===0?K(Qe(q({},t),{guardsResult:!0})):IR(o,r,i,n).pipe(vt(a=>a&&pR(a)?TR(r,s,n,e):K(a)),le(a=>Qe(q({},t),{guardsResult:a})))})}function IR(n,e,t,r){return ot(n).pipe(vt(i=>RR(i.component,i.route,t,e,r)),Yn(i=>i!==!0,!0))}function TR(n,e,t,r){return ot(e).pipe(Qn(i=>x_(bR(i.route.parent,r),AR(i.route,r),SR(n,i.path,t),DR(n,i.route,t))),Yn(i=>i!==!0,!0))}function AR(n,e){return n!==null&&e&&e(new jd(n)),K(!0)}function bR(n,e){return n!==null&&e&&e(new Bd(n)),K(!0)}function DR(n,e,t){let r=e.routeConfig?e.routeConfig.canActivate:null;if(!r||r.length===0)return K(!0);let i=r.map(s=>Lh(()=>{let o=Go(e)??t,a=Ki(s,o),c=mR(a)?a.canActivate(e,n):St(o,()=>a(e,n));return or(c).pipe(Yn())}));return K(i).pipe(Hi())}function SR(n,e,t){let r=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(o=>hR(o)).filter(o=>o!==null).map(o=>Lh(()=>{let a=o.guards.map(c=>{let l=Go(o.node)??t,d=Ki(c,l),p=yR(d)?d.canActivateChild(r,n):St(l,()=>d(r,n));return or(p).pipe(Yn())});return K(a).pipe(Hi())}));return K(s).pipe(Hi())}function RR(n,e,t,r,i){let s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;if(!s||s.length===0)return K(!0);let o=s.map(a=>{let c=Go(e)??i,l=Ki(a,c),d=_R(l)?l.canDeactivate(n,e,t,r):St(c,()=>l(n,e,t,r));return or(d).pipe(Yn())});return K(o).pipe(Hi())}function CR(n,e,t,r){let i=e.canLoad;if(i===void 0||i.length===0)return K(!0);let s=i.map(o=>{let a=Ki(o,n),c=gR(a)?a.canLoad(e,t):St(n,()=>a(e,t));return or(c)});return K(s).pipe(Hi(),Ww(r))}function Ww(n){return P_(Ve(e=>{if(typeof e!="boolean")throw ic(n,e)}),le(e=>e===!0))}function PR(n,e,t,r){let i=e.canMatch;if(!i||i.length===0)return K(!0);let s=i.map(o=>{let a=Ki(o,n),c=vR(a)?a.canMatch(e,t):St(n,()=>a(e,t));return or(c)});return K(s).pipe(Hi(),Ww(r))}var Bo=class{constructor(e){this.segmentGroup=e||null}},$o=class extends Error{constructor(e){super(),this.urlTree=e}};function Vi(n){return ho(new Bo(n))}function NR(n){return ho(new we(4e3,!1))}function kR(n){return ho(zw(!1,Tt.GuardRejected))}var Yd=class{constructor(e,t){this.urlSerializer=e,this.urlTree=t}lineralizeSegments(e,t){let r=[],i=t.root;for(;;){if(r=r.concat(i.segments),i.numberOfChildren===0)return K(r);if(i.numberOfChildren>1||!i.children[ne])return NR(`${e.redirectTo}`);i=i.children[ne]}}applyRedirectCommands(e,t,r,i,s){if(typeof t!="string"){let a=t,{queryParams:c,fragment:l,routeConfig:d,url:p,outlet:m,params:w,data:D,title:k}=i,S=St(s,()=>a({params:w,data:D,queryParams:c,fragment:l,routeConfig:d,url:p,outlet:m,title:k}));if(S instanceof Tn)throw new $o(S);t=S}let o=this.applyRedirectCreateUrlTree(t,this.urlSerializer.parse(t),e,r);if(t[0]==="/")throw new $o(o);return o}applyRedirectCreateUrlTree(e,t,r,i){let s=this.createSegmentGroup(e,t.root,r,i);return new Tn(s,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){let r={};return Object.entries(e).forEach(([i,s])=>{if(typeof s=="string"&&s[0]===":"){let a=s.substring(1);r[i]=t[a]}else r[i]=s}),r}createSegmentGroup(e,t,r,i){let s=this.createSegments(e,t.segments,r,i),o={};return Object.entries(t.children).forEach(([a,c])=>{o[a]=this.createSegmentGroup(e,c,r,i)}),new pe(s,o)}createSegments(e,t,r,i){return t.map(s=>s.path[0]===":"?this.findPosParam(e,s,i):this.findOrReturn(s,r))}findPosParam(e,t,r){let i=r[t.path.substring(1)];if(!i)throw new we(4001,!1);return i}findOrReturn(e,t){let r=0;for(let i of t){if(i.path===e.path)return t.splice(r),i;r++}return e}},Jd={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function OR(n,e,t,r,i){let s=nf(n,e,t);return s.matched?(r=tR(e,r),PR(r,e,t,i).pipe(le(o=>o===!0?s:q({},Jd)))):K(s)}function nf(n,e,t){if(e.path==="**")return MR(t);if(e.path==="")return e.pathMatch==="full"&&(n.hasChildren()||t.length>0)?q({},Jd):{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};let i=(e.matcher||CS)(t,n,e);if(!i)return q({},Jd);let s={};Object.entries(i.posParams??{}).forEach(([a,c])=>{s[a]=c.path});let o=i.consumed.length>0?q(q({},s),i.consumed[i.consumed.length-1].parameters):s;return{matched:!0,consumedSegments:i.consumed,remainingSegments:t.slice(i.consumed.length),parameters:o,positionalParamSegments:i.posParams??{}}}function MR(n){return{matched:!0,parameters:n.length>0?Dw(n).parameters:{},consumedSegments:n,remainingSegments:[],positionalParamSegments:{}}}function vw(n,e,t,r){return t.length>0&&LR(n,t,r)?{segmentGroup:new pe(e,FR(r,new pe(t,n.children))),slicedSegments:[]}:t.length===0&&VR(n,t,r)?{segmentGroup:new pe(n.segments,xR(n,t,r,n.children)),slicedSegments:t}:{segmentGroup:new pe(n.segments,n.children),slicedSegments:t}}function xR(n,e,t,r){let i={};for(let s of t)if(uc(n,e,s)&&!r[Ut(s)]){let o=new pe([],{});i[Ut(s)]=o}return q(q({},r),i)}function FR(n,e){let t={};t[ne]=e;for(let r of n)if(r.path===""&&Ut(r)!==ne){let i=new pe([],{});t[Ut(r)]=i}return t}function LR(n,e,t){return t.some(r=>uc(n,e,r)&&Ut(r)!==ne)}function VR(n,e,t){return t.some(r=>uc(n,e,r))}function uc(n,e,t){return(n.hasChildren()||e.length>0)&&t.pathMatch==="full"?!1:t.path===""}function UR(n,e,t,r){return Ut(n)!==r&&(r===ne||!uc(e,t,n))?!1:nf(e,n,t).matched}function BR(n,e,t){return e.length===0&&!n.children[t]}var Xd=class{};function $R(n,e,t,r,i,s,o="emptyOnly"){return new Zd(n,e,t,r,i,o,s).recognize()}var jR=31,Zd=class{constructor(e,t,r,i,s,o,a){this.injector=e,this.configLoader=t,this.rootComponentType=r,this.config=i,this.urlTree=s,this.paramsInheritanceStrategy=o,this.urlSerializer=a,this.applyRedirects=new Yd(this.urlSerializer,this.urlTree),this.absoluteRedirectCount=0,this.allowRedirects=!0}noMatchError(e){return new we(4002,`'${e.segmentGroup}'`)}recognize(){let e=vw(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(e).pipe(le(({children:t,rootSnapshot:r})=>{let i=new It(r,t),s=new rc("",i),o=KS(r,[],this.urlTree.queryParams,this.urlTree.fragment);return o.queryParams=this.urlTree.queryParams,s.url=this.urlSerializer.serialize(o),{state:s,tree:o}}))}match(e){let t=new $i([],Object.freeze({}),Object.freeze(q({},this.urlTree.queryParams)),this.urlTree.fragment,Object.freeze({}),ne,this.rootComponentType,null,{});return this.processSegmentGroup(this.injector,this.config,e,ne,t).pipe(le(r=>({children:r,rootSnapshot:t})),Di(r=>{if(r instanceof $o)return this.urlTree=r.urlTree,this.match(r.urlTree.root);throw r instanceof Bo?this.noMatchError(r):r}))}processSegmentGroup(e,t,r,i,s){return r.segments.length===0&&r.hasChildren()?this.processChildren(e,t,r,s):this.processSegment(e,t,r,r.segments,i,!0,s).pipe(le(o=>o instanceof It?[o]:[]))}processChildren(e,t,r,i){let s=[];for(let o of Object.keys(r.children))o==="primary"?s.unshift(o):s.push(o);return ot(s).pipe(Qn(o=>{let a=r.children[o],c=nR(t,o);return this.processSegmentGroup(e,c,a,o,i)}),V_((o,a)=>(o.push(...a),o)),Vh(null),L_(),vt(o=>{if(o===null)return Vi(r);let a=Hw(o);return zR(a),K(a)}))}processSegment(e,t,r,i,s,o,a){return ot(t).pipe(Qn(c=>this.processSegmentAgainstRoute(c._injector??e,t,c,r,i,s,o,a).pipe(Di(l=>{if(l instanceof Bo)return K(null);throw l}))),Yn(c=>!!c),Di(c=>{if(Gw(c))return BR(r,i,s)?K(new Xd):Vi(r);throw c}))}processSegmentAgainstRoute(e,t,r,i,s,o,a,c){return UR(r,i,s,o)?r.redirectTo===void 0?this.matchSegmentAgainstRoute(e,i,r,s,o,c):this.allowRedirects&&a?this.expandSegmentAgainstRouteUsingRedirect(e,i,t,r,s,o,c):Vi(i):Vi(i)}expandSegmentAgainstRouteUsingRedirect(e,t,r,i,s,o,a){let{matched:c,parameters:l,consumedSegments:d,positionalParamSegments:p,remainingSegments:m}=nf(t,i,s);if(!c)return Vi(t);typeof i.redirectTo=="string"&&i.redirectTo[0]==="/"&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>jR&&(this.allowRedirects=!1));let w=new $i(s,l,Object.freeze(q({},this.urlTree.queryParams)),this.urlTree.fragment,ww(i),Ut(i),i.component??i._loadedComponent??null,i,Ew(i)),D=nc(w,a,this.paramsInheritanceStrategy);w.params=Object.freeze(D.params),w.data=Object.freeze(D.data);let k=this.applyRedirects.applyRedirectCommands(d,i.redirectTo,p,w,e);return this.applyRedirects.lineralizeSegments(i,k).pipe(vt(S=>this.processSegment(e,r,t,S.concat(m),o,!1,a)))}matchSegmentAgainstRoute(e,t,r,i,s,o){let a=OR(t,r,i,e,this.urlSerializer);return r.path==="**"&&(t.children={}),a.pipe(wt(c=>c.matched?(e=r._injector??e,this.getChildConfig(e,r,i).pipe(wt(({routes:l})=>{let d=r._loadedInjector??e,{parameters:p,consumedSegments:m,remainingSegments:w}=c,D=new $i(m,p,Object.freeze(q({},this.urlTree.queryParams)),this.urlTree.fragment,ww(r),Ut(r),r.component??r._loadedComponent??null,r,Ew(r)),k=nc(D,o,this.paramsInheritanceStrategy);D.params=Object.freeze(k.params),D.data=Object.freeze(k.data);let{segmentGroup:S,slicedSegments:x}=vw(t,m,w,l);if(x.length===0&&S.hasChildren())return this.processChildren(d,l,S,D).pipe(le(F=>new It(D,F)));if(l.length===0&&x.length===0)return K(new It(D,[]));let $=Ut(r)===s;return this.processSegment(d,l,S,x,$?ne:s,!0,D).pipe(le(F=>new It(D,F instanceof It?[F]:[])))}))):Vi(t)))}getChildConfig(e,t,r){return t.children?K({routes:t.children,injector:e}):t.loadChildren?t._loadedRoutes!==void 0?K({routes:t._loadedRoutes,injector:t._loadedInjector}):CR(e,t,r,this.urlSerializer).pipe(vt(i=>i?this.configLoader.loadChildren(e,t).pipe(Ve(s=>{t._loadedRoutes=s.routes,t._loadedInjector=s.injector})):kR(t))):K({routes:[],injector:e})}};function zR(n){n.sort((e,t)=>e.value.outlet===ne?-1:t.value.outlet===ne?1:e.value.outlet.localeCompare(t.value.outlet))}function qR(n){let e=n.value.routeConfig;return e&&e.path===""}function Hw(n){let e=[],t=new Set;for(let r of n){if(!qR(r)){e.push(r);continue}let i=e.find(s=>r.value.routeConfig===s.value.routeConfig);i!==void 0?(i.children.push(...r.children),t.add(i)):e.push(r)}for(let r of t){let i=Hw(r.children);e.push(new It(r.value,i))}return e.filter(r=>!t.has(r))}function ww(n){return n.data||{}}function Ew(n){return n.resolve||{}}function GR(n,e,t,r,i,s){return vt(o=>$R(n,e,t,r,o.extractedUrl,i,s).pipe(le(({state:a,tree:c})=>Qe(q({},o),{targetSnapshot:a,urlAfterRedirects:c}))))}function WR(n,e){return vt(t=>{let{targetSnapshot:r,guards:{canActivateChecks:i}}=t;if(!i.length)return K(t);let s=new Set(i.map(c=>c.route)),o=new Set;for(let c of s)if(!o.has(c))for(let l of Kw(c))o.add(l);let a=0;return ot(o).pipe(Qn(c=>s.has(c)?HR(c,r,n,e):(c.data=nc(c,c.parent,n).resolve,K(void 0))),Ve(()=>a++),Uh(1),vt(c=>a===o.size?K(t):Kn))})}function Kw(n){let e=n.children.map(t=>Kw(t)).flat();return[n,...e]}function HR(n,e,t,r){let i=n.routeConfig,s=n._resolve;return i?.title!==void 0&&!$w(i)&&(s[zo]=i.title),KR(s,n,e,r).pipe(le(o=>(n._resolvedData=o,n.data=nc(n,n.parent,t).resolve,null)))}function KR(n,e,t,r){let i=Pd(n);if(i.length===0)return K({});let s={};return ot(i).pipe(vt(o=>QR(n[o],e,t,r).pipe(Yn(),Ve(a=>{if(a instanceof Uo)throw ic(new qi,a);s[o]=a}))),Uh(1),F_(s),Di(o=>Gw(o)?Kn:ho(o)))}function QR(n,e,t,r){let i=Go(e)??r,s=Ki(n,i),o=s.resolve?s.resolve(e,t):St(i,()=>s(e,t));return or(o)}function Rd(n){return wt(e=>{let t=n(e);return t?ot(t).pipe(le(()=>e)):K(e)})}var Qw=(()=>{let e=class e{buildTitle(r){let i,s=r.root;for(;s!==void 0;)i=this.getResolvedTitleForRoute(s)??i,s=s.children.find(o=>o.outlet===ne);return i}getResolvedTitleForRoute(r){return r.data[zo]}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=X({token:e,factory:()=>j(YR),providedIn:"root"});let n=e;return n})(),YR=(()=>{let e=class e extends Qw{constructor(r){super(),this.title=r}updateTitle(r){let i=this.buildTitle(r);i!==void 0&&this.title.setTitle(i)}};e.\u0275fac=function(i){return new(i||e)(Y(fw))},e.\u0275prov=X({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),Ko=new te("",{providedIn:"root",factory:()=>({})}),JR=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=q_({type:e,selectors:[["ng-component"]],standalone:!0,features:[fv],decls:1,vars:0,template:function(i,s){i&1&&uv(0,"router-outlet")},dependencies:[iR],encapsulation:2});let n=e;return n})();function rf(n){let e=n.children&&n.children.map(rf),t=e?Qe(q({},n),{children:e}):q({},n);return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==ne&&(t.component=JR),t}var jo=new te(""),sf=(()=>{let e=class e{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=j(Au)}loadComponent(r){if(this.componentLoaders.get(r))return this.componentLoaders.get(r);if(r._loadedComponent)return K(r._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(r);let i=or(r.loadComponent()).pipe(le(Yw),Ve(o=>{this.onLoadEndListener&&this.onLoadEndListener(r),r._loadedComponent=o}),Ur(()=>{this.componentLoaders.delete(r)})),s=new Oh(i,()=>new Hn).pipe(kh());return this.componentLoaders.set(r,s),s}loadChildren(r,i){if(this.childrenLoaders.get(i))return this.childrenLoaders.get(i);if(i._loadedRoutes)return K({routes:i._loadedRoutes,injector:i._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(i);let o=XR(i,this.compiler,r,this.onLoadEndListener).pipe(Ur(()=>{this.childrenLoaders.delete(i)})),a=new Oh(o,()=>new Hn).pipe(kh());return this.childrenLoaders.set(i,a),a}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=X({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function XR(n,e,t,r){return or(n.loadChildren()).pipe(le(Yw),vt(i=>i instanceof ov||Array.isArray(i)?K(i):ot(e.compileModuleAsync(i))),le(i=>{r&&r(n);let s,o,a=!1;return Array.isArray(i)?(o=i,a=!0):(s=i.create(t).injector,o=s.get(jo,[],{optional:!0,self:!0}).flat()),{routes:o.map(rf),injector:s}}))}function ZR(n){return n&&typeof n=="object"&&"default"in n}function Yw(n){return ZR(n)?n.default:n}var of=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=X({token:e,factory:()=>j(eC),providedIn:"root"});let n=e;return n})(),eC=(()=>{let e=class e{shouldProcessUrl(r){return!0}extract(r){return r}merge(r,i){return r}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=X({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),Jw=new te(""),Xw=new te("");function tC(n,e,t){let r=n.get(Xw),i=n.get(Ye);return n.get(Pe).runOutsideAngular(()=>{if(!i.startViewTransition||r.skipNextTransition)return r.skipNextTransition=!1,new Promise(l=>setTimeout(l));let s,o=new Promise(l=>{s=l}),a=i.startViewTransition(()=>(s(),nC(n))),{onViewTransitionCreated:c}=r;return c&&St(n,()=>c({transition:a,from:e,to:t})),o})}function nC(n){return new Promise(e=>{sv({read:()=>setTimeout(e)},{injector:n})})}var rC=new te(""),af=(()=>{let e=class e{get hasRequestedNavigation(){return this.navigationId!==0}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new Hn,this.transitionAbortSubject=new Hn,this.configLoader=j(sf),this.environmentInjector=j(Br),this.urlSerializer=j(qo),this.rootContexts=j(Wo),this.location=j(Li),this.inputBindingEnabled=j(ac,{optional:!0})!==null,this.titleStrategy=j(Qw),this.options=j(Ko,{optional:!0})||{},this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlHandlingStrategy=j(of),this.createViewTransition=j(Jw,{optional:!0}),this.navigationErrorHandler=j(rC,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>K(void 0),this.rootComponentType=null;let r=s=>this.events.next(new Vd(s)),i=s=>this.events.next(new Ud(s));this.configLoader.onLoadEndListener=i,this.configLoader.onLoadStartListener=r}complete(){this.transitions?.complete()}handleNavigationRequest(r){let i=++this.navigationId;this.transitions?.next(Qe(q(q({},this.transitions.value),r),{id:i}))}setupNavigations(r,i,s){return this.transitions=new Dt({id:0,currentUrlTree:i,currentRawUrl:i,extractedUrl:this.urlHandlingStrategy.extract(i),urlAfterRedirects:this.urlHandlingStrategy.extract(i),rawUrl:i,extras:{},resolve:()=>{},reject:()=>{},promise:Promise.resolve(!0),source:Oo,restoredState:null,currentSnapshot:s.snapshot,targetSnapshot:null,currentRouterState:s,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(mn(o=>o.id!==0),le(o=>Qe(q({},o),{extractedUrl:this.urlHandlingStrategy.extract(o.rawUrl)})),wt(o=>{let a=!1,c=!1;return K(o).pipe(wt(l=>{if(this.navigationId>o.id)return this.cancelNavigationTransition(o,"",Tt.SupersededByNewNavigation),Kn;this.currentTransition=o,this.currentNavigation={id:l.id,initialUrl:l.rawUrl,extractedUrl:l.extractedUrl,targetBrowserUrl:typeof l.extras.browserUrl=="string"?this.urlSerializer.parse(l.extras.browserUrl):l.extras.browserUrl,trigger:l.source,extras:l.extras,previousNavigation:this.lastSuccessfulNavigation?Qe(q({},this.lastSuccessfulNavigation),{previousNavigation:null}):null};let d=!r.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),p=l.extras.onSameUrlNavigation??r.onSameUrlNavigation;if(!d&&p!=="reload"){let m="";return this.events.next(new ir(l.id,this.urlSerializer.serialize(l.rawUrl),m,Ju.IgnoredSameUrlNavigation)),l.resolve(!1),Kn}if(this.urlHandlingStrategy.shouldProcessUrl(l.rawUrl))return K(l).pipe(wt(m=>{let w=this.transitions?.getValue();return this.events.next(new Gi(m.id,this.urlSerializer.serialize(m.extractedUrl),m.source,m.restoredState)),w!==this.transitions?.getValue()?Kn:Promise.resolve(m)}),GR(this.environmentInjector,this.configLoader,this.rootComponentType,r.config,this.urlSerializer,this.paramsInheritanceStrategy),Ve(m=>{o.targetSnapshot=m.targetSnapshot,o.urlAfterRedirects=m.urlAfterRedirects,this.currentNavigation=Qe(q({},this.currentNavigation),{finalUrl:m.urlAfterRedirects});let w=new Xu(m.id,this.urlSerializer.serialize(m.extractedUrl),this.urlSerializer.serialize(m.urlAfterRedirects),m.targetSnapshot);this.events.next(w)}));if(d&&this.urlHandlingStrategy.shouldProcessUrl(l.currentRawUrl)){let{id:m,extractedUrl:w,source:D,restoredState:k,extras:S}=l,x=new Gi(m,this.urlSerializer.serialize(w),D,k);this.events.next(x);let $=Uw(this.rootComponentType).snapshot;return this.currentTransition=o=Qe(q({},l),{targetSnapshot:$,urlAfterRedirects:w,extras:Qe(q({},S),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.finalUrl=w,K(o)}else{let m="";return this.events.next(new ir(l.id,this.urlSerializer.serialize(l.extractedUrl),m,Ju.IgnoredByUrlHandlingStrategy)),l.resolve(!1),Kn}}),Ve(l=>{let d=new Md(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(d)}),le(l=>(this.currentTransition=o=Qe(q({},l),{guards:lR(l.targetSnapshot,l.currentSnapshot,this.rootContexts)}),o)),ER(this.environmentInjector,l=>this.events.next(l)),Ve(l=>{if(o.guardsResult=l.guardsResult,l.guardsResult&&typeof l.guardsResult!="boolean")throw ic(this.urlSerializer,l.guardsResult);let d=new xd(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot,!!l.guardsResult);this.events.next(d)}),mn(l=>l.guardsResult?!0:(this.cancelNavigationTransition(l,"",Tt.GuardRejected),!1)),Rd(l=>{if(l.guards.canActivateChecks.length)return K(l).pipe(Ve(d=>{let p=new Fd(d.id,this.urlSerializer.serialize(d.extractedUrl),this.urlSerializer.serialize(d.urlAfterRedirects),d.targetSnapshot);this.events.next(p)}),wt(d=>{let p=!1;return K(d).pipe(WR(this.paramsInheritanceStrategy,this.environmentInjector),Ve({next:()=>p=!0,complete:()=>{p||this.cancelNavigationTransition(d,"",Tt.NoDataFromResolver)}}))}),Ve(d=>{let p=new Ld(d.id,this.urlSerializer.serialize(d.extractedUrl),this.urlSerializer.serialize(d.urlAfterRedirects),d.targetSnapshot);this.events.next(p)}))}),Rd(l=>{let d=p=>{let m=[];p.routeConfig?.loadComponent&&!p.routeConfig._loadedComponent&&m.push(this.configLoader.loadComponent(p.routeConfig).pipe(Ve(w=>{p.component=w}),le(()=>{})));for(let w of p.children)m.push(...d(w));return m};return Iu(d(l.targetSnapshot.root)).pipe(Vh(null),Si(1))}),Rd(()=>this.afterPreactivation()),wt(()=>{let{currentSnapshot:l,targetSnapshot:d}=o,p=this.createViewTransition?.(this.environmentInjector,l.root,d.root);return p?ot(p).pipe(le(()=>o)):K(o)}),le(l=>{let d=sR(r.routeReuseStrategy,l.targetSnapshot,l.currentRouterState);return this.currentTransition=o=Qe(q({},l),{targetRouterState:d}),this.currentNavigation.targetRouterState=d,o}),Ve(()=>{this.events.next(new Lo)}),cR(this.rootContexts,r.routeReuseStrategy,l=>this.events.next(l),this.inputBindingEnabled),Si(1),Ve({next:l=>{a=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new Bt(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects))),this.titleStrategy?.updateTitle(l.targetRouterState.snapshot),l.resolve(!0)},complete:()=>{a=!0}}),B_(this.transitionAbortSubject.pipe(Ve(l=>{throw l}))),Ur(()=>{!a&&!c&&this.cancelNavigationTransition(o,"",Tt.SupersededByNewNavigation),this.currentTransition?.id===o.id&&(this.currentNavigation=null,this.currentTransition=null)}),Di(l=>{if(c=!0,qw(l))this.events.next(new In(o.id,this.urlSerializer.serialize(o.extractedUrl),l.message,l.cancellationCode)),uR(l)?this.events.next(new Wi(l.url,l.navigationBehaviorOptions)):o.resolve(!1);else{let d=new Fo(o.id,this.urlSerializer.serialize(o.extractedUrl),l,o.targetSnapshot??void 0);try{let p=St(this.environmentInjector,()=>this.navigationErrorHandler?.(d));if(p instanceof Uo){let{message:m,cancellationCode:w}=ic(this.urlSerializer,p);this.events.next(new In(o.id,this.urlSerializer.serialize(o.extractedUrl),m,w)),this.events.next(new Wi(p.redirectTo,p.navigationBehaviorOptions))}else{this.events.next(d);let m=r.errorHandler(l);o.resolve(!!m)}}catch(p){this.options.resolveNavigationPromiseOnError?o.resolve(!1):o.reject(p)}}return Kn}))}))}cancelNavigationTransition(r,i,s){let o=new In(r.id,this.urlSerializer.serialize(r.extractedUrl),i,s);this.events.next(o),r.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){let r=this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))),i=this.currentNavigation?.targetBrowserUrl??this.currentNavigation?.extractedUrl;return r.toString()!==i?.toString()&&!this.currentNavigation?.extras.skipLocationChange}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=X({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function iC(n){return n!==Oo}var sC=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=X({token:e,factory:()=>j(oC),providedIn:"root"});let n=e;return n})(),ef=class{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}},oC=(()=>{let e=class e extends ef{};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=$h(e)))(s||e)}})(),e.\u0275prov=X({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),Zw=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=X({token:e,factory:()=>j(aC),providedIn:"root"});let n=e;return n})(),aC=(()=>{let e=class e extends Zw{constructor(){super(...arguments),this.location=j(Li),this.urlSerializer=j(qo),this.options=j(Ko,{optional:!0})||{},this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.urlHandlingStrategy=j(of),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.currentUrlTree=new Tn,this.rawUrlTree=this.currentUrlTree,this.currentPageId=0,this.lastSuccessfulId=-1,this.routerState=Uw(null),this.stateMemento=this.createStateMemento()}getCurrentUrlTree(){return this.currentUrlTree}getRawUrlTree(){return this.rawUrlTree}restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}getRouterState(){return this.routerState}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}registerNonRouterCurrentEntryChangeListener(r){return this.location.subscribe(i=>{i.type==="popstate"&&r(i.url,i.state)})}handleRouterEvent(r,i){if(r instanceof Gi)this.stateMemento=this.createStateMemento();else if(r instanceof ir)this.rawUrlTree=i.initialUrl;else if(r instanceof Xu){if(this.urlUpdateStrategy==="eager"&&!i.extras.skipLocationChange){let s=this.urlHandlingStrategy.merge(i.finalUrl,i.initialUrl);this.setBrowserUrl(i.targetBrowserUrl??s,i)}}else r instanceof Lo?(this.currentUrlTree=i.finalUrl,this.rawUrlTree=this.urlHandlingStrategy.merge(i.finalUrl,i.initialUrl),this.routerState=i.targetRouterState,this.urlUpdateStrategy==="deferred"&&!i.extras.skipLocationChange&&this.setBrowserUrl(i.targetBrowserUrl??this.rawUrlTree,i)):r instanceof In&&(r.code===Tt.GuardRejected||r.code===Tt.NoDataFromResolver)?this.restoreHistory(i):r instanceof Fo?this.restoreHistory(i,!0):r instanceof Bt&&(this.lastSuccessfulId=r.id,this.currentPageId=this.browserPageId)}setBrowserUrl(r,i){let s=r instanceof Tn?this.urlSerializer.serialize(r):r;if(this.location.isCurrentPathEqualTo(s)||i.extras.replaceUrl){let o=this.browserPageId,a=q(q({},i.extras.state),this.generateNgRouterState(i.id,o));this.location.replaceState(s,"",a)}else{let o=q(q({},i.extras.state),this.generateNgRouterState(i.id,this.browserPageId+1));this.location.go(s,"",o)}}restoreHistory(r,i=!1){if(this.canceledNavigationResolution==="computed"){let s=this.browserPageId,o=this.currentPageId-s;o!==0?this.location.historyGo(o):this.currentUrlTree===r.finalUrl&&o===0&&(this.resetState(r),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(i&&this.resetState(r),this.resetUrlToCurrentUrlTree())}resetState(r){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,r.finalUrl??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(r,i){return this.canceledNavigationResolution==="computed"?{navigationId:r,\u0275routerPageId:i}:{navigationId:r}}};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=$h(e)))(s||e)}})(),e.\u0275prov=X({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),No=function(n){return n[n.COMPLETE=0]="COMPLETE",n[n.FAILED=1]="FAILED",n[n.REDIRECTING=2]="REDIRECTING",n}(No||{});function eE(n,e){n.events.pipe(mn(t=>t instanceof Bt||t instanceof In||t instanceof Fo||t instanceof ir),le(t=>t instanceof Bt||t instanceof ir?No.COMPLETE:(t instanceof In?t.code===Tt.Redirect||t.code===Tt.SupersededByNewNavigation:!1)?No.REDIRECTING:No.FAILED),mn(t=>t!==No.REDIRECTING),Si(1)).subscribe(()=>{e()})}function uC(n){throw n}var cC={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},lC={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},Yt=(()=>{let e=class e{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}constructor(){this.disposed=!1,this.console=j(Tu),this.stateManager=j(Zw),this.options=j(Ko,{optional:!0})||{},this.pendingTasks=j(go),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.navigationTransitions=j(af),this.urlSerializer=j(qo),this.location=j(Li),this.urlHandlingStrategy=j(of),this._events=new Hn,this.errorHandler=this.options.errorHandler||uC,this.navigated=!1,this.routeReuseStrategy=j(sC),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.config=j(jo,{optional:!0})?.flat()??[],this.componentInputBindingEnabled=!!j(ac,{optional:!0}),this.eventsSubscription=new C_,this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe({error:r=>{this.console.warn(r)}}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){let r=this.navigationTransitions.events.subscribe(i=>{try{let s=this.navigationTransitions.currentTransition,o=this.navigationTransitions.currentNavigation;if(s!==null&&o!==null){if(this.stateManager.handleRouterEvent(i,o),i instanceof In&&i.code!==Tt.Redirect&&i.code!==Tt.SupersededByNewNavigation)this.navigated=!0;else if(i instanceof Bt)this.navigated=!0;else if(i instanceof Wi){let a=i.navigationBehaviorOptions,c=this.urlHandlingStrategy.merge(i.url,s.currentRawUrl),l=q({browserUrl:s.extras.browserUrl,info:s.extras.info,skipLocationChange:s.extras.skipLocationChange,replaceUrl:s.extras.replaceUrl||this.urlUpdateStrategy==="eager"||iC(s.source)},a);this.scheduleNavigation(c,Oo,null,l,{resolve:s.resolve,reject:s.reject,promise:s.promise})}}dC(i)&&this._events.next(i)}catch(s){this.navigationTransitions.transitionAbortSubject.next(s)}});this.eventsSubscription.add(r)}resetRootComponentType(r){this.routerState.root.component=r,this.navigationTransitions.rootComponentType=r}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),Oo,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((r,i)=>{setTimeout(()=>{this.navigateToSyncWithBrowser(r,"popstate",i)},0)})}navigateToSyncWithBrowser(r,i,s){let o={replaceUrl:!0},a=s?.navigationId?s:null;if(s){let l=q({},s);delete l.navigationId,delete l.\u0275routerPageId,Object.keys(l).length!==0&&(o.state=l)}let c=this.parseUrl(r);this.scheduleNavigation(c,i,a,o)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(r){this.config=r.map(rf),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(r,i={}){let{relativeTo:s,queryParams:o,fragment:a,queryParamsHandling:c,preserveFragment:l}=i,d=l?this.currentUrlTree.fragment:a,p=null;switch(c??this.options.defaultQueryParamsHandling){case"merge":p=q(q({},this.currentUrlTree.queryParams),o);break;case"preserve":p=this.currentUrlTree.queryParams;break;default:p=o||null}p!==null&&(p=this.removeEmptyProps(p));let m;try{let w=s?s.snapshot:this.routerState.snapshot.root;m=xw(w)}catch{(typeof r[0]!="string"||r[0][0]!=="/")&&(r=[]),m=this.currentUrlTree.root}return Fw(m,r,p,d??null)}navigateByUrl(r,i={skipLocationChange:!1}){let s=Wr(r)?r:this.parseUrl(r),o=this.urlHandlingStrategy.merge(s,this.rawUrlTree);return this.scheduleNavigation(o,Oo,null,i)}navigate(r,i={skipLocationChange:!1}){return hC(r),this.navigateByUrl(this.createUrlTree(r,i),i)}serializeUrl(r){return this.urlSerializer.serialize(r)}parseUrl(r){try{return this.urlSerializer.parse(r)}catch{return this.urlSerializer.parse("/")}}isActive(r,i){let s;if(i===!0?s=q({},cC):i===!1?s=q({},lC):s=i,Wr(r))return pw(this.currentUrlTree,r,s);let o=this.parseUrl(r);return pw(this.currentUrlTree,o,s)}removeEmptyProps(r){return Object.entries(r).reduce((i,[s,o])=>(o!=null&&(i[s]=o),i),{})}scheduleNavigation(r,i,s,o,a){if(this.disposed)return Promise.resolve(!1);let c,l,d;a?(c=a.resolve,l=a.reject,d=a.promise):d=new Promise((m,w)=>{c=m,l=w});let p=this.pendingTasks.add();return eE(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(p))}),this.navigationTransitions.handleNavigationRequest({source:i,restoredState:s,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:r,extras:o,resolve:c,reject:l,promise:d,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),d.catch(m=>Promise.reject(m))}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=X({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function hC(n){for(let e=0;e<n.length;e++)if(n[e]==null)throw new we(4008,!1)}function dC(n){return!(n instanceof Lo)&&!(n instanceof Wi)}var Iw=(()=>{let e=class e{constructor(r,i,s,o,a,c){this.router=r,this.route=i,this.tabIndexAttribute=s,this.renderer=o,this.el=a,this.locationStrategy=c,this.href=null,this.onChanges=new Hn,this.preserveFragment=!1,this.skipLocationChange=!1,this.replaceUrl=!1,this.routerLinkInput=null;let l=a.nativeElement.tagName?.toLowerCase();this.isAnchorElement=l==="a"||l==="area",this.isAnchorElement?this.subscription=r.events.subscribe(d=>{d instanceof Bt&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}setTabIndexIfNotOnNativeEl(r){this.tabIndexAttribute!=null||this.isAnchorElement||this.applyAttributeValue("tabindex",r)}ngOnChanges(r){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}set routerLink(r){r==null?(this.routerLinkInput=null,this.setTabIndexIfNotOnNativeEl(null)):(Wr(r)?this.routerLinkInput=r:this.routerLinkInput=Array.isArray(r)?r:[r],this.setTabIndexIfNotOnNativeEl("0"))}onClick(r,i,s,o,a){let c=this.urlTree;if(c===null||this.isAnchorElement&&(r!==0||i||s||o||a||typeof this.target=="string"&&this.target!="_self"))return!0;let l={skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state,info:this.info};return this.router.navigateByUrl(c,l),!this.isAnchorElement}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){let r=this.urlTree;this.href=r!==null&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(r)):null;let i=this.href===null?null:nv(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",i)}applyAttributeValue(r,i){let s=this.renderer,o=this.el.nativeElement;i!==null?s.setAttribute(o,r,i):s.removeAttribute(o,r)}get urlTree(){return this.routerLinkInput===null?null:Wr(this.routerLinkInput)?this.routerLinkInput:this.router.createUrlTree(this.routerLinkInput,{relativeTo:this.relativeTo!==void 0?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}};e.\u0275fac=function(i){return new(i||e)(De(Yt),De(sr),jh("tabindex"),De(ki),De(Ci),De(En))},e.\u0275dir=yn({type:e,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function(i,s){i&1&&cv("click",function(a){return s.onClick(a.button,a.ctrlKey,a.shiftKey,a.altKey,a.metaKey)}),i&2&&av("target",s.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",info:"info",relativeTo:"relativeTo",preserveFragment:[2,"preserveFragment","preserveFragment",vo],skipLocationChange:[2,"skipLocationChange","skipLocationChange",vo],replaceUrl:[2,"replaceUrl","replaceUrl",vo],routerLink:"routerLink"},standalone:!0,features:[Qh,Ri]});let n=e;return n})(),zL=(()=>{let e=class e{get isActive(){return this._isActive}constructor(r,i,s,o,a){this.router=r,this.element=i,this.renderer=s,this.cdr=o,this.link=a,this.classes=[],this._isActive=!1,this.routerLinkActiveOptions={exact:!1},this.isActiveChange=new Zn,this.routerEventsSubscription=r.events.subscribe(c=>{c instanceof Bt&&this.update()})}ngAfterContentInit(){K(this.links.changes,K(null)).pipe(fo()).subscribe(r=>{this.update(),this.subscribeToEachLinkOnChanges()})}subscribeToEachLinkOnChanges(){this.linkInputChangesSubscription?.unsubscribe();let r=[...this.links.toArray(),this.link].filter(i=>!!i).map(i=>i.onChanges);this.linkInputChangesSubscription=ot(r).pipe(fo()).subscribe(i=>{this._isActive!==this.isLinkActive(this.router)(i)&&this.update()})}set routerLinkActive(r){let i=Array.isArray(r)?r:r.split(" ");this.classes=i.filter(s=>!!s)}ngOnChanges(r){this.update()}ngOnDestroy(){this.routerEventsSubscription.unsubscribe(),this.linkInputChangesSubscription?.unsubscribe()}update(){!this.links||!this.router.navigated||queueMicrotask(()=>{let r=this.hasActiveLinks();this.classes.forEach(i=>{r?this.renderer.addClass(this.element.nativeElement,i):this.renderer.removeClass(this.element.nativeElement,i)}),r&&this.ariaCurrentWhenActive!==void 0?this.renderer.setAttribute(this.element.nativeElement,"aria-current",this.ariaCurrentWhenActive.toString()):this.renderer.removeAttribute(this.element.nativeElement,"aria-current"),this._isActive!==r&&(this._isActive=r,this.cdr.markForCheck(),this.isActiveChange.emit(r))})}isLinkActive(r){let i=fC(this.routerLinkActiveOptions)?this.routerLinkActiveOptions:this.routerLinkActiveOptions.exact||!1;return s=>{let o=s.urlTree;return o?r.isActive(o,i):!1}}hasActiveLinks(){let r=this.isLinkActive(this.router);return this.link&&r(this.link)||this.links.some(r)}};e.\u0275fac=function(i){return new(i||e)(De(Yt),De(Ci),De(ki),De(Mi),De(Iw,8))},e.\u0275dir=yn({type:e,selectors:[["","routerLinkActive",""]],contentQueries:function(i,s,o){if(i&1&&lv(o,Iw,5),i&2){let a;hv(a=dv())&&(s.links=a)}},inputs:{routerLinkActiveOptions:"routerLinkActiveOptions",ariaCurrentWhenActive:"ariaCurrentWhenActive",routerLinkActive:"routerLinkActive"},outputs:{isActiveChange:"isActiveChange"},exportAs:["routerLinkActive"],standalone:!0,features:[Ri]});let n=e;return n})();function fC(n){return!!n.paths}var oc=class{};var pC=(()=>{let e=class e{constructor(r,i,s,o,a){this.router=r,this.injector=s,this.preloadingStrategy=o,this.loader=a}setUpPreloading(){this.subscription=this.router.events.pipe(mn(r=>r instanceof Bt),Qn(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(r,i){let s=[];for(let o of i){o.providers&&!o._injector&&(o._injector=Yh(o.providers,r,`Route: ${o.path}`));let a=o._injector??r,c=o._loadedInjector??a;(o.loadChildren&&!o._loadedRoutes&&o.canLoad===void 0||o.loadComponent&&!o._loadedComponent)&&s.push(this.preloadConfig(a,o)),(o.children||o._loadedRoutes)&&s.push(this.processRoutes(c,o.children??o._loadedRoutes))}return ot(s).pipe(fo())}preloadConfig(r,i){return this.preloadingStrategy.preload(i,()=>{let s;i.loadChildren&&i.canLoad===void 0?s=this.loader.loadChildren(r,i):s=K(null);let o=s.pipe(vt(a=>a===null?K(void 0):(i._loadedRoutes=a.routes,i._loadedInjector=a.injector,this.processRoutes(a.injector??r,a.routes))));if(i.loadComponent&&!i._loadedComponent){let a=this.loader.loadComponent(i);return ot([o,a]).pipe(fo())}else return o})}};e.\u0275fac=function(i){return new(i||e)(Y(Yt),Y(Au),Y(Br),Y(oc),Y(sf))},e.\u0275prov=X({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),tE=new te(""),gC=(()=>{let e=class e{constructor(r,i,s,o,a={}){this.urlSerializer=r,this.transitions=i,this.viewportScroller=s,this.zone=o,this.options=a,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},a.scrollPositionRestoration||="disabled",a.anchorScrolling||="disabled"}init(){this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(r=>{r instanceof Gi?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=r.navigationTrigger,this.restoredId=r.restoredState?r.restoredState.navigationId:0):r instanceof Bt?(this.lastId=r.id,this.scheduleScrollEvent(r,this.urlSerializer.parse(r.urlAfterRedirects).fragment)):r instanceof ir&&r.code===Ju.IgnoredSameUrlNavigation&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(r,this.urlSerializer.parse(r.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(r=>{r instanceof Zu&&(r.position?this.options.scrollPositionRestoration==="top"?this.viewportScroller.scrollToPosition([0,0]):this.options.scrollPositionRestoration==="enabled"&&this.viewportScroller.scrollToPosition(r.position):r.anchor&&this.options.anchorScrolling==="enabled"?this.viewportScroller.scrollToAnchor(r.anchor):this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(r,i){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new Zu(r,this.lastSource==="popstate"?this.store[this.restoredId]:null,i))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}};e.\u0275fac=function(i){rv()},e.\u0275prov=X({token:e,factory:e.\u0275fac});let n=e;return n})();function qL(n,...e){return gt([{provide:jo,multi:!0,useValue:n},[],{provide:sr,useFactory:nE,deps:[Yt]},{provide:yo,multi:!0,useFactory:rE},e.map(t=>t.\u0275providers)])}function nE(n){return n.routerState.root}function Qo(n,e){return{\u0275kind:n,\u0275providers:e}}function rE(){let n=j(Rt);return e=>{let t=n.get(_o);if(e!==t.components[0])return;let r=n.get(Yt),i=n.get(iE);n.get(uf)===1&&r.initialNavigation(),n.get(sE,null,Bh.Optional)?.setUpPreloading(),n.get(tE,null,Bh.Optional)?.init(),r.resetRootComponentType(t.componentTypes[0]),i.closed||(i.next(),i.complete(),i.unsubscribe())}}var iE=new te("",{factory:()=>new Hn}),uf=new te("",{providedIn:"root",factory:()=>1});function mC(){return Qo(2,[{provide:uf,useValue:0},{provide:Xh,multi:!0,deps:[Rt],useFactory:e=>{let t=e.get(Pv,Promise.resolve());return()=>t.then(()=>new Promise(r=>{let i=e.get(Yt),s=e.get(iE);eE(i,()=>{r(!0)}),e.get(af).afterPreactivation=()=>(r(!0),s.closed?K(void 0):s),i.initialNavigation()}))}}])}function yC(){return Qo(3,[{provide:Xh,multi:!0,useFactory:()=>{let e=j(Yt);return()=>{e.setUpLocationChangeListener()}}},{provide:uf,useValue:2}])}var sE=new te("");function _C(n){return Qo(0,[{provide:sE,useExisting:pC},{provide:oc,useExisting:n}])}function vC(){return Qo(8,[_w,{provide:ac,useExisting:_w}])}function wC(n){let e=[{provide:Jw,useValue:tC},{provide:Xw,useValue:q({skipNextTransition:!!n?.skipInitialTransition},n)}];return Qo(9,e)}var Tw=new te("ROUTER_FORROOT_GUARD"),EC=[Li,{provide:qo,useClass:qi},Yt,Wo,{provide:sr,useFactory:nE,deps:[Yt]},sf,[]],GL=(()=>{let e=class e{constructor(r){}static forRoot(r,i){return{ngModule:e,providers:[EC,[],{provide:jo,multi:!0,useValue:r},{provide:Tw,useFactory:bC,deps:[[Yt,new Ue,new z_]]},{provide:Ko,useValue:i||{}},i?.useHash?TC():AC(),IC(),i?.preloadingStrategy?_C(i.preloadingStrategy).\u0275providers:[],i?.initialNavigation?DC(i):[],i?.bindToComponentInputs?vC().\u0275providers:[],i?.enableViewTransitions?wC().\u0275providers:[],SC()]}}static forChild(r){return{ngModule:e,providers:[{provide:jo,multi:!0,useValue:r}]}}};e.\u0275fac=function(i){return new(i||e)(Y(Tw,8))},e.\u0275mod=Xn({type:e}),e.\u0275inj=Jn({});let n=e;return n})();function IC(){return{provide:tE,useFactory:()=>{let n=j(Fv),e=j(Pe),t=j(Ko),r=j(af),i=j(qo);return t.scrollOffset&&n.setOffset(t.scrollOffset),new gC(i,r,n,e,t)}}}function TC(){return{provide:En,useClass:kv}}function AC(){return{provide:En,useClass:ld}}function bC(n){return"guarded"}function DC(n){return[n.initialNavigation==="disabled"?yC().\u0275providers:[],n.initialNavigation==="enabledBlocking"?mC().\u0275providers:[]]}var Aw=new te("");function SC(){return[{provide:Aw,useFactory:rE},{provide:yo,multi:!0,useExisting:Aw}]}var UP={};Kb(UP,{FirebaseError:()=>at,SDK_VERSION:()=>jt,_DEFAULT_ENTRY_NAME:()=>Zo,_addComponent:()=>Rf,_addOrOverwriteComponent:()=>CP,_apps:()=>ur,_clearComponents:()=>PP,_components:()=>Xi,_getProvider:()=>Sn,_isFirebaseApp:()=>NE,_isFirebaseServerApp:()=>Mt,_registerComponent:()=>$t,_removeServiceInstance:()=>PE,_serverApps:()=>Ji,deleteApp:()=>kf,getApp:()=>Rn,getApps:()=>ta,initializeApp:()=>yc,initializeServerApp:()=>kE,onLog:()=>OE,registerVersion:()=>_e,setLogLevel:()=>ME});var aE=function(n){let e=[],t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},RC=function(n){let e=[],t=0,r=0;for(;t<n.length;){let i=n[t++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){let s=n[t++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){let s=n[t++],o=n[t++],a=n[t++],c=((i&7)<<18|(s&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(c>>10)),e[r++]=String.fromCharCode(56320+(c&1023))}else{let s=n[t++],o=n[t++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|o&63)}}return e.join("")},uE={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();let t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<n.length;i+=3){let s=n[i],o=i+1<n.length,a=o?n[i+1]:0,c=i+2<n.length,l=c?n[i+2]:0,d=s>>2,p=(s&3)<<4|a>>4,m=(a&15)<<2|l>>6,w=l&63;c||(w=64,o||(m=64)),r.push(t[d],t[p],t[m],t[w])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(aE(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):RC(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();let t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<n.length;){let s=t[n.charAt(i++)],a=i<n.length?t[n.charAt(i)]:0;++i;let l=i<n.length?t[n.charAt(i)]:64;++i;let p=i<n.length?t[n.charAt(i)]:64;if(++i,s==null||a==null||l==null||p==null)throw new lf;let m=s<<2|a>>4;if(r.push(m),l!==64){let w=a<<4&240|l>>2;if(r.push(w),p!==64){let D=l<<6&192|p;r.push(D)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}},lf=class extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}},CC=function(n){let e=aE(n);return uE.encodeByteArray(e,!0)},Yo=function(n){return CC(n).replace(/\./g,"")},df=function(n){try{return uE.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function PC(n,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:let t=e;return new Date(t.getTime());case Object:n===void 0&&(n={});break;case Array:n=[];break;default:return e}for(let t in e)!e.hasOwnProperty(t)||!NC(t)||(n[t]=PC(n[t],e[t]));return n}function NC(n){return n!=="__proto__"}function kC(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}var OC=()=>kC().__FIREBASE_DEFAULTS__,MC=()=>{if(typeof process>"u"||typeof process.env>"u")return;let n=process.env.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},xC=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}let e=n&&df(n[1]);return e&&JSON.parse(e)},lc=()=>{try{return OC()||MC()||xC()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},ff=n=>{var e,t;return(t=(e=lc())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},hc=n=>{let e=ff(n);if(!e)return;let t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);let r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},pf=()=>{var n;return(n=lc())===null||n===void 0?void 0:n.config},gf=n=>{var e;return(e=lc())===null||e===void 0?void 0:e[`_${n}`]};var cc=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}};function dc(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');let t={alg:"none",type:"JWT"},r=e||"demo-project",i=n.iat||0,s=n.sub||n.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");let o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},n);return[Yo(JSON.stringify(t)),Yo(JSON.stringify(o)),""].join(".")}function Ne(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function cE(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Ne())}function FC(){var n;let e=(n=lc())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function lE(){return typeof window<"u"||mf()}function mf(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function hE(){let n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function dE(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function fE(){let n=Ne();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function yf(){return!FC()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function fc(){try{return typeof indexedDB=="object"}catch{return!1}}function pE(){return new Promise((n,e)=>{try{let t=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(t){e(t)}})}var LC="FirebaseError",at=class n extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=LC,Object.setPrototypeOf(this,n.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,An.prototype.create)}},An=class{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){let r=t[0]||{},i=`${this.service}/${e}`,s=this.errors[e],o=s?VC(s,r):"Error",a=`${this.serviceName}: ${o} (${i}).`;return new at(i,a,r)}};function VC(n,e){return n.replace(UC,(t,r)=>{let i=e[r];return i!=null?String(i):`<${r}?>`})}var UC=/\{\$([^}]+)}/g;function KL(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function gE(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function bn(n,e){if(n===e)return!0;let t=Object.keys(n),r=Object.keys(e);for(let i of t){if(!r.includes(i))return!1;let s=n[i],o=e[i];if(oE(s)&&oE(o)){if(!bn(s,o))return!1}else if(s!==o)return!1}for(let i of r)if(!t.includes(i))return!1;return!0}function oE(n){return n!==null&&typeof n=="object"}function Jo(n){let e=[];for(let[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function Qi(n){let e={};return n.replace(/^\?/,"").split("&").forEach(r=>{if(r){let[i,s]=r.split("=");e[decodeURIComponent(i)]=decodeURIComponent(s)}}),e}function Yi(n){let e=n.indexOf("?");if(!e)return"";let t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function mE(n,e){let t=new hf(n,e);return t.subscribe.bind(t)}var hf=class{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let i;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");BC(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:r},i.next===void 0&&(i.next=cf),i.error===void 0&&(i.error=cf),i.complete===void 0&&(i.complete=cf);let s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}};function BC(n,e){if(typeof n!="object"||n===null)return!1;for(let t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function cf(){}var QL=4*60*60*1e3;function ie(n){return n&&n._delegate?n._delegate:n}var mt=class{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};var Hr="[DEFAULT]";var _f=class{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){let t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){let r=new cc;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{let i=this.getOrInitializeService({instanceIdentifier:t});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;let r=this.normalizeInstanceIdentifier(e?.identifier),i=(t=e?.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(jC(e))try{this.getOrInitializeService({instanceIdentifier:Hr})}catch{}for(let[t,r]of this.instancesDeferred.entries()){let i=this.normalizeInstanceIdentifier(t);try{let s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=Hr){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}delete(){return y(this,null,function*(){let e=Array.from(this.instances.values());yield Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])})}isComponentSet(){return this.component!=null}isInitialized(e=Hr){return this.instances.has(e)}getOptions(e=Hr){return this.instancesOptions.get(e)||{}}initialize(e={}){let{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let i=this.getOrInitializeService({instanceIdentifier:r,options:t});for(let[s,o]of this.instancesDeferred.entries()){let a=this.normalizeInstanceIdentifier(s);r===a&&o.resolve(i)}return i}onInit(e,t){var r;let i=this.normalizeInstanceIdentifier(t),s=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;s.add(e),this.onInitCallbacks.set(i,s);let o=this.instances.get(i);return o&&e(o,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){let r=this.onInitCallbacks.get(t);if(r)for(let i of r)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:$C(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Hr){return this.component?this.component.multipleInstances?e:Hr:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function $C(n){return n===Hr?void 0:n}function jC(n){return n.instantiationMode==="EAGER"}var Xo=class{constructor(e){this.name=e,this.providers=new Map}addComponent(e){let t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);let t=new _f(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}};var vf=[],re=function(n){return n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT",n}(re||{}),yE={debug:re.DEBUG,verbose:re.VERBOSE,info:re.INFO,warn:re.WARN,error:re.ERROR,silent:re.SILENT},zC=re.INFO,qC={[re.DEBUG]:"log",[re.VERBOSE]:"log",[re.INFO]:"info",[re.WARN]:"warn",[re.ERROR]:"error"},GC=(n,e,...t)=>{if(e<n.logLevel)return;let r=new Date().toISOString(),i=qC[e];if(i)console[i](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)},ar=class{constructor(e){this.name=e,this._logLevel=zC,this._logHandler=GC,this._userLogHandler=null,vf.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in re))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?yE[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,re.DEBUG,...e),this._logHandler(this,re.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,re.VERBOSE,...e),this._logHandler(this,re.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,re.INFO,...e),this._logHandler(this,re.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,re.WARN,...e),this._logHandler(this,re.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,re.ERROR,...e),this._logHandler(this,re.ERROR,...e)}};function _E(n){vf.forEach(e=>{e.setLogLevel(n)})}function vE(n,e){for(let t of vf){let r=null;e&&e.level&&(r=yE[e.level]),n===null?t.userLogHandler=null:t.userLogHandler=(i,s,...o)=>{let a=o.map(c=>{if(c==null)return null;if(typeof c=="string")return c;if(typeof c=="number"||typeof c=="boolean")return c.toString();if(c instanceof Error)return c.message;try{return JSON.stringify(c)}catch{return null}}).filter(c=>c).join(" ");s>=(r??i.logLevel)&&n({level:re[s].toLowerCase(),message:a,args:o,type:i.name})}}}var WC=(n,e)=>e.some(t=>n instanceof t),wE,EE;function HC(){return wE||(wE=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function KC(){return EE||(EE=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}var IE=new WeakMap,Ef=new WeakMap,TE=new WeakMap,wf=new WeakMap,Tf=new WeakMap;function QC(n){let e=new Promise((t,r)=>{let i=()=>{n.removeEventListener("success",s),n.removeEventListener("error",o)},s=()=>{t(Jt(n.result)),i()},o=()=>{r(n.error),i()};n.addEventListener("success",s),n.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&IE.set(t,n)}).catch(()=>{}),Tf.set(e,n),e}function YC(n){if(Ef.has(n))return;let e=new Promise((t,r)=>{let i=()=>{n.removeEventListener("complete",s),n.removeEventListener("error",o),n.removeEventListener("abort",o)},s=()=>{t(),i()},o=()=>{r(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",s),n.addEventListener("error",o),n.addEventListener("abort",o)});Ef.set(n,e)}var If={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return Ef.get(n);if(e==="objectStoreNames")return n.objectStoreNames||TE.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Jt(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function AE(n){If=n(If)}function JC(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){let r=n.call(pc(this),e,...t);return TE.set(r,e.sort?e.sort():[e]),Jt(r)}:KC().includes(n)?function(...e){return n.apply(pc(this),e),Jt(IE.get(this))}:function(...e){return Jt(n.apply(pc(this),e))}}function XC(n){return typeof n=="function"?JC(n):(n instanceof IDBTransaction&&YC(n),WC(n,HC())?new Proxy(n,If):n)}function Jt(n){if(n instanceof IDBRequest)return QC(n);if(wf.has(n))return wf.get(n);let e=XC(n);return e!==n&&(wf.set(n,e),Tf.set(e,n)),e}var pc=n=>Tf.get(n);function DE(n,e,{blocked:t,upgrade:r,blocking:i,terminated:s}={}){let o=indexedDB.open(n,e),a=Jt(o);return r&&o.addEventListener("upgradeneeded",c=>{r(Jt(o.result),c.oldVersion,c.newVersion,Jt(o.transaction),c)}),t&&o.addEventListener("blocked",c=>t(c.oldVersion,c.newVersion,c)),a.then(c=>{s&&c.addEventListener("close",()=>s()),i&&c.addEventListener("versionchange",l=>i(l.oldVersion,l.newVersion,l))}).catch(()=>{}),a}var ZC=["get","getKey","getAll","getAllKeys","count"],eP=["put","add","delete","clear"],Af=new Map;function bE(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Af.get(e))return Af.get(e);let t=e.replace(/FromIndex$/,""),r=e!==t,i=eP.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(i||ZC.includes(t)))return;let s=function(o,...a){return y(this,null,function*(){let c=this.transaction(o,i?"readwrite":"readonly"),l=c.store;return r&&(l=l.index(a.shift())),(yield Promise.all([l[t](...a),i&&c.done]))[0]})};return Af.set(e,s),s}AE(n=>Qe(q({},n),{get:(e,t,r)=>bE(e,t)||n.get(e,t,r),has:(e,t)=>!!bE(e,t)||n.has(e,t)}));var Df=class{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(tP(t)){let r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}};function tP(n){let e=n.getComponent();return e?.type==="VERSION"}var gc="@firebase/app",Sf="0.10.9";var Dn=new ar("@firebase/app"),nP="@firebase/app-compat",rP="@firebase/analytics-compat",iP="@firebase/analytics",sP="@firebase/app-check-compat",oP="@firebase/app-check",aP="@firebase/auth",uP="@firebase/auth-compat",cP="@firebase/database",lP="@firebase/database-compat",hP="@firebase/functions",dP="@firebase/functions-compat",fP="@firebase/installations",pP="@firebase/installations-compat",gP="@firebase/messaging",mP="@firebase/messaging-compat",yP="@firebase/performance",_P="@firebase/performance-compat",vP="@firebase/remote-config",wP="@firebase/remote-config-compat",EP="@firebase/storage",IP="@firebase/storage-compat",TP="@firebase/firestore",AP="@firebase/vertexai-preview",bP="@firebase/firestore-compat",DP="firebase",SP="10.13.0";var Zo="[DEFAULT]",RP={[gc]:"fire-core",[nP]:"fire-core-compat",[iP]:"fire-analytics",[rP]:"fire-analytics-compat",[oP]:"fire-app-check",[sP]:"fire-app-check-compat",[aP]:"fire-auth",[uP]:"fire-auth-compat",[cP]:"fire-rtdb",[lP]:"fire-rtdb-compat",[hP]:"fire-fn",[dP]:"fire-fn-compat",[fP]:"fire-iid",[pP]:"fire-iid-compat",[gP]:"fire-fcm",[mP]:"fire-fcm-compat",[yP]:"fire-perf",[_P]:"fire-perf-compat",[vP]:"fire-rc",[wP]:"fire-rc-compat",[EP]:"fire-gcs",[IP]:"fire-gcs-compat",[TP]:"fire-fst",[bP]:"fire-fst-compat",[AP]:"fire-vertex","fire-js":"fire-js",[DP]:"fire-js-all"};var ur=new Map,Ji=new Map,Xi=new Map;function Rf(n,e){try{n.container.addComponent(e)}catch(t){Dn.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function CP(n,e){n.container.addOrOverwriteComponent(e)}function $t(n){let e=n.name;if(Xi.has(e))return Dn.debug(`There were multiple attempts to register component ${e}.`),!1;Xi.set(e,n);for(let t of ur.values())Rf(t,n);for(let t of Ji.values())Rf(t,n);return!0}function Sn(n,e){let t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function PE(n,e,t=Zo){Sn(n,e).clearInstance(t)}function NE(n){return n.options!==void 0}function Mt(n){return n.settings!==void 0}function PP(){Xi.clear()}var NP={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Ot=new An("app","Firebase",NP);var mc=class{constructor(e,t,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new mt("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Ot.create("app-deleted",{appName:this._name})}};var Cf=class extends mc{constructor(e,t,r,i){let s=t.automaticDataCollectionEnabled!==void 0?t.automaticDataCollectionEnabled:!1,o={name:r,automaticDataCollectionEnabled:s};if(e.apiKey!==void 0)super(e,o,i);else{let a=e;super(a.options,o,i)}this._serverConfig=Object.assign({automaticDataCollectionEnabled:s},t),this._finalizationRegistry=null,typeof FinalizationRegistry<"u"&&(this._finalizationRegistry=new FinalizationRegistry(()=>{this.automaticCleanup()})),this._refCount=0,this.incRefCount(this._serverConfig.releaseOnDeref),this._serverConfig.releaseOnDeref=void 0,t.releaseOnDeref=void 0,_e(gc,Sf,"serverapp")}toJSON(){}get refCount(){return this._refCount}incRefCount(e){this.isDeleted||(this._refCount++,e!==void 0&&this._finalizationRegistry!==null&&this._finalizationRegistry.register(e,this))}decRefCount(){return this.isDeleted?0:--this._refCount}automaticCleanup(){kf(this)}get settings(){return this.checkDestroyed(),this._serverConfig}checkDestroyed(){if(this.isDeleted)throw Ot.create("server-app-deleted")}};var jt=SP;function yc(n,e={}){let t=n;typeof e!="object"&&(e={name:e});let r=Object.assign({name:Zo,automaticDataCollectionEnabled:!1},e),i=r.name;if(typeof i!="string"||!i)throw Ot.create("bad-app-name",{appName:String(i)});if(t||(t=pf()),!t)throw Ot.create("no-options");let s=ur.get(i);if(s){if(bn(t,s.options)&&bn(r,s.config))return s;throw Ot.create("duplicate-app",{appName:i})}let o=new Xo(i);for(let c of Xi.values())o.addComponent(c);let a=new mc(t,r,o);return ur.set(i,a),a}function kE(n,e){if(lE()&&!mf())throw Ot.create("invalid-server-app-environment");e.automaticDataCollectionEnabled===void 0&&(e.automaticDataCollectionEnabled=!1);let t;NE(n)?t=n.options:t=n;let r=Object.assign(Object.assign({},e),t);r.releaseOnDeref!==void 0&&delete r.releaseOnDeref;let i=l=>[...l].reduce((d,p)=>Math.imul(31,d)+p.charCodeAt(0)|0,0);if(e.releaseOnDeref!==void 0&&typeof FinalizationRegistry>"u")throw Ot.create("finalization-registry-not-supported",{});let s=""+i(JSON.stringify(r)),o=Ji.get(s);if(o)return o.incRefCount(e.releaseOnDeref),o;let a=new Xo(s);for(let l of Xi.values())a.addComponent(l);let c=new Cf(t,e,s,a);return Ji.set(s,c),c}function Rn(n=Zo){let e=ur.get(n);if(!e&&n===Zo&&pf())return yc();if(!e)throw Ot.create("no-app",{appName:n});return e}function ta(){return Array.from(ur.values())}function kf(n){return y(this,null,function*(){let e=!1,t=n.name;ur.has(t)?(e=!0,ur.delete(t)):Ji.has(t)&&n.decRefCount()<=0&&(Ji.delete(t),e=!0),e&&(yield Promise.all(n.container.getProviders().map(r=>r.delete())),n.isDeleted=!0)})}function _e(n,e,t){var r;let i=(r=RP[n])!==null&&r!==void 0?r:n;t&&(i+=`-${t}`);let s=i.match(/\s|\//),o=e.match(/\s|\//);if(s||o){let a=[`Unable to register library "${i}" with version "${e}":`];s&&a.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Dn.warn(a.join(" "));return}$t(new mt(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}function OE(n,e){if(n!==null&&typeof n!="function")throw Ot.create("invalid-log-argument");vE(n,e)}function ME(n){_E(n)}var kP="firebase-heartbeat-database",OP=1,ea="firebase-heartbeat-store",bf=null;function xE(){return bf||(bf=DE(kP,OP,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(ea)}catch(t){console.warn(t)}}}}).catch(n=>{throw Ot.create("idb-open",{originalErrorMessage:n.message})})),bf}function MP(n){return y(this,null,function*(){try{let t=(yield xE()).transaction(ea),r=yield t.objectStore(ea).get(FE(n));return yield t.done,r}catch(e){if(e instanceof at)Dn.warn(e.message);else{let t=Ot.create("idb-get",{originalErrorMessage:e?.message});Dn.warn(t.message)}}})}function SE(n,e){return y(this,null,function*(){try{let r=(yield xE()).transaction(ea,"readwrite");yield r.objectStore(ea).put(e,FE(n)),yield r.done}catch(t){if(t instanceof at)Dn.warn(t.message);else{let r=Ot.create("idb-set",{originalErrorMessage:t?.message});Dn.warn(r.message)}}})}function FE(n){return`${n.name}!${n.options.appId}`}var xP=1024,FP=30*24*60*60*1e3,Pf=class{constructor(e){this.container=e,this._heartbeatsCache=null;let t=this.container.getProvider("app").getImmediate();this._storage=new Nf(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}triggerHeartbeat(){return y(this,null,function*(){var e,t,r;try{let s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),o=RE();return console.log("heartbeats",(e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats),((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null&&(this._heartbeatsCache=yield this._heartbeatsCachePromise,((r=this._heartbeatsCache)===null||r===void 0?void 0:r.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===o||this._heartbeatsCache.heartbeats.some(a=>a.date===o)?void 0:(this._heartbeatsCache.heartbeats.push({date:o,agent:s}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(a=>{let c=new Date(a.date).valueOf();return Date.now()-c<=FP}),this._storage.overwrite(this._heartbeatsCache))}catch(i){Dn.warn(i)}})}getHeartbeatsHeader(){return y(this,null,function*(){var e;try{if(this._heartbeatsCache===null&&(yield this._heartbeatsCachePromise),((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";let t=RE(),{heartbeatsToSend:r,unsentEntries:i}=LP(this._heartbeatsCache.heartbeats),s=Yo(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,i.length>0?(this._heartbeatsCache.heartbeats=i,yield this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(t){return Dn.warn(t),""}})}};function RE(){return new Date().toISOString().substring(0,10)}function LP(n,e=xP){let t=[],r=n.slice();for(let i of n){let s=t.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),CE(t)>e){s.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),CE(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}var Nf=class{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return y(this,null,function*(){return fc()?pE().then(()=>!0).catch(()=>!1):!1})}read(){return y(this,null,function*(){if(yield this._canUseIndexedDBPromise){let t=yield MP(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}})}overwrite(e){return y(this,null,function*(){var t;if(yield this._canUseIndexedDBPromise){let i=yield this.read();return SE(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return})}add(e){return y(this,null,function*(){var t;if(yield this._canUseIndexedDBPromise){let i=yield this.read();return SE(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return})}};function CE(n){return Yo(JSON.stringify({version:2,heartbeats:n})).length}function VP(n){$t(new mt("platform-logger",e=>new Df(e),"PRIVATE")),$t(new mt("heartbeat",e=>new Pf(e),"PRIVATE")),_e(gc,Sf,n),_e(gc,Sf,"esm2017"),_e("fire-js","")}VP("");var BP="firebase",$P="10.13.0";_e(BP,$P,"app");var Xt=new mo("ANGULARFIRE2_VERSION");function es(n,e,t){if(e){if(e.length===1)return e[0];let s=e.filter(o=>o.app===t);if(s.length===1)return s[0]}return t.container.getProvider(n).getImmediate({optional:!0})}var Qr=(n,e)=>{let t=e?[e]:ta(),r=[];return t.forEach(i=>{i.container.getProvider(n).instances.forEach(o=>{r.includes(o)||r.push(o)})}),r},cr=class{constructor(){return Qr(jP)}},jP="app-check";function Zi(){}var _c=class{zone;delegate;constructor(e,t=k_){this.zone=e,this.delegate=t}now(){return this.delegate.now()}schedule(e,t,r){let i=this.zone,s=function(o){i.runGuarded(()=>{e.apply(this,[o])})};return this.delegate.schedule(s,t,r)}},Of=class{zone;task=null;constructor(e){this.zone=e}call(e,t){let r=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",Zi,{},Zi,Zi)),t.pipe(Ve({next:r,complete:r,error:r})).subscribe(e).add(r)}unscheduleTask(){setTimeout(()=>{this.task!=null&&this.task.state==="scheduled"&&(this.task.invoke(),this.task=null)},10)}},lr=(()=>{class n{ngZone;outsideAngular;insideAngular;constructor(t){this.ngZone=t,this.outsideAngular=t.runOutsideAngular(()=>new _c(Zone.current)),this.insideAngular=t.run(()=>new _c(Zone.current,N_)),globalThis.\u0275AngularFireScheduler||=this}static \u0275fac=function(r){return new(r||n)(Y(Pe))};static \u0275prov=X({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function vc(){let n=globalThis.\u0275AngularFireScheduler;if(!n)throw new Error(`Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using
provideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).`);return n}function zP(n){return vc().ngZone.runOutsideAngular(()=>n())}function Kr(n){return vc().ngZone.run(()=>n())}function qP(n){return GP(vc())(n)}function GP(n){return function(t){return t=t.lift(new Of(n.ngZone)),t.pipe(Fh(n.outsideAngular),xh(n.insideAngular))}}var WP=(n,e)=>function(){let r=arguments;return e&&setTimeout(()=>{e.state==="scheduled"&&e.invoke()},10),Kr(()=>n.apply(void 0,r))},fe=(n,e)=>function(){let t,r=arguments;for(let s=0;s<arguments.length;s++)typeof r[s]=="function"&&(e&&(t||=Kr(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",Zi,{},Zi,Zi))),r[s]=WP(r[s],t));let i=zP(()=>n.apply(this,r));if(!e)if(i instanceof bi){let s=vc();return i.pipe(Fh(s.outsideAngular),xh(s.insideAngular))}else return Kr(()=>i);return i instanceof bi?i.pipe(qP):i instanceof Promise?Kr(()=>new Promise((s,o)=>i.then(a=>Kr(()=>s(a)),a=>Kr(()=>o(a))))):typeof i=="function"&&t?function(){return setTimeout(()=>{t&&t.state==="scheduled"&&t.invoke()},10),i.apply(this,arguments)}:Kr(()=>i)};var zt=class{constructor(e){return e}},Cn=class{constructor(){return ta()}};function HP(n){return n&&n.length===1?n[0]:new zt(Rn())}var Mf=new te("angularfire2._apps"),KP={provide:zt,useFactory:HP,deps:[[new Ue,Mf]]},QP={provide:Cn,deps:[[new Ue,Mf]]};function YP(n){return(e,t)=>{let r=t.get(Ct);_e("angularfire",Xt.full,"core"),_e("angularfire",Xt.full,"app"),_e("angular",pv.full,r.toString());let i=e.runOutsideAngular(()=>n(t));return new zt(i)}}function DV(n,...e){return gt([KP,QP,{provide:Mf,useFactory:YP(n),multi:!0,deps:[Pe,Rt,lr,...e]}])}var SV=fe(yc,!0);function ZE(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}var eI=ZE,tI=new An("auth","Firebase",ZE());var bc=new ar("@firebase/auth");function JP(n,...e){bc.logLevel<=re.WARN&&bc.warn(`Auth (${jt}): ${n}`,...e)}function Ec(n,...e){bc.logLevel<=re.ERROR&&bc.error(`Auth (${jt}): ${n}`,...e)}function en(n,...e){throw np(n,...e)}function Yr(n,...e){return np(n,...e)}function nI(n,e,t){let r=Object.assign(Object.assign({},eI()),{[e]:t});return new An("auth","Firebase",r).create(e,{appName:n.name})}function kn(n){return nI(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function np(n,...e){if(typeof n!="string"){let t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return tI.create(n,...e)}function Q(n,e,...t){if(!n)throw np(e,...t)}function Pn(n){let e="INTERNAL ASSERTION FAILED: "+n;throw Ec(e),new Error(e)}function dr(n,e){n||Pn(e)}function Vf(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function XP(){return LE()==="http:"||LE()==="https:"}function LE(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}function ZP(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(XP()||hE()||"connection"in navigator)?navigator.onLine:!0}function eN(){if(typeof navigator>"u")return null;let n=navigator;return n.languages&&n.languages[0]||n.language||null}var Jr=class{constructor(e,t){this.shortDelay=e,this.longDelay=t,dr(t>e,"Short delay should be less than long delay!"),this.isMobile=cE()||dE()}get(){return ZP()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}};function rp(n,e){dr(n.emulator,"Emulator should always be set here");let{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}var Dc=class{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Pn("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Pn("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Pn("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}};var tN={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};var nN=new Jr(3e4,6e4);function On(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}function tn(s,o,a,c){return y(this,arguments,function*(n,e,t,r,i={}){return rI(n,i,()=>y(this,null,function*(){let l={},d={};r&&(e==="GET"?d=r:l={body:JSON.stringify(r)});let p=Jo(Object.assign({key:n.config.apiKey},d)).slice(1),m=yield n._getAdditionalHeaders();return m["Content-Type"]="application/json",n.languageCode&&(m["X-Firebase-Locale"]=n.languageCode),Dc.fetch()(iI(n,n.config.apiHost,t,p),Object.assign({method:e,headers:m,referrerPolicy:"no-referrer"},l))}))})}function rI(n,e,t){return y(this,null,function*(){n._canInitEmulator=!1;let r=Object.assign(Object.assign({},tN),e);try{let i=new Uf(n),s=yield Promise.race([t(),i.promise]);i.clearNetworkTimeout();let o=yield s.json();if("needConfirmation"in o)throw wc(n,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{let a=s.ok?o.errorMessage:o.error.message,[c,l]=a.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw wc(n,"credential-already-in-use",o);if(c==="EMAIL_EXISTS")throw wc(n,"email-already-in-use",o);if(c==="USER_DISABLED")throw wc(n,"user-disabled",o);let d=r[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(l)throw nI(n,d,l);en(n,d)}}catch(i){if(i instanceof at)throw i;en(n,"network-request-failed",{message:String(i)})}})}function ua(s,o,a,c){return y(this,arguments,function*(n,e,t,r,i={}){let l=yield tn(n,e,t,r,i);return"mfaPendingCredential"in l&&en(n,"multi-factor-auth-required",{_serverResponse:l}),l})}function iI(n,e,t,r){let i=`${e}${t}?${r}`;return n.config.emulator?rp(n.config,i):`${n.config.apiScheme}://${i}`}function rN(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}var Uf=class{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(Yr(this.auth,"network-request-failed")),nN.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}};function wc(n,e,t){let r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);let i=Yr(n,e,r);return i.customData._tokenResponse=t,i}function VE(n){return n!==void 0&&n.enterprise!==void 0}var Bf=class{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(let t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return rN(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}};function iN(n,e){return y(this,null,function*(){return tn(n,"GET","/v2/recaptchaConfig",On(n,e))})}function sN(n,e){return y(this,null,function*(){return tn(n,"POST","/v1/accounts:delete",e)})}function sI(n,e){return y(this,null,function*(){return tn(n,"POST","/v1/accounts:lookup",e)})}function na(n){if(n)try{let e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}function ip(n,e=!1){return y(this,null,function*(){let t=ie(n),r=yield t.getIdToken(e),i=sp(r);Q(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");let s=typeof i.firebase=="object"?i.firebase:void 0,o=s?.sign_in_provider;return{claims:i,token:r,authTime:na(xf(i.auth_time)),issuedAtTime:na(xf(i.iat)),expirationTime:na(xf(i.exp)),signInProvider:o||null,signInSecondFactor:s?.sign_in_second_factor||null}})}function xf(n){return Number(n)*1e3}function sp(n){let[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return Ec("JWT malformed, contained fewer than 3 sections"),null;try{let i=df(t);return i?JSON.parse(i):(Ec("Failed to decode base64 JWT payload"),null)}catch(i){return Ec("Caught error parsing JWT payload as JSON",i?.toString()),null}}function UE(n){let e=sp(n);return Q(e,"internal-error"),Q(typeof e.exp<"u","internal-error"),Q(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}function ts(n,e,t=!1){return y(this,null,function*(){if(t)return e;try{return yield e}catch(r){throw r instanceof at&&oN(r)&&n.auth.currentUser===n&&(yield n.auth.signOut()),r}})}function oN({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}var $f=class{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){let r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;let i=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;let t=this.getInterval(e);this.timerId=setTimeout(()=>y(this,null,function*(){yield this.iteration()}),t)}iteration(){return y(this,null,function*(){try{yield this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()})}};var ia=class{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=na(this.lastLoginAt),this.creationTime=na(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}};function Sc(n){return y(this,null,function*(){var e;let t=n.auth,r=yield n.getIdToken(),i=yield ts(n,sI(t,{idToken:r}));Q(i?.users.length,t,"internal-error");let s=i.users[0];n._notifyReloadListener(s);let o=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?oI(s.providerUserInfo):[],a=aN(n.providerData,o),c=n.isAnonymous,l=!(n.email&&s.passwordHash)&&!a?.length,d=c?l:!1,p={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new ia(s.createdAt,s.lastLoginAt),isAnonymous:d};Object.assign(n,p)})}function op(n){return y(this,null,function*(){let e=ie(n);yield Sc(e),yield e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)})}function aN(n,e){return[...n.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function oI(n){return n.map(e=>{var{providerId:t}=e,r=Mh(e,["providerId"]);return{providerId:t,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}function uN(n,e){return y(this,null,function*(){let t=yield rI(n,{},()=>y(this,null,function*(){let r=Jo({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=n.config,o=iI(n,i,"/v1/token",`key=${s}`),a=yield n._getAdditionalHeaders();return a["Content-Type"]="application/x-www-form-urlencoded",Dc.fetch()(o,{method:"POST",headers:a,body:r})}));return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}})}function cN(n,e){return y(this,null,function*(){return tn(n,"POST","/v2/accounts:revokeToken",On(n,e))})}var ra=class n{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Q(e.idToken,"internal-error"),Q(typeof e.idToken<"u","internal-error"),Q(typeof e.refreshToken<"u","internal-error");let t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):UE(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Q(e.length!==0,"internal-error");let t=UE(e);this.updateTokensAndExpiration(e,null,t)}getToken(e,t=!1){return y(this,null,function*(){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(Q(this.refreshToken,e,"user-token-expired"),this.refreshToken?(yield this.refresh(e,this.refreshToken),this.accessToken):null)})}clearRefreshToken(){this.refreshToken=null}refresh(e,t){return y(this,null,function*(){let{accessToken:r,refreshToken:i,expiresIn:s}=yield uN(e,t);this.updateTokensAndExpiration(r,i,Number(s))})}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){let{refreshToken:r,accessToken:i,expirationTime:s}=t,o=new n;return r&&(Q(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),i&&(Q(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),s&&(Q(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new n,this.toJSON())}_performRefresh(){return Pn("not implemented")}};function hr(n,e){Q(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}var ns=class n{constructor(e){var{uid:t,auth:r,stsTokenManager:i}=e,s=Mh(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new $f(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new ia(s.createdAt||void 0,s.lastLoginAt||void 0)}getIdToken(e){return y(this,null,function*(){let t=yield ts(this,this.stsTokenManager.getToken(this.auth,e));return Q(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,yield this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t})}getIdTokenResult(e){return ip(this,e)}reload(){return op(this)}_assign(e){this!==e&&(Q(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){let t=new n(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){Q(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(e,t=!1){return y(this,null,function*(){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&(yield Sc(this)),yield this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)})}delete(){return y(this,null,function*(){if(Mt(this.auth.app))return Promise.reject(kn(this.auth));let e=yield this.getIdToken();return yield ts(this,sN(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()})}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var r,i,s,o,a,c,l,d;let p=(r=t.displayName)!==null&&r!==void 0?r:void 0,m=(i=t.email)!==null&&i!==void 0?i:void 0,w=(s=t.phoneNumber)!==null&&s!==void 0?s:void 0,D=(o=t.photoURL)!==null&&o!==void 0?o:void 0,k=(a=t.tenantId)!==null&&a!==void 0?a:void 0,S=(c=t._redirectEventId)!==null&&c!==void 0?c:void 0,x=(l=t.createdAt)!==null&&l!==void 0?l:void 0,$=(d=t.lastLoginAt)!==null&&d!==void 0?d:void 0,{uid:F,emailVerified:U,isAnonymous:J,providerData:W,stsTokenManager:I}=t;Q(F&&I,e,"internal-error");let _=ra.fromJSON(this.name,I);Q(typeof F=="string",e,"internal-error"),hr(p,e.name),hr(m,e.name),Q(typeof U=="boolean",e,"internal-error"),Q(typeof J=="boolean",e,"internal-error"),hr(w,e.name),hr(D,e.name),hr(k,e.name),hr(S,e.name),hr(x,e.name),hr($,e.name);let E=new n({uid:F,auth:e,email:m,emailVerified:U,displayName:p,isAnonymous:J,photoURL:D,phoneNumber:w,tenantId:k,stsTokenManager:_,createdAt:x,lastLoginAt:$});return W&&Array.isArray(W)&&(E.providerData=W.map(T=>Object.assign({},T))),S&&(E._redirectEventId=S),E}static _fromIdTokenResponse(e,t,r=!1){return y(this,null,function*(){let i=new ra;i.updateFromServerResponse(t);let s=new n({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:r});return yield Sc(s),s})}static _fromGetAccountInfoResponse(e,t,r){return y(this,null,function*(){let i=t.users[0];Q(i.localId!==void 0,"internal-error");let s=i.providerUserInfo!==void 0?oI(i.providerUserInfo):[],o=!(i.email&&i.passwordHash)&&!s?.length,a=new ra;a.updateFromIdToken(r);let c=new n({uid:i.localId,auth:e,stsTokenManager:a,isAnonymous:o}),l={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new ia(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!s?.length};return Object.assign(c,l),c})}};var BE=new Map;function Nn(n){dr(n instanceof Function,"Expected a class definition");let e=BE.get(n);return e?(dr(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,BE.set(n,e),e)}var lN=(()=>{class n{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return y(this,null,function*(){return!0})}_set(t,r){return y(this,null,function*(){this.storage[t]=r})}_get(t){return y(this,null,function*(){let r=this.storage[t];return r===void 0?null:r})}_remove(t){return y(this,null,function*(){delete this.storage[t]})}_addListener(t,r){}_removeListener(t,r){}}return n.type="NONE",n})(),jf=lN;function Ic(n,e,t){return`firebase:${n}:${e}:${t}`}var Rc=class n{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;let{config:i,name:s}=this.auth;this.fullUserKey=Ic(this.userKey,i.apiKey,s),this.fullPersistenceKey=Ic("persistence",i.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}getCurrentUser(){return y(this,null,function*(){let e=yield this.persistence._get(this.fullUserKey);return e?ns._fromJSON(this.auth,e):null})}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(e){return y(this,null,function*(){if(this.persistence===e)return;let t=yield this.getCurrentUser();if(yield this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)})}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(e,t,r="authUser"){return y(this,null,function*(){if(!t.length)return new n(Nn(jf),e,r);let i=(yield Promise.all(t.map(l=>y(this,null,function*(){if(yield l._isAvailable())return l})))).filter(l=>l),s=i[0]||Nn(jf),o=Ic(r,e.config.apiKey,e.name),a=null;for(let l of t)try{let d=yield l._get(o);if(d){let p=ns._fromJSON(e,d);l!==s&&(a=p),s=l;break}}catch{}let c=i.filter(l=>l._shouldAllowMigration);return!s._shouldAllowMigration||!c.length?new n(s,e,r):(s=c[0],a&&(yield s._set(o,a.toJSON())),yield Promise.all(t.map(l=>y(this,null,function*(){if(l!==s)try{yield l._remove(o)}catch{}}))),new n(s,e,r))})}};function $E(n){let e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(lI(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(aI(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(dI(e))return"Blackberry";if(fI(e))return"Webos";if(uI(e))return"Safari";if((e.includes("chrome/")||cI(e))&&!e.includes("edge/"))return"Chrome";if(hI(e))return"Android";{let t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if(r?.length===2)return r[1]}return"Other"}function aI(n=Ne()){return/firefox\//i.test(n)}function uI(n=Ne()){let e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function cI(n=Ne()){return/crios\//i.test(n)}function lI(n=Ne()){return/iemobile/i.test(n)}function hI(n=Ne()){return/android/i.test(n)}function dI(n=Ne()){return/blackberry/i.test(n)}function fI(n=Ne()){return/webos/i.test(n)}function ap(n=Ne()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function hN(n=Ne()){var e;return ap(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function dN(){return fE()&&document.documentMode===10}function pI(n=Ne()){return ap(n)||hI(n)||fI(n)||dI(n)||/windows phone/i.test(n)||lI(n)}function gI(n,e=[]){let t;switch(n){case"Browser":t=$E(Ne());break;case"Worker":t=`${$E(Ne())}-${n}`;break;default:t=n}let r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${jt}/${r}`}var zf=class{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){let r=s=>new Promise((o,a)=>{try{let c=e(s);o(c)}catch(c){a(c)}});r.onAbort=t,this.queue.push(r);let i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}runMiddleware(e){return y(this,null,function*(){if(this.auth.currentUser===e)return;let t=[];try{for(let r of this.queue)yield r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(let i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}})}};function fN(t){return y(this,arguments,function*(n,e={}){return tn(n,"GET","/v2/passwordPolicy",On(n,e))})}var pN=6,qf=class{constructor(e){var t,r,i,s;let o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=o.minPasswordLength)!==null&&t!==void 0?t:pN,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,r,i,s,o,a;let c={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,c),this.validatePasswordCharacterOptions(e,c),c.isValid&&(c.isValid=(t=c.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),c.isValid&&(c.isValid=(r=c.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),c.isValid&&(c.isValid=(i=c.containsLowercaseLetter)!==null&&i!==void 0?i:!0),c.isValid&&(c.isValid=(s=c.containsUppercaseLetter)!==null&&s!==void 0?s:!0),c.isValid&&(c.isValid=(o=c.containsNumericCharacter)!==null&&o!==void 0?o:!0),c.isValid&&(c.isValid=(a=c.containsNonAlphanumericCharacter)!==null&&a!==void 0?a:!0),c}validatePasswordLengthOptions(e,t){let r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}};var Gf=class{constructor(e,t,r,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Cc(this),this.idTokenSubscription=new Cc(this),this.beforeStateQueue=new zf(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=tI,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Nn(t)),this._initializationPromise=this.queue(()=>y(this,null,function*(){var r,i;if(!this._deleted&&(this.persistenceManager=yield Rc.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{yield this._popupRedirectResolver._initialize(this)}catch{}yield this.initializeCurrentUser(t),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){return y(this,null,function*(){if(this._deleted)return;let e=yield this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),yield this.currentUser.getIdToken();return}yield this._updateCurrentUser(e,!0)}})}initializeCurrentUserFromIdToken(e){return y(this,null,function*(){try{let t=yield sI(this,{idToken:e}),r=yield ns._fromGetAccountInfoResponse(this,t,e);yield this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),yield this.directlySetCurrentUser(null)}})}initializeCurrentUser(e){return y(this,null,function*(){var t;if(Mt(this.app)){let o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}let r=yield this.assertedPersistence.getCurrentUser(),i=r,s=!1;if(e&&this.config.authDomain){yield this.getOrInitRedirectPersistenceManager();let o=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,a=i?._redirectEventId,c=yield this.tryRedirectSignIn(e);(!o||o===a)&&c?.user&&(i=c.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{yield this.beforeStateQueue.runMiddleware(i)}catch(o){i=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return Q(this._popupRedirectResolver,this,"argument-error"),yield this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)})}tryRedirectSignIn(e){return y(this,null,function*(){let t=null;try{t=yield this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{yield this._setRedirectUser(null)}return t})}reloadAndSetCurrentUserOrClear(e){return y(this,null,function*(){try{yield Sc(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)})}useDeviceLanguage(){this.languageCode=eN()}_delete(){return y(this,null,function*(){this._deleted=!0})}updateCurrentUser(e){return y(this,null,function*(){if(Mt(this.app))return Promise.reject(kn(this));let t=e?ie(e):null;return t&&Q(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))})}_updateCurrentUser(e,t=!1){return y(this,null,function*(){if(!this._deleted)return e&&Q(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||(yield this.beforeStateQueue.runMiddleware(e)),this.queue(()=>y(this,null,function*(){yield this.directlySetCurrentUser(e),this.notifyAuthListeners()}))})}signOut(){return y(this,null,function*(){return Mt(this.app)?Promise.reject(kn(this)):(yield this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&(yield this._setRedirectUser(null)),this._updateCurrentUser(null,!0))})}setPersistence(e){return Mt(this.app)?Promise.reject(kn(this)):this.queue(()=>y(this,null,function*(){yield this.assertedPersistence.setPersistence(Nn(e))}))}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}validatePassword(e){return y(this,null,function*(){this._getPasswordPolicyInternal()||(yield this._updatePasswordPolicy());let t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)})}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}_updatePasswordPolicy(){return y(this,null,function*(){let e=yield fN(this),t=new qf(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t})}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new An("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{let r=this.onAuthStateChanged(()=>{r(),e()},t)}})}revokeAccessToken(e){return y(this,null,function*(){if(this.currentUser){let t=yield this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),yield cN(this,r)}})}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}_setRedirectUser(e,t){return y(this,null,function*(){let r=yield this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)})}getOrInitRedirectPersistenceManager(e){return y(this,null,function*(){if(!this.redirectPersistenceManager){let t=e&&Nn(e)||this._popupRedirectResolver;Q(t,this,"argument-error"),this.redirectPersistenceManager=yield Rc.create(this,[Nn(t._redirectPersistence)],"redirectUser"),this.redirectUser=yield this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager})}_redirectUserForId(e){return y(this,null,function*(){var t,r;return this._isInitialized&&(yield this.queue(()=>y(this,null,function*(){}))),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null})}_persistUserIfCurrent(e){return y(this,null,function*(){if(e===this.currentUser)return this.queue(()=>y(this,null,function*(){return this.directlySetCurrentUser(e)}))})}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);let r=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,i){if(this._deleted)return()=>{};let s=typeof t=="function"?t:t.next.bind(t),o=!1,a=this._isInitialized?Promise.resolve():this._initializationPromise;if(Q(a,this,"internal-error"),a.then(()=>{o||s(this.currentUser)}),typeof t=="function"){let c=e.addObserver(t,r,i);return()=>{o=!0,c()}}else{let c=e.addObserver(t);return()=>{o=!0,c()}}}directlySetCurrentUser(e){return y(this,null,function*(){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?yield this.assertedPersistence.setCurrentUser(e):yield this.assertedPersistence.removeCurrentUser()})}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Q(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=gI(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){return y(this,null,function*(){var e;let t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);let r=yield(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader();r&&(t["X-Firebase-Client"]=r);let i=yield this._getAppCheckToken();return i&&(t["X-Firebase-AppCheck"]=i),t})}_getAppCheckToken(){return y(this,null,function*(){var e;let t=yield(e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken();return t?.error&&JP(`Error while retrieving App Check token: ${t.error}`),t?.token})}};function fr(n){return ie(n)}var Cc=class{constructor(e){this.auth=e,this.observer=null,this.addObserver=mE(t=>this.observer=t)}get next(){return Q(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}};var Lc={loadJS(){return y(this,null,function*(){throw new Error("Unable to load external scripts")})},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function gN(n){Lc=n}function mI(n){return Lc.loadJS(n)}function mN(){return Lc.recaptchaEnterpriseScript}function yN(){return Lc.gapiScript}function yI(n){return`__${n}${Math.floor(Math.random()*1e6)}`}var _N="recaptcha-enterprise",vN="NO_RECAPTCHA",Wf=class{constructor(e){this.type=_N,this.auth=fr(e)}verify(e="verify",t=!1){return y(this,null,function*(){function r(s){return y(this,null,function*(){if(!t){if(s.tenantId==null&&s._agentRecaptchaConfig!=null)return s._agentRecaptchaConfig.siteKey;if(s.tenantId!=null&&s._tenantRecaptchaConfigs[s.tenantId]!==void 0)return s._tenantRecaptchaConfigs[s.tenantId].siteKey}return new Promise((o,a)=>y(this,null,function*(){iN(s,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(c=>{if(c.recaptchaKey===void 0)a(new Error("recaptcha Enterprise site key undefined"));else{let l=new Bf(c);return s.tenantId==null?s._agentRecaptchaConfig=l:s._tenantRecaptchaConfigs[s.tenantId]=l,o(l.siteKey)}}).catch(c=>{a(c)})}))})}function i(s,o,a){let c=window.grecaptcha;VE(c)?c.enterprise.ready(()=>{c.enterprise.execute(s,{action:e}).then(l=>{o(l)}).catch(()=>{o(vN)})}):a(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((s,o)=>{r(this.auth).then(a=>{if(!t&&VE(window.grecaptcha))i(a,s,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let c=mN();c.length!==0&&(c+=a),mI(c).then(()=>{i(a,s,o)}).catch(l=>{o(l)})}}).catch(a=>{o(a)})})})}};function jE(n,e,t,r=!1){return y(this,null,function*(){let i=new Wf(n),s;try{s=yield i.verify(t)}catch{s=yield i.verify(t,!0)}let o=Object.assign({},e);return r?Object.assign(o,{captchaResp:s}):Object.assign(o,{captchaResponse:s}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o})}function Pc(n,e,t,r){return y(this,null,function*(){var i;if(!((i=n._getRecaptchaConfig())===null||i===void 0)&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){let s=yield jE(n,e,t,t==="getOobCode");return r(n,s)}else return r(n,e).catch(s=>y(this,null,function*(){if(s.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);let o=yield jE(n,e,t,t==="getOobCode");return r(n,o)}else return Promise.reject(s)}))})}function up(n,e){let t=Sn(n,"auth");if(t.isInitialized()){let i=t.getImmediate(),s=t.getOptions();if(bn(s,e??{}))return i;en(i,"already-initialized")}return t.initialize({options:e})}function wN(n,e){let t=e?.persistence||[],r=(Array.isArray(t)?t:[t]).map(Nn);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e?.popupRedirectResolver)}function cp(n,e,t){let r=fr(n);Q(r._canInitEmulator,r,"emulator-config-failed"),Q(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");let i=!!t?.disableWarnings,s=_I(e),{host:o,port:a}=EN(e),c=a===null?"":`:${a}`;r.config.emulator={url:`${s}//${o}${c}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})}),i||IN()}function _I(n){let e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function EN(n){let e=_I(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};let r=t[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){let s=i[1];return{host:s,port:zE(r.substr(s.length+1))}}else{let[s,o]=r.split(":");return{host:s,port:zE(o)}}}function zE(n){if(!n)return null;let e=Number(n);return isNaN(e)?null:e}function IN(){function n(){let e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}var sa=class{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Pn("not implemented")}_getIdTokenResponse(e){return Pn("not implemented")}_linkToIdToken(e,t){return Pn("not implemented")}_getReauthenticationResolver(e){return Pn("not implemented")}};function TN(n,e){return y(this,null,function*(){return tn(n,"POST","/v1/accounts:signUp",e)})}function AN(n,e){return y(this,null,function*(){return ua(n,"POST","/v1/accounts:signInWithPassword",On(n,e))})}function bN(n,e){return y(this,null,function*(){return tn(n,"POST","/v1/accounts:sendOobCode",On(n,e))})}function DN(n,e){return y(this,null,function*(){return bN(n,e)})}function SN(n,e){return y(this,null,function*(){return ua(n,"POST","/v1/accounts:signInWithEmailLink",On(n,e))})}function RN(n,e){return y(this,null,function*(){return ua(n,"POST","/v1/accounts:signInWithEmailLink",On(n,e))})}var oa=class n extends sa{constructor(e,t,r,i=null){super("password",r),this._email=e,this._password=t,this._tenantId=i}static _fromEmailAndPassword(e,t){return new n(e,t,"password")}static _fromEmailAndCode(e,t,r=null){return new n(e,t,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){let t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}_getIdTokenResponse(e){return y(this,null,function*(){switch(this.signInMethod){case"password":let t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Pc(e,t,"signInWithPassword",AN);case"emailLink":return SN(e,{email:this._email,oobCode:this._password});default:en(e,"internal-error")}})}_linkToIdToken(e,t){return y(this,null,function*(){switch(this.signInMethod){case"password":let r={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Pc(e,r,"signUpPassword",TN);case"emailLink":return RN(e,{idToken:t,email:this._email,oobCode:this._password});default:en(e,"internal-error")}})}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}};function Ff(n,e){return y(this,null,function*(){return ua(n,"POST","/v1/accounts:signInWithIdp",On(n,e))})}function CN(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function PN(n){let e=Qi(Yi(n)).link,t=e?Qi(Yi(e)).deep_link_id:null,r=Qi(Yi(n)).deep_link_id;return(r?Qi(Yi(r)).link:null)||r||t||e||n}var Nc=class n{constructor(e){var t,r,i,s,o,a;let c=Qi(Yi(e)),l=(t=c.apiKey)!==null&&t!==void 0?t:null,d=(r=c.oobCode)!==null&&r!==void 0?r:null,p=CN((i=c.mode)!==null&&i!==void 0?i:null);Q(l&&d&&p,"argument-error"),this.apiKey=l,this.operation=p,this.code=d,this.continueUrl=(s=c.continueUrl)!==null&&s!==void 0?s:null,this.languageCode=(o=c.languageCode)!==null&&o!==void 0?o:null,this.tenantId=(a=c.tenantId)!==null&&a!==void 0?a:null}static parseLink(e){let t=PN(e);try{return new n(t)}catch{return null}}};var vI=(()=>{class n{constructor(){this.providerId=n.PROVIDER_ID}static credential(t,r){return oa._fromEmailAndPassword(t,r)}static credentialWithLink(t,r){let i=Nc.parseLink(r);return Q(i,"argument-error"),oa._fromEmailAndCode(t,i.code,i.tenantId)}}n.PROVIDER_ID="password",n.EMAIL_PASSWORD_SIGN_IN_METHOD="password",n.EMAIL_LINK_SIGN_IN_METHOD="emailLink";return n})(),kc=class{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}};var Hf=class extends kc{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}};function NN(n,e){return y(this,null,function*(){return ua(n,"POST","/v1/accounts:signUp",On(n,e))})}var rs=class n{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static _fromIdTokenResponse(e,t,r,i=!1){return y(this,null,function*(){let s=yield ns._fromIdTokenResponse(e,r,i),o=qE(r);return new n({user:s,providerId:o,_tokenResponse:r,operationType:t})})}static _forOperation(e,t,r){return y(this,null,function*(){yield e._updateTokensIfNecessary(r,!0);let i=qE(r);return new n({user:e,providerId:i,_tokenResponse:r,operationType:t})})}};function qE(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}var Kf=class n extends at{constructor(e,t,r,i){var s;super(t.code,t.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,n.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,i){return new n(e,t,r,i)}};function wI(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?Kf._fromErrorAndOperation(n,s,e,r):s})}function kN(n,e,t=!1){return y(this,null,function*(){let r=yield ts(n,e._linkToIdToken(n.auth,yield n.getIdToken()),t);return rs._forOperation(n,"link",r)})}function ON(n,e,t=!1){return y(this,null,function*(){let{auth:r}=n;if(Mt(r.app))return Promise.reject(kn(r));let i="reauthenticate";try{let s=yield ts(n,wI(r,i,e,n),t);Q(s.idToken,r,"internal-error");let o=sp(s.idToken);Q(o,r,"internal-error");let{sub:a}=o;return Q(n.uid===a,r,"user-mismatch"),rs._forOperation(n,i,s)}catch(s){throw s?.code==="auth/user-not-found"&&en(r,"user-mismatch"),s}})}function EI(n,e,t=!1){return y(this,null,function*(){if(Mt(n.app))return Promise.reject(kn(n));let r="signIn",i=yield wI(n,r,e),s=yield rs._fromIdTokenResponse(n,r,i);return t||(yield n._updateCurrentUser(s.user)),s})}function lp(n,e){return y(this,null,function*(){return EI(fr(n),e)})}function MN(n,e,t){var r;Q(((r=t.url)===null||r===void 0?void 0:r.length)>0,n,"invalid-continue-uri"),Q(typeof t.dynamicLinkDomain>"u"||t.dynamicLinkDomain.length>0,n,"invalid-dynamic-link-domain"),e.continueUrl=t.url,e.dynamicLinkDomain=t.dynamicLinkDomain,e.canHandleCodeInApp=t.handleCodeInApp,t.iOS&&(Q(t.iOS.bundleId.length>0,n,"missing-ios-bundle-id"),e.iOSBundleId=t.iOS.bundleId),t.android&&(Q(t.android.packageName.length>0,n,"missing-android-pkg-name"),e.androidInstallApp=t.android.installApp,e.androidMinimumVersionCode=t.android.minimumVersion,e.androidPackageName=t.android.packageName)}function II(n){return y(this,null,function*(){let e=fr(n);e._getPasswordPolicyInternal()&&(yield e._updatePasswordPolicy())})}function hp(n,e,t){return y(this,null,function*(){let r=fr(n),i={requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"};t&&MN(r,i,t),yield Pc(r,i,"getOobCode",DN)})}function dp(n,e,t){return y(this,null,function*(){if(Mt(n.app))return Promise.reject(kn(n));let r=fr(n),o=yield Pc(r,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",NN).catch(c=>{throw c.code==="auth/password-does-not-meet-requirements"&&II(n),c}),a=yield rs._fromIdTokenResponse(r,"signIn",o);return yield r._updateCurrentUser(a.user),a})}function fp(n,e,t){return Mt(n.app)?Promise.reject(kn(n)):lp(ie(n),vI.credential(e,t)).catch(r=>y(this,null,function*(){throw r.code==="auth/password-does-not-meet-requirements"&&II(n),r}))}function xN(n,e){return y(this,null,function*(){return tn(n,"POST","/v1/accounts:update",e)})}function pp(r,i){return y(this,arguments,function*(n,{displayName:e,photoURL:t}){if(e===void 0&&t===void 0)return;let s=ie(n),a={idToken:yield s.getIdToken(),displayName:e,photoUrl:t,returnSecureToken:!0},c=yield ts(s,xN(s.auth,a));s.displayName=c.displayName||null,s.photoURL=c.photoUrl||null;let l=s.providerData.find(({providerId:d})=>d==="password");l&&(l.displayName=s.displayName,l.photoURL=s.photoURL),yield s._updateTokensIfNecessary(c)})}function gp(n,e,t,r){return ie(n).onIdTokenChanged(e,t,r)}function mp(n,e,t){return ie(n).beforeAuthStateChanged(e,t)}function yp(n,e,t,r){return ie(n).onAuthStateChanged(e,t,r)}function _p(n){return ie(n).signOut()}var Oc="__sak";var Mc=class{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Oc,"1"),this.storage.removeItem(Oc),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){let t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}};var FN=1e3,LN=10,VN=(()=>{class n extends Mc{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(t,r)=>this.onStorageEvent(t,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=pI(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(let r of Object.keys(this.listeners)){let i=this.storage.getItem(r),s=this.localCache[r];i!==s&&t(r,s,i)}}onStorageEvent(t,r=!1){if(!t.key){this.forAllChangedKeys((a,c,l)=>{this.notifyListeners(a,l)});return}let i=t.key;r?this.detachListener():this.stopPolling();let s=()=>{let a=this.storage.getItem(i);!r&&this.localCache[i]===a||this.notifyListeners(i,a)},o=this.storage.getItem(i);dN()&&o!==t.newValue&&t.newValue!==t.oldValue?setTimeout(s,LN):s()}notifyListeners(t,r){this.localCache[t]=r;let i=this.listeners[t];if(i)for(let s of Array.from(i))s(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((t,r,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:r,newValue:i}),!0)})},FN)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(r)}_removeListener(t,r){this.listeners[t]&&(this.listeners[t].delete(r),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}_set(t,r){return y(this,null,function*(){yield Ht(n.prototype,this,"_set").call(this,t,r),this.localCache[t]=JSON.stringify(r)})}_get(t){return y(this,null,function*(){let r=yield Ht(n.prototype,this,"_get").call(this,t);return this.localCache[t]=JSON.stringify(r),r})}_remove(t){return y(this,null,function*(){yield Ht(n.prototype,this,"_remove").call(this,t),delete this.localCache[t]})}}return n.type="LOCAL",n})(),TI=VN;var UN=(()=>{class n extends Mc{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(t,r){}_removeListener(t,r){}}return n.type="SESSION",n})(),vp=UN;function BN(n){return Promise.all(n.map(e=>y(this,null,function*(){try{return{fulfilled:!0,value:yield e}}catch(t){return{fulfilled:!1,reason:t}}})))}var $N=(()=>{class n{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){let r=this.receivers.find(s=>s.isListeningto(t));if(r)return r;let i=new n(t);return this.receivers.push(i),i}isListeningto(t){return this.eventTarget===t}handleEvent(t){return y(this,null,function*(){let r=t,{eventId:i,eventType:s,data:o}=r.data,a=this.handlersMap[s];if(!a?.size)return;r.ports[0].postMessage({status:"ack",eventId:i,eventType:s});let c=Array.from(a).map(d=>y(this,null,function*(){return d(r.origin,o)})),l=yield BN(c);r.ports[0].postMessage({status:"done",eventId:i,eventType:s,response:l})})}_subscribe(t,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(r)}_unsubscribe(t,r){this.handlersMap[t]&&r&&this.handlersMap[t].delete(r),(!r||this.handlersMap[t].size===0)&&delete this.handlersMap[t],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}n.receivers=[];return n})();function AI(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}var Qf=class{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}_send(e,t,r=50){return y(this,null,function*(){let i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,o;return new Promise((a,c)=>{let l=AI("",20);i.port1.start();let d=setTimeout(()=>{c(new Error("unsupported_event"))},r);o={messageChannel:i,onMessage(p){let m=p;if(m.data.eventId===l)switch(m.data.status){case"ack":clearTimeout(d),s=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),a(m.data.response);break;default:clearTimeout(d),clearTimeout(s),c(new Error("invalid_response"));break}}},this.handlers.add(o),i.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:l,data:t},[i.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})})}};function Zt(){return window}function jN(n){Zt().location.href=n}function bI(){return typeof Zt().WorkerGlobalScope<"u"&&typeof Zt().importScripts=="function"}function zN(){return y(this,null,function*(){if(!navigator?.serviceWorker)return null;try{return(yield navigator.serviceWorker.ready).active}catch{return null}})}function qN(){var n;return((n=navigator?.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function GN(){return bI()?self:null}var DI="firebaseLocalStorageDb",WN=1,xc="firebaseLocalStorage",SI="fbase_key",Xr=class{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}};function Vc(n,e){return n.transaction([xc],e?"readwrite":"readonly").objectStore(xc)}function HN(){let n=indexedDB.deleteDatabase(DI);return new Xr(n).toPromise()}function Yf(){let n=indexedDB.open(DI,WN);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{let r=n.result;try{r.createObjectStore(xc,{keyPath:SI})}catch(i){t(i)}}),n.addEventListener("success",()=>y(this,null,function*(){let r=n.result;r.objectStoreNames.contains(xc)?e(r):(r.close(),yield HN(),e(yield Yf()))}))})}function GE(n,e,t){return y(this,null,function*(){let r=Vc(n,!0).put({[SI]:e,value:t});return new Xr(r).toPromise()})}function KN(n,e){return y(this,null,function*(){let t=Vc(n,!1).get(e),r=yield new Xr(t).toPromise();return r===void 0?null:r.value})}function WE(n,e){let t=Vc(n,!0).delete(e);return new Xr(t).toPromise()}var QN=800,YN=3,JN=(()=>{class n{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}_openDb(){return y(this,null,function*(){return this.db?this.db:(this.db=yield Yf(),this.db)})}_withRetries(t){return y(this,null,function*(){let r=0;for(;;)try{let i=yield this._openDb();return yield t(i)}catch(i){if(r++>YN)throw i;this.db&&(this.db.close(),this.db=void 0)}})}initializeServiceWorkerMessaging(){return y(this,null,function*(){return bI()?this.initializeReceiver():this.initializeSender()})}initializeReceiver(){return y(this,null,function*(){this.receiver=$N._getInstance(GN()),this.receiver._subscribe("keyChanged",(t,r)=>y(this,null,function*(){return{keyProcessed:(yield this._poll()).includes(r.key)}})),this.receiver._subscribe("ping",(t,r)=>y(this,null,function*(){return["keyChanged"]}))})}initializeSender(){return y(this,null,function*(){var t,r;if(this.activeServiceWorker=yield zN(),!this.activeServiceWorker)return;this.sender=new Qf(this.activeServiceWorker);let i=yield this.sender._send("ping",{},800);i&&!((t=i[0])===null||t===void 0)&&t.fulfilled&&!((r=i[0])===null||r===void 0)&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)})}notifyServiceWorker(t){return y(this,null,function*(){if(!(!this.sender||!this.activeServiceWorker||qN()!==this.activeServiceWorker))try{yield this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50)}catch{}})}_isAvailable(){return y(this,null,function*(){try{if(!indexedDB)return!1;let t=yield Yf();return yield GE(t,Oc,"1"),yield WE(t,Oc),!0}catch{}return!1})}_withPendingWrite(t){return y(this,null,function*(){this.pendingWrites++;try{yield t()}finally{this.pendingWrites--}})}_set(t,r){return y(this,null,function*(){return this._withPendingWrite(()=>y(this,null,function*(){return yield this._withRetries(i=>GE(i,t,r)),this.localCache[t]=r,this.notifyServiceWorker(t)}))})}_get(t){return y(this,null,function*(){let r=yield this._withRetries(i=>KN(i,t));return this.localCache[t]=r,r})}_remove(t){return y(this,null,function*(){return this._withPendingWrite(()=>y(this,null,function*(){return yield this._withRetries(r=>WE(r,t)),delete this.localCache[t],this.notifyServiceWorker(t)}))})}_poll(){return y(this,null,function*(){let t=yield this._withRetries(s=>{let o=Vc(s,!1).getAll();return new Xr(o).toPromise()});if(!t)return[];if(this.pendingWrites!==0)return[];let r=[],i=new Set;if(t.length!==0)for(let{fbase_key:s,value:o}of t)i.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(o)&&(this.notifyListeners(s,o),r.push(s));for(let s of Object.keys(this.localCache))this.localCache[s]&&!i.has(s)&&(this.notifyListeners(s,null),r.push(s));return r})}notifyListeners(t,r){this.localCache[t]=r;let i=this.listeners[t];if(i)for(let s of Array.from(i))s(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>y(this,null,function*(){return this._poll()}),QN)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(r)}_removeListener(t,r){this.listeners[t]&&(this.listeners[t].delete(r),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&this.stopPolling()}}return n.type="LOCAL",n})(),RI=JN;var xV=yI("rcb"),FV=new Jr(3e4,6e4);function XN(n,e){return e?Nn(e):(Q(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}var aa=class extends sa{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Ff(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Ff(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Ff(e,this._buildIdpRequest())}_buildIdpRequest(e){let t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}};function ZN(n){return EI(n.auth,new aa(n),n.bypassAuthState)}function ek(n){let{auth:e,user:t}=n;return Q(t,e,"internal-error"),ON(t,new aa(n),n.bypassAuthState)}function tk(n){return y(this,null,function*(){let{auth:e,user:t}=n;return Q(t,e,"internal-error"),kN(t,new aa(n),n.bypassAuthState)})}var Jf=class{constructor(e,t,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise((e,t)=>y(this,null,function*(){this.pendingPromise={resolve:e,reject:t};try{this.eventManager=yield this.resolver._initialize(this.auth),yield this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}}))}onAuthEvent(e){return y(this,null,function*(){let{urlResponse:t,sessionId:r,postBody:i,tenantId:s,error:o,type:a}=e;if(o){this.reject(o);return}let c={auth:this.auth,requestUri:t,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(yield this.getIdpTask(a)(c))}catch(l){this.reject(l)}})}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return ZN;case"linkViaPopup":case"linkViaRedirect":return tk;case"reauthViaPopup":case"reauthViaRedirect":return ek;default:en(this.auth,"internal-error")}}resolve(e){dr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){dr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}};var LV=new Jr(2e3,1e4);var nk="pendingRedirect",Tc=new Map,Xf=class n extends Jf{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}execute(){return y(this,null,function*(){let e=Tc.get(this.auth._key());if(!e){try{let r=(yield rk(this.resolver,this.auth))?yield Ht(n.prototype,this,"execute").call(this):null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}Tc.set(this.auth._key(),e)}return this.bypassAuthState||Tc.set(this.auth._key(),()=>Promise.resolve(null)),e()})}onAuthEvent(e){return y(this,null,function*(){if(e.type==="signInViaRedirect")return Ht(n.prototype,this,"onAuthEvent").call(this,e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){let t=yield this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,Ht(n.prototype,this,"onAuthEvent").call(this,e);this.resolve(null)}})}onExecution(){return y(this,null,function*(){})}cleanUp(){}};function rk(n,e){return y(this,null,function*(){let t=ok(e),r=sk(n);if(!(yield r._isAvailable()))return!1;let i=(yield r._get(t))==="true";return yield r._remove(t),i})}function ik(n,e){Tc.set(n._key(),e)}function sk(n){return Nn(n._redirectPersistence)}function ok(n){return Ic(nk,n.config.apiKey,n.name)}function ak(n,e,t=!1){return y(this,null,function*(){if(Mt(n.app))return Promise.reject(kn(n));let r=fr(n),i=XN(r,e),o=yield new Xf(r,i,t).execute();return o&&!t&&(delete o.user._redirectEventId,yield r._persistUserIfCurrent(o.user),yield r._setRedirectUser(null,e)),o})}var uk=10*60*1e3,Zf=class{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!ck(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var r;if(e.error&&!CI(e)){let i=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";t.onError(Yr(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){let r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=uk&&this.cachedEventUids.clear(),this.cachedEventUids.has(HE(e))}saveEventToCache(e){this.cachedEventUids.add(HE(e)),this.lastProcessedEventTime=Date.now()}};function HE(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function CI({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function ck(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return CI(n);default:return!1}}function lk(t){return y(this,arguments,function*(n,e={}){return tn(n,"GET","/v1/projects",e)})}var hk=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,dk=/^https?/;function fk(n){return y(this,null,function*(){if(n.config.emulator)return;let{authorizedDomains:e}=yield lk(n);for(let t of e)try{if(pk(t))return}catch{}en(n,"unauthorized-domain")})}function pk(n){let e=Vf(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){let o=new URL(n);return o.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&o.hostname===r}if(!dk.test(t))return!1;if(hk.test(n))return r===n;let i=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}var gk=new Jr(3e4,6e4);function KE(){let n=Zt().___jsl;if(n?.H){for(let e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function mk(n){return new Promise((e,t)=>{var r,i,s;function o(){KE(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{KE(),t(Yr(n,"network-request-failed"))},timeout:gk.get()})}if(!((i=(r=Zt().gapi)===null||r===void 0?void 0:r.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((s=Zt().gapi)===null||s===void 0)&&s.load)o();else{let a=yI("iframefcb");return Zt()[a]=()=>{gapi.load?o():t(Yr(n,"network-request-failed"))},mI(`${yN()}?onload=${a}`).catch(c=>t(c))}}).catch(e=>{throw Ac=null,e})}var Ac=null;function yk(n){return Ac=Ac||mk(n),Ac}var _k=new Jr(5e3,15e3),vk="__/auth/iframe",wk="emulator/auth/iframe",Ek={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Ik=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Tk(n){let e=n.config;Q(e.authDomain,n,"auth-domain-config-required");let t=e.emulator?rp(e,wk):`https://${n.config.authDomain}/${vk}`,r={apiKey:e.apiKey,appName:n.name,v:jt},i=Ik.get(n.config.apiHost);i&&(r.eid=i);let s=n._getFrameworks();return s.length&&(r.fw=s.join(",")),`${t}?${Jo(r).slice(1)}`}function Ak(n){return y(this,null,function*(){let e=yield yk(n),t=Zt().gapi;return Q(t,n,"internal-error"),e.open({where:document.body,url:Tk(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Ek,dontclear:!0},r=>new Promise((i,s)=>y(this,null,function*(){yield r.restyle({setHideOnLeave:!1});let o=Yr(n,"network-request-failed"),a=Zt().setTimeout(()=>{s(o)},_k.get());function c(){Zt().clearTimeout(a),i(r)}r.ping(c).then(c,()=>{s(o)})})))})}var bk={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},Dk=500,Sk=600,Rk="_blank",Ck="http://localhost",Fc=class{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}};function Pk(n,e,t,r=Dk,i=Sk){let s=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString(),a="",c=Object.assign(Object.assign({},bk),{width:r.toString(),height:i.toString(),top:s,left:o}),l=Ne().toLowerCase();t&&(a=cI(l)?Rk:t),aI(l)&&(e=e||Ck,c.scrollbars="yes");let d=Object.entries(c).reduce((m,[w,D])=>`${m}${w}=${D},`,"");if(hN(l)&&a!=="_self")return Nk(e||"",a),new Fc(null);let p=window.open(e||"",a,d);Q(p,n,"popup-blocked");try{p.focus()}catch{}return new Fc(p)}function Nk(n,e){let t=document.createElement("a");t.href=n,t.target=e;let r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}var kk="__/auth/handler",Ok="emulator/auth/handler",Mk=encodeURIComponent("fac");function QE(n,e,t,r,i,s){return y(this,null,function*(){Q(n.config.authDomain,n,"auth-domain-config-required"),Q(n.config.apiKey,n,"invalid-api-key");let o={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:jt,eventId:i};if(e instanceof kc){e.setDefaultLanguage(n.languageCode),o.providerId=e.providerId||"",gE(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(let[d,p]of Object.entries(s||{}))o[d]=p}if(e instanceof Hf){let d=e.getScopes().filter(p=>p!=="");d.length>0&&(o.scopes=d.join(","))}n.tenantId&&(o.tid=n.tenantId);let a=o;for(let d of Object.keys(a))a[d]===void 0&&delete a[d];let c=yield n._getAppCheckToken(),l=c?`#${Mk}=${encodeURIComponent(c)}`:"";return`${xk(n)}?${Jo(a).slice(1)}${l}`})}function xk({config:n}){return n.emulator?rp(n,Ok):`https://${n.authDomain}/${kk}`}var Lf="webStorageSupport",ep=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=vp,this._completeRedirectFn=ak,this._overrideRedirectResult=ik}_openPopup(e,t,r,i){return y(this,null,function*(){var s;dr((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");let o=yield QE(e,t,r,Vf(),i);return Pk(e,o,AI())})}_openRedirect(e,t,r,i){return y(this,null,function*(){yield this._originValidation(e);let s=yield QE(e,t,r,Vf(),i);return jN(s),new Promise(()=>{})})}_initialize(e){let t=e._key();if(this.eventManagers[t]){let{manager:i,promise:s}=this.eventManagers[t];return i?Promise.resolve(i):(dr(s,"If manager is not set, promise should be"),s)}let r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}initAndGetManager(e){return y(this,null,function*(){let t=yield Ak(e),r=new Zf(e);return t.register("authEvent",i=>(Q(i?.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r})}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Lf,{type:Lf},i=>{var s;let o=(s=i?.[0])===null||s===void 0?void 0:s[Lf];o!==void 0&&t(!!o),en(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){let t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=fk(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return pI()||uI()||ap()}},PI=ep;var YE="@firebase/auth",JE="1.7.7";var tp=class{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}getToken(e){return y(this,null,function*(){return this.assertAuthConfigured(),yield this.auth._initializationPromise,this.auth.currentUser?{accessToken:yield this.auth.currentUser.getIdToken(e)}:null})}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;let t=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();let t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Q(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}};function Fk(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function Lk(n){$t(new mt("auth",(e,{options:t})=>{let r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;Q(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});let c={apiKey:o,authDomain:a,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:gI(n)},l=new Gf(r,i,s,c);return wN(l,t),l},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),$t(new mt("auth-internal",e=>{let t=fr(e.getProvider("auth").getImmediate());return(r=>new tp(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),_e(YE,JE,Fk(n)),_e(YE,JE,"esm2017")}var Vk=5*60,Uk=gf("authIdTokenMaxAge")||Vk,XE=null,Bk=n=>e=>y(void 0,null,function*(){let t=e&&(yield e.getIdTokenResult()),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>Uk)return;let i=t?.token;XE!==i&&(XE=i,yield fetch(n,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))});function wp(n=Rn()){let e=Sn(n,"auth");if(e.isInitialized())return e.getImmediate();let t=up(n,{popupRedirectResolver:PI,persistence:[RI,TI,vp]}),r=gf("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){let s=new URL(r,location.origin);if(location.origin===s.origin){let o=Bk(s.toString());mp(t,o,()=>o(t.currentUser)),gp(t,a=>o(a))}}let i=ff("auth");return i&&cp(t,`http://${i}`),t}function $k(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}gN({loadJS(n){return new Promise((e,t)=>{let r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=i=>{let s=Yr("internal-error");s.customData=i,t(s)},r.type="text/javascript",r.charset="UTF-8",$k().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});Lk("Browser");var NI="auth",ca=class{constructor(e){return e}},Zr=class{constructor(){return Qr(NI)}};var Ep=new te("angularfire2.auth-instances");function RO(n,e){let t=es(NI,n,e);return t&&new ca(t)}function CO(n){return(e,t)=>{let r=e.runOutsideAngular(()=>n(t));return new ca(r)}}var PO={provide:Zr,deps:[[new Ue,Ep]]},NO={provide:ca,useFactory:RO,deps:[[new Ue,Ep],zt]};function wU(n,...e){return _e("angularfire",Xt.full,"auth"),gt([NO,PO,{provide:Ep,useFactory:CO(n),multi:!0,deps:[Pe,Rt,lr,Cn,[new Ue,cr],...e]}])}var EU=fe(dp,!0);var IU=fe(wp,!0);var TU=fe(yp,!0);var AU=fe(hp,!0);var bU=fe(fp,!0);var DU=fe(_p,!0);var SU=fe(pp,!0);var kI=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},OI={};var pr,Ip;(function(){var n;function e(I,_){function E(){}E.prototype=_.prototype,I.D=_.prototype,I.prototype=new E,I.prototype.constructor=I,I.C=function(T,A,R){for(var v=Array(arguments.length-2),fn=2;fn<arguments.length;fn++)v[fn-2]=arguments[fn];return _.prototype[A].apply(T,v)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,t),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(I,_,E){E||(E=0);var T=Array(16);if(typeof _=="string")for(var A=0;16>A;++A)T[A]=_.charCodeAt(E++)|_.charCodeAt(E++)<<8|_.charCodeAt(E++)<<16|_.charCodeAt(E++)<<24;else for(A=0;16>A;++A)T[A]=_[E++]|_[E++]<<8|_[E++]<<16|_[E++]<<24;_=I.g[0],E=I.g[1],A=I.g[2];var R=I.g[3],v=_+(R^E&(A^R))+T[0]+3614090360&4294967295;_=E+(v<<7&4294967295|v>>>25),v=R+(A^_&(E^A))+T[1]+3905402710&4294967295,R=_+(v<<12&4294967295|v>>>20),v=A+(E^R&(_^E))+T[2]+606105819&4294967295,A=R+(v<<17&4294967295|v>>>15),v=E+(_^A&(R^_))+T[3]+3250441966&4294967295,E=A+(v<<22&4294967295|v>>>10),v=_+(R^E&(A^R))+T[4]+4118548399&4294967295,_=E+(v<<7&4294967295|v>>>25),v=R+(A^_&(E^A))+T[5]+1200080426&4294967295,R=_+(v<<12&4294967295|v>>>20),v=A+(E^R&(_^E))+T[6]+2821735955&4294967295,A=R+(v<<17&4294967295|v>>>15),v=E+(_^A&(R^_))+T[7]+4249261313&4294967295,E=A+(v<<22&4294967295|v>>>10),v=_+(R^E&(A^R))+T[8]+1770035416&4294967295,_=E+(v<<7&4294967295|v>>>25),v=R+(A^_&(E^A))+T[9]+2336552879&4294967295,R=_+(v<<12&4294967295|v>>>20),v=A+(E^R&(_^E))+T[10]+4294925233&4294967295,A=R+(v<<17&4294967295|v>>>15),v=E+(_^A&(R^_))+T[11]+2304563134&4294967295,E=A+(v<<22&4294967295|v>>>10),v=_+(R^E&(A^R))+T[12]+1804603682&4294967295,_=E+(v<<7&4294967295|v>>>25),v=R+(A^_&(E^A))+T[13]+4254626195&4294967295,R=_+(v<<12&4294967295|v>>>20),v=A+(E^R&(_^E))+T[14]+2792965006&4294967295,A=R+(v<<17&4294967295|v>>>15),v=E+(_^A&(R^_))+T[15]+1236535329&4294967295,E=A+(v<<22&4294967295|v>>>10),v=_+(A^R&(E^A))+T[1]+4129170786&4294967295,_=E+(v<<5&4294967295|v>>>27),v=R+(E^A&(_^E))+T[6]+3225465664&4294967295,R=_+(v<<9&4294967295|v>>>23),v=A+(_^E&(R^_))+T[11]+643717713&4294967295,A=R+(v<<14&4294967295|v>>>18),v=E+(R^_&(A^R))+T[0]+3921069994&4294967295,E=A+(v<<20&4294967295|v>>>12),v=_+(A^R&(E^A))+T[5]+3593408605&4294967295,_=E+(v<<5&4294967295|v>>>27),v=R+(E^A&(_^E))+T[10]+38016083&4294967295,R=_+(v<<9&4294967295|v>>>23),v=A+(_^E&(R^_))+T[15]+3634488961&4294967295,A=R+(v<<14&4294967295|v>>>18),v=E+(R^_&(A^R))+T[4]+3889429448&4294967295,E=A+(v<<20&4294967295|v>>>12),v=_+(A^R&(E^A))+T[9]+568446438&4294967295,_=E+(v<<5&4294967295|v>>>27),v=R+(E^A&(_^E))+T[14]+3275163606&4294967295,R=_+(v<<9&4294967295|v>>>23),v=A+(_^E&(R^_))+T[3]+4107603335&4294967295,A=R+(v<<14&4294967295|v>>>18),v=E+(R^_&(A^R))+T[8]+1163531501&4294967295,E=A+(v<<20&4294967295|v>>>12),v=_+(A^R&(E^A))+T[13]+2850285829&4294967295,_=E+(v<<5&4294967295|v>>>27),v=R+(E^A&(_^E))+T[2]+4243563512&4294967295,R=_+(v<<9&4294967295|v>>>23),v=A+(_^E&(R^_))+T[7]+1735328473&4294967295,A=R+(v<<14&4294967295|v>>>18),v=E+(R^_&(A^R))+T[12]+2368359562&4294967295,E=A+(v<<20&4294967295|v>>>12),v=_+(E^A^R)+T[5]+4294588738&4294967295,_=E+(v<<4&4294967295|v>>>28),v=R+(_^E^A)+T[8]+2272392833&4294967295,R=_+(v<<11&4294967295|v>>>21),v=A+(R^_^E)+T[11]+1839030562&4294967295,A=R+(v<<16&4294967295|v>>>16),v=E+(A^R^_)+T[14]+4259657740&4294967295,E=A+(v<<23&4294967295|v>>>9),v=_+(E^A^R)+T[1]+2763975236&4294967295,_=E+(v<<4&4294967295|v>>>28),v=R+(_^E^A)+T[4]+1272893353&4294967295,R=_+(v<<11&4294967295|v>>>21),v=A+(R^_^E)+T[7]+4139469664&4294967295,A=R+(v<<16&4294967295|v>>>16),v=E+(A^R^_)+T[10]+3200236656&4294967295,E=A+(v<<23&4294967295|v>>>9),v=_+(E^A^R)+T[13]+681279174&4294967295,_=E+(v<<4&4294967295|v>>>28),v=R+(_^E^A)+T[0]+3936430074&4294967295,R=_+(v<<11&4294967295|v>>>21),v=A+(R^_^E)+T[3]+3572445317&4294967295,A=R+(v<<16&4294967295|v>>>16),v=E+(A^R^_)+T[6]+76029189&4294967295,E=A+(v<<23&4294967295|v>>>9),v=_+(E^A^R)+T[9]+3654602809&4294967295,_=E+(v<<4&4294967295|v>>>28),v=R+(_^E^A)+T[12]+3873151461&4294967295,R=_+(v<<11&4294967295|v>>>21),v=A+(R^_^E)+T[15]+530742520&4294967295,A=R+(v<<16&4294967295|v>>>16),v=E+(A^R^_)+T[2]+3299628645&4294967295,E=A+(v<<23&4294967295|v>>>9),v=_+(A^(E|~R))+T[0]+4096336452&4294967295,_=E+(v<<6&4294967295|v>>>26),v=R+(E^(_|~A))+T[7]+1126891415&4294967295,R=_+(v<<10&4294967295|v>>>22),v=A+(_^(R|~E))+T[14]+2878612391&4294967295,A=R+(v<<15&4294967295|v>>>17),v=E+(R^(A|~_))+T[5]+4237533241&4294967295,E=A+(v<<21&4294967295|v>>>11),v=_+(A^(E|~R))+T[12]+1700485571&4294967295,_=E+(v<<6&4294967295|v>>>26),v=R+(E^(_|~A))+T[3]+2399980690&4294967295,R=_+(v<<10&4294967295|v>>>22),v=A+(_^(R|~E))+T[10]+4293915773&4294967295,A=R+(v<<15&4294967295|v>>>17),v=E+(R^(A|~_))+T[1]+2240044497&4294967295,E=A+(v<<21&4294967295|v>>>11),v=_+(A^(E|~R))+T[8]+1873313359&4294967295,_=E+(v<<6&4294967295|v>>>26),v=R+(E^(_|~A))+T[15]+4264355552&4294967295,R=_+(v<<10&4294967295|v>>>22),v=A+(_^(R|~E))+T[6]+2734768916&4294967295,A=R+(v<<15&4294967295|v>>>17),v=E+(R^(A|~_))+T[13]+1309151649&4294967295,E=A+(v<<21&4294967295|v>>>11),v=_+(A^(E|~R))+T[4]+4149444226&4294967295,_=E+(v<<6&4294967295|v>>>26),v=R+(E^(_|~A))+T[11]+3174756917&4294967295,R=_+(v<<10&4294967295|v>>>22),v=A+(_^(R|~E))+T[2]+718787259&4294967295,A=R+(v<<15&4294967295|v>>>17),v=E+(R^(A|~_))+T[9]+3951481745&4294967295,I.g[0]=I.g[0]+_&4294967295,I.g[1]=I.g[1]+(A+(v<<21&4294967295|v>>>11))&4294967295,I.g[2]=I.g[2]+A&4294967295,I.g[3]=I.g[3]+R&4294967295}r.prototype.u=function(I,_){_===void 0&&(_=I.length);for(var E=_-this.blockSize,T=this.B,A=this.h,R=0;R<_;){if(A==0)for(;R<=E;)i(this,I,R),R+=this.blockSize;if(typeof I=="string"){for(;R<_;)if(T[A++]=I.charCodeAt(R++),A==this.blockSize){i(this,T),A=0;break}}else for(;R<_;)if(T[A++]=I[R++],A==this.blockSize){i(this,T),A=0;break}}this.h=A,this.o+=_},r.prototype.v=function(){var I=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);I[0]=128;for(var _=1;_<I.length-8;++_)I[_]=0;var E=8*this.o;for(_=I.length-8;_<I.length;++_)I[_]=E&255,E/=256;for(this.u(I),I=Array(16),_=E=0;4>_;++_)for(var T=0;32>T;T+=8)I[E++]=this.g[_]>>>T&255;return I};function s(I,_){var E=a;return Object.prototype.hasOwnProperty.call(E,I)?E[I]:E[I]=_(I)}function o(I,_){this.h=_;for(var E=[],T=!0,A=I.length-1;0<=A;A--){var R=I[A]|0;T&&R==_||(E[A]=R,T=!1)}this.g=E}var a={};function c(I){return-128<=I&&128>I?s(I,function(_){return new o([_|0],0>_?-1:0)}):new o([I|0],0>I?-1:0)}function l(I){if(isNaN(I)||!isFinite(I))return p;if(0>I)return S(l(-I));for(var _=[],E=1,T=0;I>=E;T++)_[T]=I/E|0,E*=4294967296;return new o(_,0)}function d(I,_){if(I.length==0)throw Error("number format error: empty string");if(_=_||10,2>_||36<_)throw Error("radix out of range: "+_);if(I.charAt(0)=="-")return S(d(I.substring(1),_));if(0<=I.indexOf("-"))throw Error('number format error: interior "-" character');for(var E=l(Math.pow(_,8)),T=p,A=0;A<I.length;A+=8){var R=Math.min(8,I.length-A),v=parseInt(I.substring(A,A+R),_);8>R?(R=l(Math.pow(_,R)),T=T.j(R).add(l(v))):(T=T.j(E),T=T.add(l(v)))}return T}var p=c(0),m=c(1),w=c(16777216);n=o.prototype,n.m=function(){if(k(this))return-S(this).m();for(var I=0,_=1,E=0;E<this.g.length;E++){var T=this.i(E);I+=(0<=T?T:4294967296+T)*_,_*=4294967296}return I},n.toString=function(I){if(I=I||10,2>I||36<I)throw Error("radix out of range: "+I);if(D(this))return"0";if(k(this))return"-"+S(this).toString(I);for(var _=l(Math.pow(I,6)),E=this,T="";;){var A=U(E,_).g;E=x(E,A.j(_));var R=((0<E.g.length?E.g[0]:E.h)>>>0).toString(I);if(E=A,D(E))return R+T;for(;6>R.length;)R="0"+R;T=R+T}},n.i=function(I){return 0>I?0:I<this.g.length?this.g[I]:this.h};function D(I){if(I.h!=0)return!1;for(var _=0;_<I.g.length;_++)if(I.g[_]!=0)return!1;return!0}function k(I){return I.h==-1}n.l=function(I){return I=x(this,I),k(I)?-1:D(I)?0:1};function S(I){for(var _=I.g.length,E=[],T=0;T<_;T++)E[T]=~I.g[T];return new o(E,~I.h).add(m)}n.abs=function(){return k(this)?S(this):this},n.add=function(I){for(var _=Math.max(this.g.length,I.g.length),E=[],T=0,A=0;A<=_;A++){var R=T+(this.i(A)&65535)+(I.i(A)&65535),v=(R>>>16)+(this.i(A)>>>16)+(I.i(A)>>>16);T=v>>>16,R&=65535,v&=65535,E[A]=v<<16|R}return new o(E,E[E.length-1]&-2147483648?-1:0)};function x(I,_){return I.add(S(_))}n.j=function(I){if(D(this)||D(I))return p;if(k(this))return k(I)?S(this).j(S(I)):S(S(this).j(I));if(k(I))return S(this.j(S(I)));if(0>this.l(w)&&0>I.l(w))return l(this.m()*I.m());for(var _=this.g.length+I.g.length,E=[],T=0;T<2*_;T++)E[T]=0;for(T=0;T<this.g.length;T++)for(var A=0;A<I.g.length;A++){var R=this.i(T)>>>16,v=this.i(T)&65535,fn=I.i(A)>>>16,Ws=I.i(A)&65535;E[2*T+2*A]+=v*Ws,$(E,2*T+2*A),E[2*T+2*A+1]+=R*Ws,$(E,2*T+2*A+1),E[2*T+2*A+1]+=v*fn,$(E,2*T+2*A+1),E[2*T+2*A+2]+=R*fn,$(E,2*T+2*A+2)}for(T=0;T<_;T++)E[T]=E[2*T+1]<<16|E[2*T];for(T=_;T<2*_;T++)E[T]=0;return new o(E,0)};function $(I,_){for(;(I[_]&65535)!=I[_];)I[_+1]+=I[_]>>>16,I[_]&=65535,_++}function F(I,_){this.g=I,this.h=_}function U(I,_){if(D(_))throw Error("division by zero");if(D(I))return new F(p,p);if(k(I))return _=U(S(I),_),new F(S(_.g),S(_.h));if(k(_))return _=U(I,S(_)),new F(S(_.g),_.h);if(30<I.g.length){if(k(I)||k(_))throw Error("slowDivide_ only works with positive integers.");for(var E=m,T=_;0>=T.l(I);)E=J(E),T=J(T);var A=W(E,1),R=W(T,1);for(T=W(T,2),E=W(E,2);!D(T);){var v=R.add(T);0>=v.l(I)&&(A=A.add(E),R=v),T=W(T,1),E=W(E,1)}return _=x(I,A.j(_)),new F(A,_)}for(A=p;0<=I.l(_);){for(E=Math.max(1,Math.floor(I.m()/_.m())),T=Math.ceil(Math.log(E)/Math.LN2),T=48>=T?1:Math.pow(2,T-48),R=l(E),v=R.j(_);k(v)||0<v.l(I);)E-=T,R=l(E),v=R.j(_);D(R)&&(R=m),A=A.add(R),I=x(I,v)}return new F(A,I)}n.A=function(I){return U(this,I).h},n.and=function(I){for(var _=Math.max(this.g.length,I.g.length),E=[],T=0;T<_;T++)E[T]=this.i(T)&I.i(T);return new o(E,this.h&I.h)},n.or=function(I){for(var _=Math.max(this.g.length,I.g.length),E=[],T=0;T<_;T++)E[T]=this.i(T)|I.i(T);return new o(E,this.h|I.h)},n.xor=function(I){for(var _=Math.max(this.g.length,I.g.length),E=[],T=0;T<_;T++)E[T]=this.i(T)^I.i(T);return new o(E,this.h^I.h)};function J(I){for(var _=I.g.length+1,E=[],T=0;T<_;T++)E[T]=I.i(T)<<1|I.i(T-1)>>>31;return new o(E,I.h)}function W(I,_){var E=_>>5;_%=32;for(var T=I.g.length-E,A=[],R=0;R<T;R++)A[R]=0<_?I.i(R+E)>>>_|I.i(R+E+1)<<32-_:I.i(R+E);return new o(A,I.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,Ip=OI.Md5=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=l,o.fromString=d,pr=OI.Integer=o}).apply(typeof kI<"u"?kI:typeof self<"u"?self:typeof window<"u"?window:{});var Uc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Mn={};var Tp,Ap,is,bp,la,Bc,Dp,Sp,Rp;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(u,h,f){return u==Array.prototype||u==Object.prototype||(u[h]=f.value),u};function t(u){u=[typeof globalThis=="object"&&globalThis,u,typeof window=="object"&&window,typeof self=="object"&&self,typeof Uc=="object"&&Uc];for(var h=0;h<u.length;++h){var f=u[h];if(f&&f.Math==Math)return f}throw Error("Cannot find global object")}var r=t(this);function i(u,h){if(h)e:{var f=r;u=u.split(".");for(var g=0;g<u.length-1;g++){var b=u[g];if(!(b in f))break e;f=f[b]}u=u[u.length-1],g=f[u],h=h(g),h!=g&&h!=null&&e(f,u,{configurable:!0,writable:!0,value:h})}}function s(u,h){u instanceof String&&(u+="");var f=0,g=!1,b={next:function(){if(!g&&f<u.length){var N=f++;return{value:h(N,u[N]),done:!1}}return g=!0,{done:!0,value:void 0}}};return b[Symbol.iterator]=function(){return b},b}i("Array.prototype.values",function(u){return u||function(){return s(this,function(h,f){return f})}});var o=o||{},a=this||self;function c(u){var h=typeof u;return h=h!="object"?h:u?Array.isArray(u)?"array":h:"null",h=="array"||h=="object"&&typeof u.length=="number"}function l(u){var h=typeof u;return h=="object"&&u!=null||h=="function"}function d(u,h,f){return u.call.apply(u.bind,arguments)}function p(u,h,f){if(!u)throw Error();if(2<arguments.length){var g=Array.prototype.slice.call(arguments,2);return function(){var b=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(b,g),u.apply(h,b)}}return function(){return u.apply(h,arguments)}}function m(u,h,f){return m=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?d:p,m.apply(null,arguments)}function w(u,h){var f=Array.prototype.slice.call(arguments,1);return function(){var g=f.slice();return g.push.apply(g,arguments),u.apply(this,g)}}function D(u,h){function f(){}f.prototype=h.prototype,u.aa=h.prototype,u.prototype=new f,u.prototype.constructor=u,u.Qb=function(g,b,N){for(var L=Array(arguments.length-2),me=2;me<arguments.length;me++)L[me-2]=arguments[me];return h.prototype[b].apply(g,L)}}function k(u){let h=u.length;if(0<h){let f=Array(h);for(let g=0;g<h;g++)f[g]=u[g];return f}return[]}function S(u,h){for(let f=1;f<arguments.length;f++){let g=arguments[f];if(c(g)){let b=u.length||0,N=g.length||0;u.length=b+N;for(let L=0;L<N;L++)u[b+L]=g[L]}else u.push(g)}}class x{constructor(h,f){this.i=h,this.j=f,this.h=0,this.g=null}get(){let h;return 0<this.h?(this.h--,h=this.g,this.g=h.next,h.next=null):h=this.i(),h}}function $(u){return/^[\s\xa0]*$/.test(u)}function F(){var u=a.navigator;return u&&(u=u.userAgent)?u:""}function U(u){return U[" "](u),u}U[" "]=function(){};var J=F().indexOf("Gecko")!=-1&&!(F().toLowerCase().indexOf("webkit")!=-1&&F().indexOf("Edge")==-1)&&!(F().indexOf("Trident")!=-1||F().indexOf("MSIE")!=-1)&&F().indexOf("Edge")==-1;function W(u,h,f){for(let g in u)h.call(f,u[g],g,u)}function I(u,h){for(let f in u)h.call(void 0,u[f],f,u)}function _(u){let h={};for(let f in u)h[f]=u[f];return h}let E="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function T(u,h){let f,g;for(let b=1;b<arguments.length;b++){g=arguments[b];for(f in g)u[f]=g[f];for(let N=0;N<E.length;N++)f=E[N],Object.prototype.hasOwnProperty.call(g,f)&&(u[f]=g[f])}}function A(u){var h=1;u=u.split(":");let f=[];for(;0<h&&u.length;)f.push(u.shift()),h--;return u.length&&f.push(u.join(":")),f}function R(u){a.setTimeout(()=>{throw u},0)}function v(){var u=ah;let h=null;return u.g&&(h=u.g,u.g=u.g.next,u.g||(u.h=null),h.next=null),h}class fn{constructor(){this.h=this.g=null}add(h,f){let g=Ws.get();g.set(h,f),this.h?this.h.next=g:this.g=g,this.h=g}}var Ws=new x(()=>new pb,u=>u.reset());class pb{constructor(){this.next=this.g=this.h=null}set(h,f){this.h=h,this.g=f,this.next=null}reset(){this.next=this.g=this.h=null}}let Hs,Ks=!1,ah=new fn,Sy=()=>{let u=a.Promise.resolve(void 0);Hs=()=>{u.then(gb)}};var gb=()=>{for(var u;u=v();){try{u.h.call(u.g)}catch(f){R(f)}var h=Ws;h.j(u),100>h.h&&(h.h++,u.next=h.g,h.g=u)}Ks=!1};function zn(){this.s=this.s,this.C=this.C}zn.prototype.s=!1,zn.prototype.ma=function(){this.s||(this.s=!0,this.N())},zn.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function nt(u,h){this.type=u,this.g=this.target=h,this.defaultPrevented=!1}nt.prototype.h=function(){this.defaultPrevented=!0};var mb=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var u=!1,h=Object.defineProperty({},"passive",{get:function(){u=!0}});try{let f=()=>{};a.addEventListener("test",f,h),a.removeEventListener("test",f,h)}catch{}return u}();function Qs(u,h){if(nt.call(this,u?u.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,u){var f=this.type=u.type,g=u.changedTouches&&u.changedTouches.length?u.changedTouches[0]:null;if(this.target=u.target||u.srcElement,this.g=h,h=u.relatedTarget){if(J){e:{try{U(h.nodeName);var b=!0;break e}catch{}b=!1}b||(h=null)}}else f=="mouseover"?h=u.fromElement:f=="mouseout"&&(h=u.toElement);this.relatedTarget=h,g?(this.clientX=g.clientX!==void 0?g.clientX:g.pageX,this.clientY=g.clientY!==void 0?g.clientY:g.pageY,this.screenX=g.screenX||0,this.screenY=g.screenY||0):(this.clientX=u.clientX!==void 0?u.clientX:u.pageX,this.clientY=u.clientY!==void 0?u.clientY:u.pageY,this.screenX=u.screenX||0,this.screenY=u.screenY||0),this.button=u.button,this.key=u.key||"",this.ctrlKey=u.ctrlKey,this.altKey=u.altKey,this.shiftKey=u.shiftKey,this.metaKey=u.metaKey,this.pointerId=u.pointerId||0,this.pointerType=typeof u.pointerType=="string"?u.pointerType:yb[u.pointerType]||"",this.state=u.state,this.i=u,u.defaultPrevented&&Qs.aa.h.call(this)}}D(Qs,nt);var yb={2:"touch",3:"pen",4:"mouse"};Qs.prototype.h=function(){Qs.aa.h.call(this);var u=this.i;u.preventDefault?u.preventDefault():u.returnValue=!1};var Ys="closure_listenable_"+(1e6*Math.random()|0),_b=0;function vb(u,h,f,g,b){this.listener=u,this.proxy=null,this.src=h,this.type=f,this.capture=!!g,this.ha=b,this.key=++_b,this.da=this.fa=!1}function su(u){u.da=!0,u.listener=null,u.proxy=null,u.src=null,u.ha=null}function ou(u){this.src=u,this.g={},this.h=0}ou.prototype.add=function(u,h,f,g,b){var N=u.toString();u=this.g[N],u||(u=this.g[N]=[],this.h++);var L=ch(u,h,g,b);return-1<L?(h=u[L],f||(h.fa=!1)):(h=new vb(h,this.src,N,!!g,b),h.fa=f,u.push(h)),h};function uh(u,h){var f=h.type;if(f in u.g){var g=u.g[f],b=Array.prototype.indexOf.call(g,h,void 0),N;(N=0<=b)&&Array.prototype.splice.call(g,b,1),N&&(su(h),u.g[f].length==0&&(delete u.g[f],u.h--))}}function ch(u,h,f,g){for(var b=0;b<u.length;++b){var N=u[b];if(!N.da&&N.listener==h&&N.capture==!!f&&N.ha==g)return b}return-1}var lh="closure_lm_"+(1e6*Math.random()|0),hh={};function Ry(u,h,f,g,b){if(g&&g.once)return Py(u,h,f,g,b);if(Array.isArray(h)){for(var N=0;N<h.length;N++)Ry(u,h[N],f,g,b);return null}return f=gh(f),u&&u[Ys]?u.K(h,f,l(g)?!!g.capture:!!g,b):Cy(u,h,f,!1,g,b)}function Cy(u,h,f,g,b,N){if(!h)throw Error("Invalid event type");var L=l(b)?!!b.capture:!!b,me=fh(u);if(me||(u[lh]=me=new ou(u)),f=me.add(h,f,g,L,N),f.proxy)return f;if(g=wb(),f.proxy=g,g.src=u,g.listener=f,u.addEventListener)mb||(b=L),b===void 0&&(b=!1),u.addEventListener(h.toString(),g,b);else if(u.attachEvent)u.attachEvent(ky(h.toString()),g);else if(u.addListener&&u.removeListener)u.addListener(g);else throw Error("addEventListener and attachEvent are unavailable.");return f}function wb(){function u(f){return h.call(u.src,u.listener,f)}let h=Eb;return u}function Py(u,h,f,g,b){if(Array.isArray(h)){for(var N=0;N<h.length;N++)Py(u,h[N],f,g,b);return null}return f=gh(f),u&&u[Ys]?u.L(h,f,l(g)?!!g.capture:!!g,b):Cy(u,h,f,!0,g,b)}function Ny(u,h,f,g,b){if(Array.isArray(h))for(var N=0;N<h.length;N++)Ny(u,h[N],f,g,b);else g=l(g)?!!g.capture:!!g,f=gh(f),u&&u[Ys]?(u=u.i,h=String(h).toString(),h in u.g&&(N=u.g[h],f=ch(N,f,g,b),-1<f&&(su(N[f]),Array.prototype.splice.call(N,f,1),N.length==0&&(delete u.g[h],u.h--)))):u&&(u=fh(u))&&(h=u.g[h.toString()],u=-1,h&&(u=ch(h,f,g,b)),(f=-1<u?h[u]:null)&&dh(f))}function dh(u){if(typeof u!="number"&&u&&!u.da){var h=u.src;if(h&&h[Ys])uh(h.i,u);else{var f=u.type,g=u.proxy;h.removeEventListener?h.removeEventListener(f,g,u.capture):h.detachEvent?h.detachEvent(ky(f),g):h.addListener&&h.removeListener&&h.removeListener(g),(f=fh(h))?(uh(f,u),f.h==0&&(f.src=null,h[lh]=null)):su(u)}}}function ky(u){return u in hh?hh[u]:hh[u]="on"+u}function Eb(u,h){if(u.da)u=!0;else{h=new Qs(h,this);var f=u.listener,g=u.ha||u.src;u.fa&&dh(u),u=f.call(g,h)}return u}function fh(u){return u=u[lh],u instanceof ou?u:null}var ph="__closure_events_fn_"+(1e9*Math.random()>>>0);function gh(u){return typeof u=="function"?u:(u[ph]||(u[ph]=function(h){return u.handleEvent(h)}),u[ph])}function rt(){zn.call(this),this.i=new ou(this),this.M=this,this.F=null}D(rt,zn),rt.prototype[Ys]=!0,rt.prototype.removeEventListener=function(u,h,f,g){Ny(this,u,h,f,g)};function lt(u,h){var f,g=u.F;if(g)for(f=[];g;g=g.F)f.push(g);if(u=u.M,g=h.type||h,typeof h=="string")h=new nt(h,u);else if(h instanceof nt)h.target=h.target||u;else{var b=h;h=new nt(g,u),T(h,b)}if(b=!0,f)for(var N=f.length-1;0<=N;N--){var L=h.g=f[N];b=au(L,g,!0,h)&&b}if(L=h.g=u,b=au(L,g,!0,h)&&b,b=au(L,g,!1,h)&&b,f)for(N=0;N<f.length;N++)L=h.g=f[N],b=au(L,g,!1,h)&&b}rt.prototype.N=function(){if(rt.aa.N.call(this),this.i){var u=this.i,h;for(h in u.g){for(var f=u.g[h],g=0;g<f.length;g++)su(f[g]);delete u.g[h],u.h--}}this.F=null},rt.prototype.K=function(u,h,f,g){return this.i.add(String(u),h,!1,f,g)},rt.prototype.L=function(u,h,f,g){return this.i.add(String(u),h,!0,f,g)};function au(u,h,f,g){if(h=u.i.g[String(h)],!h)return!0;h=h.concat();for(var b=!0,N=0;N<h.length;++N){var L=h[N];if(L&&!L.da&&L.capture==f){var me=L.listener,Xe=L.ha||L.src;L.fa&&uh(u.i,L),b=me.call(Xe,g)!==!1&&b}}return b&&!g.defaultPrevented}function Oy(u,h,f){if(typeof u=="function")f&&(u=m(u,f));else if(u&&typeof u.handleEvent=="function")u=m(u.handleEvent,u);else throw Error("Invalid listener argument");return 2147483647<Number(h)?-1:a.setTimeout(u,h||0)}function My(u){u.g=Oy(()=>{u.g=null,u.i&&(u.i=!1,My(u))},u.l);let h=u.h;u.h=null,u.m.apply(null,h)}class Ib extends zn{constructor(h,f){super(),this.m=h,this.l=f,this.h=null,this.i=!1,this.g=null}j(h){this.h=arguments,this.g?this.i=!0:My(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Js(u){zn.call(this),this.h=u,this.g={}}D(Js,zn);var xy=[];function Fy(u){W(u.g,function(h,f){this.g.hasOwnProperty(f)&&dh(h)},u),u.g={}}Js.prototype.N=function(){Js.aa.N.call(this),Fy(this)},Js.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var mh=a.JSON.stringify,Tb=a.JSON.parse,Ab=class{stringify(u){return a.JSON.stringify(u,void 0)}parse(u){return a.JSON.parse(u,void 0)}};function yh(){}yh.prototype.h=null;function Ly(u){return u.h||(u.h=u.i())}function Vy(){}var Xs={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function _h(){nt.call(this,"d")}D(_h,nt);function vh(){nt.call(this,"c")}D(vh,nt);var xr={},Uy=null;function uu(){return Uy=Uy||new rt}xr.La="serverreachability";function By(u){nt.call(this,xr.La,u)}D(By,nt);function Zs(u){let h=uu();lt(h,new By(h))}xr.STAT_EVENT="statevent";function $y(u,h){nt.call(this,xr.STAT_EVENT,u),this.stat=h}D($y,nt);function ht(u){let h=uu();lt(h,new $y(h,u))}xr.Ma="timingevent";function jy(u,h){nt.call(this,xr.Ma,u),this.size=h}D(jy,nt);function eo(u,h){if(typeof u!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){u()},h)}function to(){this.g=!0}to.prototype.xa=function(){this.g=!1};function bb(u,h,f,g,b,N){u.info(function(){if(u.g)if(N)for(var L="",me=N.split("&"),Xe=0;Xe<me.length;Xe++){var ue=me[Xe].split("=");if(1<ue.length){var it=ue[0];ue=ue[1];var st=it.split("_");L=2<=st.length&&st[1]=="type"?L+(it+"="+ue+"&"):L+(it+"=redacted&")}}else L=null;else L=N;return"XMLHTTP REQ ("+g+") [attempt "+b+"]: "+h+`
`+f+`
`+L})}function Db(u,h,f,g,b,N,L){u.info(function(){return"XMLHTTP RESP ("+g+") [ attempt "+b+"]: "+h+`
`+f+`
`+N+" "+L})}function Ei(u,h,f,g){u.info(function(){return"XMLHTTP TEXT ("+h+"): "+Rb(u,f)+(g?" "+g:"")})}function Sb(u,h){u.info(function(){return"TIMEOUT: "+h})}to.prototype.info=function(){};function Rb(u,h){if(!u.g)return h;if(!h)return null;try{var f=JSON.parse(h);if(f){for(u=0;u<f.length;u++)if(Array.isArray(f[u])){var g=f[u];if(!(2>g.length)){var b=g[1];if(Array.isArray(b)&&!(1>b.length)){var N=b[0];if(N!="noop"&&N!="stop"&&N!="close")for(var L=1;L<b.length;L++)b[L]=""}}}}return mh(f)}catch{return h}}var cu={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},zy={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},wh;function lu(){}D(lu,yh),lu.prototype.g=function(){return new XMLHttpRequest},lu.prototype.i=function(){return{}},wh=new lu;function qn(u,h,f,g){this.j=u,this.i=h,this.l=f,this.R=g||1,this.U=new Js(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new qy}function qy(){this.i=null,this.g="",this.h=!1}var Gy={},Eh={};function Ih(u,h,f){u.L=1,u.v=pu(pn(h)),u.m=f,u.P=!0,Wy(u,null)}function Wy(u,h){u.F=Date.now(),hu(u),u.A=pn(u.v);var f=u.A,g=u.R;Array.isArray(g)||(g=[String(g)]),o_(f.i,"t",g),u.C=0,f=u.j.J,u.h=new qy,u.g=A_(u.j,f?h:null,!u.m),0<u.O&&(u.M=new Ib(m(u.Y,u,u.g),u.O)),h=u.U,f=u.g,g=u.ca;var b="readystatechange";Array.isArray(b)||(b&&(xy[0]=b.toString()),b=xy);for(var N=0;N<b.length;N++){var L=Ry(f,b[N],g||h.handleEvent,!1,h.h||h);if(!L)break;h.g[L.key]=L}h=u.H?_(u.H):{},u.m?(u.u||(u.u="POST"),h["Content-Type"]="application/x-www-form-urlencoded",u.g.ea(u.A,u.u,u.m,h)):(u.u="GET",u.g.ea(u.A,u.u,null,h)),Zs(),bb(u.i,u.u,u.A,u.l,u.R,u.m)}qn.prototype.ca=function(u){u=u.target;let h=this.M;h&&gn(u)==3?h.j():this.Y(u)},qn.prototype.Y=function(u){try{if(u==this.g)e:{let st=gn(this.g);var h=this.g.Ba();let Ai=this.g.Z();if(!(3>st)&&(st!=3||this.g&&(this.h.h||this.g.oa()||f_(this.g)))){this.J||st!=4||h==7||(h==8||0>=Ai?Zs(3):Zs(2)),Th(this);var f=this.g.Z();this.X=f;t:if(Hy(this)){var g=f_(this.g);u="";var b=g.length,N=gn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Fr(this),no(this);var L="";break t}this.h.i=new a.TextDecoder}for(h=0;h<b;h++)this.h.h=!0,u+=this.h.i.decode(g[h],{stream:!(N&&h==b-1)});g.length=0,this.h.g+=u,this.C=0,L=this.h.g}else L=this.g.oa();if(this.o=f==200,Db(this.i,this.u,this.A,this.l,this.R,st,f),this.o){if(this.T&&!this.K){t:{if(this.g){var me,Xe=this.g;if((me=Xe.g?Xe.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!$(me)){var ue=me;break t}}ue=null}if(f=ue)Ei(this.i,this.l,f,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Ah(this,f);else{this.o=!1,this.s=3,ht(12),Fr(this),no(this);break e}}if(this.P){f=!0;let Lt;for(;!this.J&&this.C<L.length;)if(Lt=Cb(this,L),Lt==Eh){st==4&&(this.s=4,ht(14),f=!1),Ei(this.i,this.l,null,"[Incomplete Response]");break}else if(Lt==Gy){this.s=4,ht(15),Ei(this.i,this.l,L,"[Invalid Chunk]"),f=!1;break}else Ei(this.i,this.l,Lt,null),Ah(this,Lt);if(Hy(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),st!=4||L.length!=0||this.h.h||(this.s=1,ht(16),f=!1),this.o=this.o&&f,!f)Ei(this.i,this.l,L,"[Invalid Chunked Response]"),Fr(this),no(this);else if(0<L.length&&!this.W){this.W=!0;var it=this.j;it.g==this&&it.ba&&!it.M&&(it.j.info("Great, no buffering proxy detected. Bytes received: "+L.length),Ph(it),it.M=!0,ht(11))}}else Ei(this.i,this.l,L,null),Ah(this,L);st==4&&Fr(this),this.o&&!this.J&&(st==4?w_(this.j,this):(this.o=!1,hu(this)))}else Wb(this.g),f==400&&0<L.indexOf("Unknown SID")?(this.s=3,ht(12)):(this.s=0,ht(13)),Fr(this),no(this)}}}catch{}finally{}};function Hy(u){return u.g?u.u=="GET"&&u.L!=2&&u.j.Ca:!1}function Cb(u,h){var f=u.C,g=h.indexOf(`
`,f);return g==-1?Eh:(f=Number(h.substring(f,g)),isNaN(f)?Gy:(g+=1,g+f>h.length?Eh:(h=h.slice(g,g+f),u.C=g+f,h)))}qn.prototype.cancel=function(){this.J=!0,Fr(this)};function hu(u){u.S=Date.now()+u.I,Ky(u,u.I)}function Ky(u,h){if(u.B!=null)throw Error("WatchDog timer not null");u.B=eo(m(u.ba,u),h)}function Th(u){u.B&&(a.clearTimeout(u.B),u.B=null)}qn.prototype.ba=function(){this.B=null;let u=Date.now();0<=u-this.S?(Sb(this.i,this.A),this.L!=2&&(Zs(),ht(17)),Fr(this),this.s=2,no(this)):Ky(this,this.S-u)};function no(u){u.j.G==0||u.J||w_(u.j,u)}function Fr(u){Th(u);var h=u.M;h&&typeof h.ma=="function"&&h.ma(),u.M=null,Fy(u.U),u.g&&(h=u.g,u.g=null,h.abort(),h.ma())}function Ah(u,h){try{var f=u.j;if(f.G!=0&&(f.g==u||bh(f.h,u))){if(!u.K&&bh(f.h,u)&&f.G==3){try{var g=f.Da.g.parse(h)}catch{g=null}if(Array.isArray(g)&&g.length==3){var b=g;if(b[0]==0){e:if(!f.u){if(f.g)if(f.g.F+3e3<u.F)vu(f),yu(f);else break e;Ch(f),ht(18)}}else f.za=b[1],0<f.za-f.T&&37500>b[2]&&f.F&&f.v==0&&!f.C&&(f.C=eo(m(f.Za,f),6e3));if(1>=Jy(f.h)&&f.ca){try{f.ca()}catch{}f.ca=void 0}}else Vr(f,11)}else if((u.K||f.g==u)&&vu(f),!$(h))for(b=f.Da.g.parse(h),h=0;h<b.length;h++){let ue=b[h];if(f.T=ue[0],ue=ue[1],f.G==2)if(ue[0]=="c"){f.K=ue[1],f.ia=ue[2];let it=ue[3];it!=null&&(f.la=it,f.j.info("VER="+f.la));let st=ue[4];st!=null&&(f.Aa=st,f.j.info("SVER="+f.Aa));let Ai=ue[5];Ai!=null&&typeof Ai=="number"&&0<Ai&&(g=1.5*Ai,f.L=g,f.j.info("backChannelRequestTimeoutMs_="+g)),g=f;let Lt=u.g;if(Lt){let Eu=Lt.g?Lt.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Eu){var N=g.h;N.g||Eu.indexOf("spdy")==-1&&Eu.indexOf("quic")==-1&&Eu.indexOf("h2")==-1||(N.j=N.l,N.g=new Set,N.h&&(Dh(N,N.h),N.h=null))}if(g.D){let Nh=Lt.g?Lt.g.getResponseHeader("X-HTTP-Session-Id"):null;Nh&&(g.ya=Nh,Ie(g.I,g.D,Nh))}}f.G=3,f.l&&f.l.ua(),f.ba&&(f.R=Date.now()-u.F,f.j.info("Handshake RTT: "+f.R+"ms")),g=f;var L=u;if(g.qa=T_(g,g.J?g.ia:null,g.W),L.K){Xy(g.h,L);var me=L,Xe=g.L;Xe&&(me.I=Xe),me.B&&(Th(me),hu(me)),g.g=L}else __(g);0<f.i.length&&_u(f)}else ue[0]!="stop"&&ue[0]!="close"||Vr(f,7);else f.G==3&&(ue[0]=="stop"||ue[0]=="close"?ue[0]=="stop"?Vr(f,7):Rh(f):ue[0]!="noop"&&f.l&&f.l.ta(ue),f.v=0)}}Zs(4)}catch{}}var Pb=class{constructor(u,h){this.g=u,this.map=h}};function Qy(u){this.l=u||10,a.PerformanceNavigationTiming?(u=a.performance.getEntriesByType("navigation"),u=0<u.length&&(u[0].nextHopProtocol=="hq"||u[0].nextHopProtocol=="h2")):u=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=u?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Yy(u){return u.h?!0:u.g?u.g.size>=u.j:!1}function Jy(u){return u.h?1:u.g?u.g.size:0}function bh(u,h){return u.h?u.h==h:u.g?u.g.has(h):!1}function Dh(u,h){u.g?u.g.add(h):u.h=h}function Xy(u,h){u.h&&u.h==h?u.h=null:u.g&&u.g.has(h)&&u.g.delete(h)}Qy.prototype.cancel=function(){if(this.i=Zy(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let u of this.g.values())u.cancel();this.g.clear()}};function Zy(u){if(u.h!=null)return u.i.concat(u.h.D);if(u.g!=null&&u.g.size!==0){let h=u.i;for(let f of u.g.values())h=h.concat(f.D);return h}return k(u.i)}function Nb(u){if(u.V&&typeof u.V=="function")return u.V();if(typeof Map<"u"&&u instanceof Map||typeof Set<"u"&&u instanceof Set)return Array.from(u.values());if(typeof u=="string")return u.split("");if(c(u)){for(var h=[],f=u.length,g=0;g<f;g++)h.push(u[g]);return h}h=[],f=0;for(g in u)h[f++]=u[g];return h}function kb(u){if(u.na&&typeof u.na=="function")return u.na();if(!u.V||typeof u.V!="function"){if(typeof Map<"u"&&u instanceof Map)return Array.from(u.keys());if(!(typeof Set<"u"&&u instanceof Set)){if(c(u)||typeof u=="string"){var h=[];u=u.length;for(var f=0;f<u;f++)h.push(f);return h}h=[],f=0;for(let g in u)h[f++]=g;return h}}}function e_(u,h){if(u.forEach&&typeof u.forEach=="function")u.forEach(h,void 0);else if(c(u)||typeof u=="string")Array.prototype.forEach.call(u,h,void 0);else for(var f=kb(u),g=Nb(u),b=g.length,N=0;N<b;N++)h.call(void 0,g[N],f&&f[N],u)}var t_=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Ob(u,h){if(u){u=u.split("&");for(var f=0;f<u.length;f++){var g=u[f].indexOf("="),b=null;if(0<=g){var N=u[f].substring(0,g);b=u[f].substring(g+1)}else N=u[f];h(N,b?decodeURIComponent(b.replace(/\+/g," ")):"")}}}function Lr(u){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,u instanceof Lr){this.h=u.h,du(this,u.j),this.o=u.o,this.g=u.g,fu(this,u.s),this.l=u.l;var h=u.i,f=new so;f.i=h.i,h.g&&(f.g=new Map(h.g),f.h=h.h),n_(this,f),this.m=u.m}else u&&(h=String(u).match(t_))?(this.h=!1,du(this,h[1]||"",!0),this.o=ro(h[2]||""),this.g=ro(h[3]||"",!0),fu(this,h[4]),this.l=ro(h[5]||"",!0),n_(this,h[6]||"",!0),this.m=ro(h[7]||"")):(this.h=!1,this.i=new so(null,this.h))}Lr.prototype.toString=function(){var u=[],h=this.j;h&&u.push(io(h,r_,!0),":");var f=this.g;return(f||h=="file")&&(u.push("//"),(h=this.o)&&u.push(io(h,r_,!0),"@"),u.push(encodeURIComponent(String(f)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),f=this.s,f!=null&&u.push(":",String(f))),(f=this.l)&&(this.g&&f.charAt(0)!="/"&&u.push("/"),u.push(io(f,f.charAt(0)=="/"?Fb:xb,!0))),(f=this.i.toString())&&u.push("?",f),(f=this.m)&&u.push("#",io(f,Vb)),u.join("")};function pn(u){return new Lr(u)}function du(u,h,f){u.j=f?ro(h,!0):h,u.j&&(u.j=u.j.replace(/:$/,""))}function fu(u,h){if(h){if(h=Number(h),isNaN(h)||0>h)throw Error("Bad port number "+h);u.s=h}else u.s=null}function n_(u,h,f){h instanceof so?(u.i=h,Ub(u.i,u.h)):(f||(h=io(h,Lb)),u.i=new so(h,u.h))}function Ie(u,h,f){u.i.set(h,f)}function pu(u){return Ie(u,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),u}function ro(u,h){return u?h?decodeURI(u.replace(/%25/g,"%2525")):decodeURIComponent(u):""}function io(u,h,f){return typeof u=="string"?(u=encodeURI(u).replace(h,Mb),f&&(u=u.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),u):null}function Mb(u){return u=u.charCodeAt(0),"%"+(u>>4&15).toString(16)+(u&15).toString(16)}var r_=/[#\/\?@]/g,xb=/[#\?:]/g,Fb=/[#\?]/g,Lb=/[#\?@]/g,Vb=/#/g;function so(u,h){this.h=this.g=null,this.i=u||null,this.j=!!h}function Gn(u){u.g||(u.g=new Map,u.h=0,u.i&&Ob(u.i,function(h,f){u.add(decodeURIComponent(h.replace(/\+/g," ")),f)}))}n=so.prototype,n.add=function(u,h){Gn(this),this.i=null,u=Ii(this,u);var f=this.g.get(u);return f||this.g.set(u,f=[]),f.push(h),this.h+=1,this};function i_(u,h){Gn(u),h=Ii(u,h),u.g.has(h)&&(u.i=null,u.h-=u.g.get(h).length,u.g.delete(h))}function s_(u,h){return Gn(u),h=Ii(u,h),u.g.has(h)}n.forEach=function(u,h){Gn(this),this.g.forEach(function(f,g){f.forEach(function(b){u.call(h,b,g,this)},this)},this)},n.na=function(){Gn(this);let u=Array.from(this.g.values()),h=Array.from(this.g.keys()),f=[];for(let g=0;g<h.length;g++){let b=u[g];for(let N=0;N<b.length;N++)f.push(h[g])}return f},n.V=function(u){Gn(this);let h=[];if(typeof u=="string")s_(this,u)&&(h=h.concat(this.g.get(Ii(this,u))));else{u=Array.from(this.g.values());for(let f=0;f<u.length;f++)h=h.concat(u[f])}return h},n.set=function(u,h){return Gn(this),this.i=null,u=Ii(this,u),s_(this,u)&&(this.h-=this.g.get(u).length),this.g.set(u,[h]),this.h+=1,this},n.get=function(u,h){return u?(u=this.V(u),0<u.length?String(u[0]):h):h};function o_(u,h,f){i_(u,h),0<f.length&&(u.i=null,u.g.set(Ii(u,h),k(f)),u.h+=f.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";let u=[],h=Array.from(this.g.keys());for(var f=0;f<h.length;f++){var g=h[f];let N=encodeURIComponent(String(g)),L=this.V(g);for(g=0;g<L.length;g++){var b=N;L[g]!==""&&(b+="="+encodeURIComponent(String(L[g]))),u.push(b)}}return this.i=u.join("&")};function Ii(u,h){return h=String(h),u.j&&(h=h.toLowerCase()),h}function Ub(u,h){h&&!u.j&&(Gn(u),u.i=null,u.g.forEach(function(f,g){var b=g.toLowerCase();g!=b&&(i_(this,g),o_(this,b,f))},u)),u.j=h}function Bb(u,h){let f=new to;if(a.Image){let g=new Image;g.onload=w(Wn,f,"TestLoadImage: loaded",!0,h,g),g.onerror=w(Wn,f,"TestLoadImage: error",!1,h,g),g.onabort=w(Wn,f,"TestLoadImage: abort",!1,h,g),g.ontimeout=w(Wn,f,"TestLoadImage: timeout",!1,h,g),a.setTimeout(function(){g.ontimeout&&g.ontimeout()},1e4),g.src=u}else h(!1)}function $b(u,h){let f=new to,g=new AbortController,b=setTimeout(()=>{g.abort(),Wn(f,"TestPingServer: timeout",!1,h)},1e4);fetch(u,{signal:g.signal}).then(N=>{clearTimeout(b),N.ok?Wn(f,"TestPingServer: ok",!0,h):Wn(f,"TestPingServer: server error",!1,h)}).catch(()=>{clearTimeout(b),Wn(f,"TestPingServer: error",!1,h)})}function Wn(u,h,f,g,b){try{b&&(b.onload=null,b.onerror=null,b.onabort=null,b.ontimeout=null),g(f)}catch{}}function jb(){this.g=new Ab}function zb(u,h,f){let g=f||"";try{e_(u,function(b,N){let L=b;l(b)&&(L=mh(b)),h.push(g+N+"="+encodeURIComponent(L))})}catch(b){throw h.push(g+"type="+encodeURIComponent("_badmap")),b}}function oo(u){this.l=u.Ub||null,this.j=u.eb||!1}D(oo,yh),oo.prototype.g=function(){return new gu(this.l,this.j)},oo.prototype.i=function(u){return function(){return u}}({});function gu(u,h){rt.call(this),this.D=u,this.o=h,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}D(gu,rt),n=gu.prototype,n.open=function(u,h){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=u,this.A=h,this.readyState=1,uo(this)},n.send=function(u){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let h={headers:this.u,method:this.B,credentials:this.m,cache:void 0};u&&(h.body=u),(this.D||a).fetch(new Request(this.A,h)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,ao(this)),this.readyState=0},n.Sa=function(u){if(this.g&&(this.l=u,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=u.headers,this.readyState=2,uo(this)),this.g&&(this.readyState=3,uo(this),this.g)))if(this.responseType==="arraybuffer")u.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in u){if(this.j=u.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;a_(this)}else u.text().then(this.Ra.bind(this),this.ga.bind(this))};function a_(u){u.j.read().then(u.Pa.bind(u)).catch(u.ga.bind(u))}n.Pa=function(u){if(this.g){if(this.o&&u.value)this.response.push(u.value);else if(!this.o){var h=u.value?u.value:new Uint8Array(0);(h=this.v.decode(h,{stream:!u.done}))&&(this.response=this.responseText+=h)}u.done?ao(this):uo(this),this.readyState==3&&a_(this)}},n.Ra=function(u){this.g&&(this.response=this.responseText=u,ao(this))},n.Qa=function(u){this.g&&(this.response=u,ao(this))},n.ga=function(){this.g&&ao(this)};function ao(u){u.readyState=4,u.l=null,u.j=null,u.v=null,uo(u)}n.setRequestHeader=function(u,h){this.u.append(u,h)},n.getResponseHeader=function(u){return this.h&&this.h.get(u.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";let u=[],h=this.h.entries();for(var f=h.next();!f.done;)f=f.value,u.push(f[0]+": "+f[1]),f=h.next();return u.join(`\r
`)};function uo(u){u.onreadystatechange&&u.onreadystatechange.call(u)}Object.defineProperty(gu.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(u){this.m=u?"include":"same-origin"}});function u_(u){let h="";return W(u,function(f,g){h+=g,h+=":",h+=f,h+=`\r
`}),h}function Sh(u,h,f){e:{for(g in f){var g=!1;break e}g=!0}g||(f=u_(f),typeof u=="string"?f!=null&&encodeURIComponent(String(f)):Ie(u,h,f))}function Se(u){rt.call(this),this.headers=new Map,this.o=u||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}D(Se,rt);var qb=/^https?$/i,Gb=["POST","PUT"];n=Se.prototype,n.Ha=function(u){this.J=u},n.ea=function(u,h,f,g){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+u);h=h?h.toUpperCase():"GET",this.D=u,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():wh.g(),this.v=this.o?Ly(this.o):Ly(wh),this.g.onreadystatechange=m(this.Ea,this);try{this.B=!0,this.g.open(h,String(u),!0),this.B=!1}catch(N){c_(this,N);return}if(u=f||"",f=new Map(this.headers),g)if(Object.getPrototypeOf(g)===Object.prototype)for(var b in g)f.set(b,g[b]);else if(typeof g.keys=="function"&&typeof g.get=="function")for(let N of g.keys())f.set(N,g.get(N));else throw Error("Unknown input type for opt_headers: "+String(g));g=Array.from(f.keys()).find(N=>N.toLowerCase()=="content-type"),b=a.FormData&&u instanceof a.FormData,!(0<=Array.prototype.indexOf.call(Gb,h,void 0))||g||b||f.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[N,L]of f)this.g.setRequestHeader(N,L);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{d_(this),this.u=!0,this.g.send(u),this.u=!1}catch(N){c_(this,N)}};function c_(u,h){u.h=!1,u.g&&(u.j=!0,u.g.abort(),u.j=!1),u.l=h,u.m=5,l_(u),mu(u)}function l_(u){u.A||(u.A=!0,lt(u,"complete"),lt(u,"error"))}n.abort=function(u){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=u||7,lt(this,"complete"),lt(this,"abort"),mu(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),mu(this,!0)),Se.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?h_(this):this.bb())},n.bb=function(){h_(this)};function h_(u){if(u.h&&typeof o<"u"&&(!u.v[1]||gn(u)!=4||u.Z()!=2)){if(u.u&&gn(u)==4)Oy(u.Ea,0,u);else if(lt(u,"readystatechange"),gn(u)==4){u.h=!1;try{let L=u.Z();e:switch(L){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var h=!0;break e;default:h=!1}var f;if(!(f=h)){var g;if(g=L===0){var b=String(u.D).match(t_)[1]||null;!b&&a.self&&a.self.location&&(b=a.self.location.protocol.slice(0,-1)),g=!qb.test(b?b.toLowerCase():"")}f=g}if(f)lt(u,"complete"),lt(u,"success");else{u.m=6;try{var N=2<gn(u)?u.g.statusText:""}catch{N=""}u.l=N+" ["+u.Z()+"]",l_(u)}}finally{mu(u)}}}}function mu(u,h){if(u.g){d_(u);let f=u.g,g=u.v[0]?()=>{}:null;u.g=null,u.v=null,h||lt(u,"ready");try{f.onreadystatechange=g}catch{}}}function d_(u){u.I&&(a.clearTimeout(u.I),u.I=null)}n.isActive=function(){return!!this.g};function gn(u){return u.g?u.g.readyState:0}n.Z=function(){try{return 2<gn(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(u){if(this.g){var h=this.g.responseText;return u&&h.indexOf(u)==0&&(h=h.substring(u.length)),Tb(h)}};function f_(u){try{if(!u.g)return null;if("response"in u.g)return u.g.response;switch(u.H){case"":case"text":return u.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in u.g)return u.g.mozResponseArrayBuffer}return null}catch{return null}}function Wb(u){let h={};u=(u.g&&2<=gn(u)&&u.g.getAllResponseHeaders()||"").split(`\r
`);for(let g=0;g<u.length;g++){if($(u[g]))continue;var f=A(u[g]);let b=f[0];if(f=f[1],typeof f!="string")continue;f=f.trim();let N=h[b]||[];h[b]=N,N.push(f)}I(h,function(g){return g.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function co(u,h,f){return f&&f.internalChannelParams&&f.internalChannelParams[u]||h}function p_(u){this.Aa=0,this.i=[],this.j=new to,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=co("failFast",!1,u),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=co("baseRetryDelayMs",5e3,u),this.cb=co("retryDelaySeedMs",1e4,u),this.Wa=co("forwardChannelMaxRetries",2,u),this.wa=co("forwardChannelRequestTimeoutMs",2e4,u),this.pa=u&&u.xmlHttpFactory||void 0,this.Xa=u&&u.Tb||void 0,this.Ca=u&&u.useFetchStreams||!1,this.L=void 0,this.J=u&&u.supportsCrossDomainXhr||!1,this.K="",this.h=new Qy(u&&u.concurrentRequestLimit),this.Da=new jb,this.P=u&&u.fastHandshake||!1,this.O=u&&u.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=u&&u.Rb||!1,u&&u.xa&&this.j.xa(),u&&u.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&u&&u.detectBufferingProxy||!1,this.ja=void 0,u&&u.longPollingTimeout&&0<u.longPollingTimeout&&(this.ja=u.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=p_.prototype,n.la=8,n.G=1,n.connect=function(u,h,f,g){ht(0),this.W=u,this.H=h||{},f&&g!==void 0&&(this.H.OSID=f,this.H.OAID=g),this.F=this.X,this.I=T_(this,null,this.W),_u(this)};function Rh(u){if(g_(u),u.G==3){var h=u.U++,f=pn(u.I);if(Ie(f,"SID",u.K),Ie(f,"RID",h),Ie(f,"TYPE","terminate"),lo(u,f),h=new qn(u,u.j,h),h.L=2,h.v=pu(pn(f)),f=!1,a.navigator&&a.navigator.sendBeacon)try{f=a.navigator.sendBeacon(h.v.toString(),"")}catch{}!f&&a.Image&&(new Image().src=h.v,f=!0),f||(h.g=A_(h.j,null),h.g.ea(h.v)),h.F=Date.now(),hu(h)}I_(u)}function yu(u){u.g&&(Ph(u),u.g.cancel(),u.g=null)}function g_(u){yu(u),u.u&&(a.clearTimeout(u.u),u.u=null),vu(u),u.h.cancel(),u.s&&(typeof u.s=="number"&&a.clearTimeout(u.s),u.s=null)}function _u(u){if(!Yy(u.h)&&!u.s){u.s=!0;var h=u.Ga;Hs||Sy(),Ks||(Hs(),Ks=!0),ah.add(h,u),u.B=0}}function Hb(u,h){return Jy(u.h)>=u.h.j-(u.s?1:0)?!1:u.s?(u.i=h.D.concat(u.i),!0):u.G==1||u.G==2||u.B>=(u.Va?0:u.Wa)?!1:(u.s=eo(m(u.Ga,u,h),E_(u,u.B)),u.B++,!0)}n.Ga=function(u){if(this.s)if(this.s=null,this.G==1){if(!u){this.U=Math.floor(1e5*Math.random()),u=this.U++;let b=new qn(this,this.j,u),N=this.o;if(this.S&&(N?(N=_(N),T(N,this.S)):N=this.S),this.m!==null||this.O||(b.H=N,N=null),this.P)e:{for(var h=0,f=0;f<this.i.length;f++){t:{var g=this.i[f];if("__data__"in g.map&&(g=g.map.__data__,typeof g=="string")){g=g.length;break t}g=void 0}if(g===void 0)break;if(h+=g,4096<h){h=f;break e}if(h===4096||f===this.i.length-1){h=f+1;break e}}h=1e3}else h=1e3;h=y_(this,b,h),f=pn(this.I),Ie(f,"RID",u),Ie(f,"CVER",22),this.D&&Ie(f,"X-HTTP-Session-Id",this.D),lo(this,f),N&&(this.O?h="headers="+encodeURIComponent(String(u_(N)))+"&"+h:this.m&&Sh(f,this.m,N)),Dh(this.h,b),this.Ua&&Ie(f,"TYPE","init"),this.P?(Ie(f,"$req",h),Ie(f,"SID","null"),b.T=!0,Ih(b,f,null)):Ih(b,f,h),this.G=2}}else this.G==3&&(u?m_(this,u):this.i.length==0||Yy(this.h)||m_(this))};function m_(u,h){var f;h?f=h.l:f=u.U++;let g=pn(u.I);Ie(g,"SID",u.K),Ie(g,"RID",f),Ie(g,"AID",u.T),lo(u,g),u.m&&u.o&&Sh(g,u.m,u.o),f=new qn(u,u.j,f,u.B+1),u.m===null&&(f.H=u.o),h&&(u.i=h.D.concat(u.i)),h=y_(u,f,1e3),f.I=Math.round(.5*u.wa)+Math.round(.5*u.wa*Math.random()),Dh(u.h,f),Ih(f,g,h)}function lo(u,h){u.H&&W(u.H,function(f,g){Ie(h,g,f)}),u.l&&e_({},function(f,g){Ie(h,g,f)})}function y_(u,h,f){f=Math.min(u.i.length,f);var g=u.l?m(u.l.Na,u.l,u):null;e:{var b=u.i;let N=-1;for(;;){let L=["count="+f];N==-1?0<f?(N=b[0].g,L.push("ofs="+N)):N=0:L.push("ofs="+N);let me=!0;for(let Xe=0;Xe<f;Xe++){let ue=b[Xe].g,it=b[Xe].map;if(ue-=N,0>ue)N=Math.max(0,b[Xe].g-100),me=!1;else try{zb(it,L,"req"+ue+"_")}catch{g&&g(it)}}if(me){g=L.join("&");break e}}}return u=u.i.splice(0,f),h.D=u,g}function __(u){if(!u.g&&!u.u){u.Y=1;var h=u.Fa;Hs||Sy(),Ks||(Hs(),Ks=!0),ah.add(h,u),u.v=0}}function Ch(u){return u.g||u.u||3<=u.v?!1:(u.Y++,u.u=eo(m(u.Fa,u),E_(u,u.v)),u.v++,!0)}n.Fa=function(){if(this.u=null,v_(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var u=2*this.R;this.j.info("BP detection timer enabled: "+u),this.A=eo(m(this.ab,this),u)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,ht(10),yu(this),v_(this))};function Ph(u){u.A!=null&&(a.clearTimeout(u.A),u.A=null)}function v_(u){u.g=new qn(u,u.j,"rpc",u.Y),u.m===null&&(u.g.H=u.o),u.g.O=0;var h=pn(u.qa);Ie(h,"RID","rpc"),Ie(h,"SID",u.K),Ie(h,"AID",u.T),Ie(h,"CI",u.F?"0":"1"),!u.F&&u.ja&&Ie(h,"TO",u.ja),Ie(h,"TYPE","xmlhttp"),lo(u,h),u.m&&u.o&&Sh(h,u.m,u.o),u.L&&(u.g.I=u.L);var f=u.g;u=u.ia,f.L=1,f.v=pu(pn(h)),f.m=null,f.P=!0,Wy(f,u)}n.Za=function(){this.C!=null&&(this.C=null,yu(this),Ch(this),ht(19))};function vu(u){u.C!=null&&(a.clearTimeout(u.C),u.C=null)}function w_(u,h){var f=null;if(u.g==h){vu(u),Ph(u),u.g=null;var g=2}else if(bh(u.h,h))f=h.D,Xy(u.h,h),g=1;else return;if(u.G!=0){if(h.o)if(g==1){f=h.m?h.m.length:0,h=Date.now()-h.F;var b=u.B;g=uu(),lt(g,new jy(g,f)),_u(u)}else __(u);else if(b=h.s,b==3||b==0&&0<h.X||!(g==1&&Hb(u,h)||g==2&&Ch(u)))switch(f&&0<f.length&&(h=u.h,h.i=h.i.concat(f)),b){case 1:Vr(u,5);break;case 4:Vr(u,10);break;case 3:Vr(u,6);break;default:Vr(u,2)}}}function E_(u,h){let f=u.Ta+Math.floor(Math.random()*u.cb);return u.isActive()||(f*=2),f*h}function Vr(u,h){if(u.j.info("Error code "+h),h==2){var f=m(u.fb,u),g=u.Xa;let b=!g;g=new Lr(g||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||du(g,"https"),pu(g),b?Bb(g.toString(),f):$b(g.toString(),f)}else ht(2);u.G=0,u.l&&u.l.sa(h),I_(u),g_(u)}n.fb=function(u){u?(this.j.info("Successfully pinged google.com"),ht(2)):(this.j.info("Failed to ping google.com"),ht(1))};function I_(u){if(u.G=0,u.ka=[],u.l){let h=Zy(u.h);(h.length!=0||u.i.length!=0)&&(S(u.ka,h),S(u.ka,u.i),u.h.i.length=0,k(u.i),u.i.length=0),u.l.ra()}}function T_(u,h,f){var g=f instanceof Lr?pn(f):new Lr(f);if(g.g!="")h&&(g.g=h+"."+g.g),fu(g,g.s);else{var b=a.location;g=b.protocol,h=h?h+"."+b.hostname:b.hostname,b=+b.port;var N=new Lr(null);g&&du(N,g),h&&(N.g=h),b&&fu(N,b),f&&(N.l=f),g=N}return f=u.D,h=u.ya,f&&h&&Ie(g,f,h),Ie(g,"VER",u.la),lo(u,g),g}function A_(u,h,f){if(h&&!u.J)throw Error("Can't create secondary domain capable XhrIo object.");return h=u.Ca&&!u.pa?new Se(new oo({eb:f})):new Se(u.pa),h.Ha(u.J),h}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function b_(){}n=b_.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function wu(){}wu.prototype.g=function(u,h){return new _t(u,h)};function _t(u,h){rt.call(this),this.g=new p_(h),this.l=u,this.h=h&&h.messageUrlParams||null,u=h&&h.messageHeaders||null,h&&h.clientProtocolHeaderRequired&&(u?u["X-Client-Protocol"]="webchannel":u={"X-Client-Protocol":"webchannel"}),this.g.o=u,u=h&&h.initMessageHeaders||null,h&&h.messageContentType&&(u?u["X-WebChannel-Content-Type"]=h.messageContentType:u={"X-WebChannel-Content-Type":h.messageContentType}),h&&h.va&&(u?u["X-WebChannel-Client-Profile"]=h.va:u={"X-WebChannel-Client-Profile":h.va}),this.g.S=u,(u=h&&h.Sb)&&!$(u)&&(this.g.m=u),this.v=h&&h.supportsCrossDomainXhr||!1,this.u=h&&h.sendRawJson||!1,(h=h&&h.httpSessionIdParam)&&!$(h)&&(this.g.D=h,u=this.h,u!==null&&h in u&&(u=this.h,h in u&&delete u[h])),this.j=new Ti(this)}D(_t,rt),_t.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},_t.prototype.close=function(){Rh(this.g)},_t.prototype.o=function(u){var h=this.g;if(typeof u=="string"){var f={};f.__data__=u,u=f}else this.u&&(f={},f.__data__=mh(u),u=f);h.i.push(new Pb(h.Ya++,u)),h.G==3&&_u(h)},_t.prototype.N=function(){this.g.l=null,delete this.j,Rh(this.g),delete this.g,_t.aa.N.call(this)};function D_(u){_h.call(this),u.__headers__&&(this.headers=u.__headers__,this.statusCode=u.__status__,delete u.__headers__,delete u.__status__);var h=u.__sm__;if(h){e:{for(let f in h){u=f;break e}u=void 0}(this.i=u)&&(u=this.i,h=h!==null&&u in h?h[u]:void 0),this.data=h}else this.data=u}D(D_,_h);function S_(){vh.call(this),this.status=1}D(S_,vh);function Ti(u){this.g=u}D(Ti,b_),Ti.prototype.ua=function(){lt(this.g,"a")},Ti.prototype.ta=function(u){lt(this.g,new D_(u))},Ti.prototype.sa=function(u){lt(this.g,new S_)},Ti.prototype.ra=function(){lt(this.g,"b")},wu.prototype.createWebChannel=wu.prototype.g,_t.prototype.send=_t.prototype.o,_t.prototype.open=_t.prototype.m,_t.prototype.close=_t.prototype.close,Rp=Mn.createWebChannelTransport=function(){return new wu},Sp=Mn.getStatEventTarget=function(){return uu()},Dp=Mn.Event=xr,Bc=Mn.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},cu.NO_ERROR=0,cu.TIMEOUT=8,cu.HTTP_ERROR=6,la=Mn.ErrorCode=cu,zy.COMPLETE="complete",bp=Mn.EventType=zy,Vy.EventType=Xs,Xs.OPEN="a",Xs.CLOSE="b",Xs.ERROR="c",Xs.MESSAGE="d",rt.prototype.listen=rt.prototype.K,is=Mn.WebChannel=Vy,Ap=Mn.FetchXmlHttpFactory=oo,Se.prototype.listenOnce=Se.prototype.L,Se.prototype.getLastError=Se.prototype.Ka,Se.prototype.getLastErrorCode=Se.prototype.Ba,Se.prototype.getStatus=Se.prototype.Z,Se.prototype.getResponseJson=Se.prototype.Oa,Se.prototype.getResponseText=Se.prototype.oa,Se.prototype.send=Se.prototype.ea,Se.prototype.setWithCredentials=Se.prototype.Ha,Tp=Mn.XhrIo=Se}).apply(typeof Uc<"u"?Uc:typeof self<"u"?self:typeof window<"u"?window:{});var MI="@firebase/firestore";var qe=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};qe.UNAUTHENTICATED=new qe(null),qe.GOOGLE_CREDENTIALS=new qe("google-credentials-uid"),qe.FIRST_PARTY=new qe("first-party-uid"),qe.MOCK_USER=new qe("mock-user");var Ls="10.13.0";var wr=new ar("@firebase/firestore");function cs(){return wr.logLevel}function kO(n){wr.setLogLevel(n)}function O(n,...e){if(wr.logLevel<=re.DEBUG){let t=e.map(Om);wr.debug(`Firestore (${Ls}): ${n}`,...t)}}function ke(n,...e){if(wr.logLevel<=re.ERROR){let t=e.map(Om);wr.error(`Firestore (${Ls}): ${n}`,...t)}}function un(n,...e){if(wr.logLevel<=re.WARN){let t=e.map(Om);wr.warn(`Firestore (${Ls}): ${n}`,...t)}}function Om(n){if(typeof n=="string")return n;try{return function(t){return JSON.stringify(t)}(n)}catch{return n}}function z(n="Unexpected state"){let e=`FIRESTORE (${Ls}) INTERNAL ASSERTION FAILED: `+n;throw ke(e),new Error(e)}function G(n,e){n||z()}function BU(n,e){n||z()}function V(n,e){return n}var P={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},M=class extends at{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var Ge=class{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}};var Jc=class{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},Op=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(qe.UNAUTHENTICATED))}shutdown(){}},Mp=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}},xp=class{constructor(e){this.t=e,this.currentUser=qe.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){let r=this.i,i=c=>this.i!==r?(r=this.i,t(c)):Promise.resolve(),s=new Ge;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Ge,e.enqueueRetryable(()=>i(this.currentUser))};let o=()=>{let c=s;e.enqueueRetryable(()=>y(this,null,function*(){yield c.promise,yield i(this.currentUser)}))},a=c=>{O("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.auth.addAuthTokenListener(this.o),o()};this.t.onInit(c=>a(c)),setTimeout(()=>{if(!this.auth){let c=this.t.getImmediate({optional:!0});c?a(c):(O("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Ge)}},0),o()}getToken(){let e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(O("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(G(typeof r.accessToken=="string"),new Jc(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){let e=this.auth&&this.auth.getUid();return G(e===null||typeof e=="string"),new qe(e)}},Fp=class{constructor(e,t,r){this.l=e,this.h=t,this.P=r,this.type="FirstParty",this.user=qe.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);let e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}},Lp=class{constructor(e,t,r){this.l=e,this.h=t,this.P=r}getToken(){return Promise.resolve(new Fp(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(qe.FIRST_PARTY))}shutdown(){}invalidateToken(){}},Vp=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},Up=class{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){let r=s=>{s.error!=null&&O("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);let o=s.token!==this.R;return this.R=s.token,O("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};let i=s=>{O("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){let s=this.A.getImmediate({optional:!0});s?i(s):O("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(G(typeof t.token=="string"),this.R=t.token,new Vp(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}};function OO(n){let e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}var Xc=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length,r="";for(;r.length<20;){let i=OO(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<t&&(r+=e.charAt(i[s]%e.length))}return r}};function Z(n,e){return n<e?-1:n>e?1:0}function vs(n,e,t){return n.length===e.length&&n.every((r,i)=>t(r,e[i]))}function LT(n){return n+"\0"}var Oe=class n{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new M(P.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new M(P.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new M(P.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new M(P.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return n.fromMillis(Date.now())}static fromDate(e){return n.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*t));return new n(t,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Z(this.nanoseconds,e.nanoseconds):Z(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){let e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};var H=class n{constructor(e){this.timestamp=e}static fromTimestamp(e){return new n(e)}static min(){return new n(new Oe(0,0))}static max(){return new n(new Oe(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var Zc=class n{constructor(e,t,r){t===void 0?t=0:t>e.length&&z(),r===void 0?r=e.length-t:r>e.length-t&&z(),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return n.comparator(this,e)===0}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof n?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let r=Math.min(e.length,t.length);for(let i=0;i<r;i++){let s=e.get(i),o=t.get(i);if(s<o)return-1;if(s>o)return 1}return e.length<t.length?-1:e.length>t.length?1:0}},ae=class n extends Zc{construct(e,t,r){return new n(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let t=[];for(let r of e){if(r.indexOf("//")>=0)throw new M(P.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new n(t)}static emptyPath(){return new n([])}},MO=/^[_a-zA-Z][_a-zA-Z0-9]*$/,He=class n extends Zc{construct(e,t,r){return new n(e,t,r)}static isValidIdentifier(e){return MO.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new n(["__name__"])}static fromServerFormat(e){let t=[],r="",i=0,s=()=>{if(r.length===0)throw new M(P.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""},o=!1;for(;i<e.length;){let a=e[i];if(a==="\\"){if(i+1===e.length)throw new M(P.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let c=e[i+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new M(P.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=c,i+=2}else a==="`"?(o=!o,i++):a!=="."||o?(r+=a,i++):(s(),i++)}if(s(),o)throw new M(P.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}static emptyPath(){return new n([])}};var B=class n{constructor(e){this.path=e}static fromPath(e){return new n(ae.fromString(e))}static fromName(e){return new n(ae.fromString(e).popFirst(5))}static empty(){return new n(ae.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ae.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return ae.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new n(new ae(e.slice()))}};var ws=class{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}};function Bp(n){return n.fields.find(e=>e.kind===2)}function ti(n){return n.fields.filter(e=>e.kind!==2)}ws.UNKNOWN_ID=-1;var gs=class{constructor(e,t){this.fieldPath=e,this.kind=t}};var Ia=class n{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new n(0,Ft.min())}};function VT(n,e){let t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=H.fromTimestamp(r===1e9?new Oe(t+1,0):new Oe(t,r));return new Ft(i,B.empty(),e)}function UT(n){return new Ft(n.readTime,n.key,-1)}var Ft=class n{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new n(H.min(),B.empty(),-1)}static max(){return new n(H.max(),B.empty(),-1)}};function Mm(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=B.comparator(n.documentKey,e.documentKey),t!==0?t:Z(n.largestBatchId,e.largestBatchId))}var BT="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",el=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};function kr(n){return y(this,null,function*(){if(n.code!==P.FAILED_PRECONDITION||n.message!==BT)throw n;O("LocalStore","Unexpectedly lost primary lease")})}var C=class n{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&z(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new n((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(t,s).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{let t=e();return t instanceof n?t:n.resolve(t)}catch(t){return n.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):n.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):n.reject(t)}static resolve(e){return new n((t,r)=>{t(e)})}static reject(e){return new n((t,r)=>{r(e)})}static waitFor(e){return new n((t,r)=>{let i=0,s=0,o=!1;e.forEach(a=>{++i,a.next(()=>{++s,o&&s===i&&t()},c=>r(c))}),o=!0,s===i&&t()})}static or(e){let t=n.resolve(!1);for(let r of e)t=t.next(i=>i?n.resolve(i):r());return t}static forEach(e,t){let r=[];return e.forEach((i,s)=>{r.push(t.call(this,i,s))}),this.waitFor(r)}static mapArray(e,t){return new n((r,i)=>{let s=e.length,o=new Array(s),a=0;for(let c=0;c<s;c++){let l=c;t(e[l]).next(d=>{o[l]=d,++a,a===s&&r(o)},d=>i(d))}})}static doWhile(e,t){return new n((r,i)=>{let s=()=>{e()===!0?t().next(()=>{s()},i):r()};s()})}};var tl=class n{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.V=new Ge,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{t.error?this.V.reject(new ai(e,t.error)):this.V.resolve()},this.transaction.onerror=r=>{let i=xm(r.target.error);this.V.reject(new ai(e,i))}}static open(e,t,r,i){try{return new n(t,e.transaction(i,r))}catch(s){throw new ai(t,s)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(O("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){let e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){let t=this.transaction.objectStore(e);return new jp(t)}},Er=class n{constructor(e,t,r){this.name=e,this.version=t,this.p=r,n.S(Ne())===12.2&&ke("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return O("SimpleDb","Removing database:",e),ni(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!fc())return!1;if(n.v())return!0;let e=Ne(),t=n.S(e),r=0<t&&t<10,i=$T(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||s)}static v(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.C)==="YES"}static F(e,t){return e.store(t)}static S(e){let t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)}M(e){return y(this,null,function*(){return this.db||(O("SimpleDb","Opening database:",this.name),this.db=yield new Promise((t,r)=>{let i=indexedDB.open(this.name,this.version);i.onsuccess=s=>{let o=s.target.result;t(o)},i.onblocked=()=>{r(new ai(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=s=>{let o=s.target.error;o.name==="VersionError"?r(new M(P.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new M(P.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new ai(e,o))},i.onupgradeneeded=s=>{O("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);let o=s.target.result;this.p.O(o,i.transaction,s.oldVersion,this.version).next(()=>{O("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.N&&(this.db.onversionchange=t=>this.N(t)),this.db})}L(e){this.N=e,this.db&&(this.db.onversionchange=t=>e(t))}runTransaction(e,t,r,i){return y(this,null,function*(){let s=t==="readonly",o=0;for(;;){++o;try{this.db=yield this.M(e);let a=tl.open(this.db,e,s?"readonly":"readwrite",r),c=i(a).next(l=>(a.g(),l)).catch(l=>(a.abort(l),C.reject(l))).toPromise();return c.catch(()=>{}),yield a.m,c}catch(a){let c=a,l=c.name!=="FirebaseError"&&o<3;if(O("SimpleDb","Transaction failed with error:",c.message,"Retrying:",l),this.close(),!l)return Promise.reject(c)}}})}close(){this.db&&this.db.close(),this.db=void 0}};function $T(n){let e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}var $p=class{constructor(e){this.B=e,this.k=!1,this.q=null}get isDone(){return this.k}get K(){return this.q}set cursor(e){this.B=e}done(){this.k=!0}$(e){this.q=e}delete(){return ni(this.B.delete())}},ai=class extends M{constructor(e,t){super(P.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}};function Or(n){return n.name==="IndexedDbTransactionError"}var jp=class{constructor(e){this.store=e}put(e,t){let r;return t!==void 0?(O("SimpleDb","PUT",this.store.name,e,t),r=this.store.put(t,e)):(O("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),ni(r)}add(e){return O("SimpleDb","ADD",this.store.name,e,e),ni(this.store.add(e))}get(e){return ni(this.store.get(e)).next(t=>(t===void 0&&(t=null),O("SimpleDb","GET",this.store.name,e,t),t))}delete(e){return O("SimpleDb","DELETE",this.store.name,e),ni(this.store.delete(e))}count(){return O("SimpleDb","COUNT",this.store.name),ni(this.store.count())}U(e,t){let r=this.options(e,t),i=r.index?this.store.index(r.index):this.store;if(typeof i.getAll=="function"){let s=i.getAll(r.range);return new C((o,a)=>{s.onerror=c=>{a(c.target.error)},s.onsuccess=c=>{o(c.target.result)}})}{let s=this.cursor(r),o=[];return this.W(s,(a,c)=>{o.push(c)}).next(()=>o)}}G(e,t){let r=this.store.getAll(e,t===null?void 0:t);return new C((i,s)=>{r.onerror=o=>{s(o.target.error)},r.onsuccess=o=>{i(o.target.result)}})}j(e,t){O("SimpleDb","DELETE ALL",this.store.name);let r=this.options(e,t);r.H=!1;let i=this.cursor(r);return this.W(i,(s,o,a)=>a.delete())}J(e,t){let r;t?r=e:(r={},t=e);let i=this.cursor(r);return this.W(i,t)}Y(e){let t=this.cursor({});return new C((r,i)=>{t.onerror=s=>{let o=xm(s.target.error);i(o)},t.onsuccess=s=>{let o=s.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():r()}):r()}})}W(e,t){let r=[];return new C((i,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{let a=o.target.result;if(!a)return void i();let c=new $p(a),l=t(a.primaryKey,a.value,c);if(l instanceof C){let d=l.catch(p=>(c.done(),C.reject(p)));r.push(d)}c.isDone?i():c.K===null?a.continue():a.continue(c.K)}}).next(()=>C.waitFor(r))}options(e,t){let r;return e!==void 0&&(typeof e=="string"?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){let r=this.store.index(e.index);return e.H?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}};function ni(n){return new C((e,t)=>{n.onsuccess=r=>{let i=r.target.result;e(i)},n.onerror=r=>{let i=xm(r.target.error);t(i)}})}var xI=!1;function xm(n){let e=Er.S(Ne());if(e>=12.2&&e<13){let t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){let r=new M("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return xI||(xI=!0,setTimeout(()=>{throw r},0)),r}}return n}var zp=class{constructor(e,t){this.asyncQueue=e,this.Z=t,this.task=null}start(){this.X(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}X(e){O("IndexBackfiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,()=>y(this,null,function*(){this.task=null;try{O("IndexBackfiller",`Documents written: ${yield this.Z.ee()}`)}catch(t){Or(t)?O("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",t):yield kr(t)}yield this.X(6e4)}))}},qp=class{constructor(e,t){this.localStore=e,this.persistence=t}ee(e=50){return y(this,null,function*(){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",t=>this.te(t,e))})}te(e,t){let r=new Set,i=t,s=!0;return C.doWhile(()=>s===!0&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!r.has(o))return O("IndexBackfiller",`Processing collection: ${o}`),this.ne(e,o,i).next(a=>{i-=a,r.add(o)});s=!1})).next(()=>t-i)}ne(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(i=>this.localStore.localDocuments.getNextDocuments(e,t,i,r).next(s=>{let o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.re(i,s)).next(a=>(O("IndexBackfiller",`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,t,a))).next(()=>o.size)}))}re(e,t){let r=e;return t.changes.forEach((i,s)=>{let o=UT(s);Mm(o,r)>0&&(r=o)}),new Ft(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}};var At=(()=>{class n{constructor(t,r){this.previousValue=t,r&&(r.sequenceNumberHandler=i=>this.ie(i),this.se=i=>r.writeSequenceNumber(i))}ie(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){let t=++this.previousValue;return this.se&&this.se(t),t}}return n.oe=-1,n})();function Wa(n){return n==null}function Ta(n){return n===0&&1/n==-1/0}function jT(n){return typeof n=="number"&&Number.isInteger(n)&&!Ta(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}function ft(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=FI(e)),e=xO(n.get(t),e);return FI(e)}function xO(n,e){let t=e,r=n.length;for(let i=0;i<r;i++){let s=n.charAt(i);switch(s){case"\0":t+="";break;case"":t+="";break;default:t+=s}}return t}function FI(n){return n+""}function nn(n){let e=n.length;if(G(e>=2),e===2)return G(n.charAt(0)===""&&n.charAt(1)===""),ae.emptyPath();let t=e-2,r=[],i="";for(let s=0;s<e;){let o=n.indexOf("",s);switch((o<0||o>t)&&z(),n.charAt(o+1)){case"":let a=n.substring(s,o),c;i.length===0?c=a:(i+=a,c=i,i=""),r.push(c);break;case"":i+=n.substring(s,o),i+="\0";break;case"":i+=n.substring(s,o+1);break;default:z()}s=o+2}return new ae(r)}var LI=["userId","batchId"];function Gc(n,e){return[n,ft(e)]}function zT(n,e,t){return[n,ft(e),t]}var FO={},LO=["prefixPath","collectionGroup","readTime","documentId"],VO=["prefixPath","collectionGroup","documentId"],UO=["collectionGroup","readTime","prefixPath","documentId"],BO=["canonicalId","targetId"],$O=["targetId","path"],jO=["path","targetId"],zO=["collectionId","parent"],qO=["indexId","uid"],GO=["uid","sequenceNumber"],WO=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],HO=["indexId","uid","orderedDocumentKey"],KO=["userId","collectionPath","documentId"],QO=["userId","collectionPath","largestBatchId"],YO=["userId","collectionGroup","largestBatchId"],qT=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],JO=[...qT,"documentOverlays"],GT=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],WT=GT,Fm=[...WT,"indexConfiguration","indexState","indexEntries"],XO=Fm,ZO=[...Fm,"globals"];var Aa=class extends el{constructor(e,t){super(),this._e=e,this.currentSequenceNumber=t}};function Ke(n,e){let t=V(n);return Er.F(t._e,e)}function VI(n){let e=0;for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function _i(n,e){for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function HT(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}var Te=class n{constructor(e,t){this.comparator=e,this.root=t||sn.EMPTY}insert(e,t){return new n(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,sn.BLACK,null,null))}remove(e){return new n(this.comparator,this.root.remove(e,this.comparator).copy(null,null,sn.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){let i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){let e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new ps(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new ps(this.root,e,this.comparator,!1)}getReverseIterator(){return new ps(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new ps(this.root,e,this.comparator,!0)}},ps=class{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?r(e.key,t):1,t&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},sn=class n{constructor(e,t,r,i,s){this.key=e,this.value=t,this.color=r??n.RED,this.left=i??n.EMPTY,this.right=s??n.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,s){return new n(e??this.key,t??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this,s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,t,r),null):s===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return n.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return n.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw z();let e=this.left.check();if(e!==this.right.check())throw z();return e+(this.isRed()?0:1)}};sn.EMPTY=null,sn.RED=!0,sn.BLACK=!1;sn.EMPTY=new class{constructor(){this.size=0}get key(){throw z()}get value(){throw z()}get color(){throw z()}get left(){throw z()}get right(){throw z()}copy(e,t,r,i,s){return this}insert(e,t,r){return new sn(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var ve=class n{constructor(e){this.comparator=e,this.data=new Te(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new nl(this.data.getIterator())}getIteratorFrom(e){return new nl(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){let i=t.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new n(this.comparator);return t.data=e,t}},nl=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};function ss(n){return n.hasNext()?n.getNext():void 0}var bt=class n{constructor(e){this.fields=e,e.sort(He.comparator)}static empty(){return new n([])}unionWith(e){let t=new ve(He.comparator);for(let r of this.fields)t=t.add(r);for(let r of e)t=t.add(r);return new n(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return vs(this.fields,e.fields,(t,r)=>t.isEqual(r))}};var rl=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};function jU(){return typeof atob<"u"}var Fe=class n{constructor(e){this.binaryString=e}static fromBase64String(e){let t=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new rl("Invalid base64 string: "+s):s}}(e);return new n(t)}static fromUint8Array(e){let t=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new n(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){let r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Z(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};Fe.EMPTY_BYTE_STRING=new Fe("");var e1=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ln(n){if(G(!!n),typeof n=="string"){let e=0,t=e1.exec(n);if(G(!!t),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}let r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Ae(n.seconds),nanos:Ae(n.nanos)}}function Ae(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Ir(n){return typeof n=="string"?Fe.fromBase64String(n):Fe.fromUint8Array(n)}function Hl(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="server_timestamp"}function Lm(n){let e=n.mapValue.fields.__previous_value__;return Hl(e)?Lm(e):e}function ba(n){let e=Ln(n.mapValue.fields.__local_write_time__.timestampValue);return new Oe(e.seconds,e.nanos)}var Gp=class{constructor(e,t,r,i,s,o,a,c,l){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=c,this.useFetchStreams=l}},Es=class n{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new n("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof n&&e.projectId===this.projectId&&e.database===this.database}};var vr={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},Wc={nullValue:"NULL_VALUE"};function ui(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Hl(n)?4:KT(n)?9007199254740991:Kl(n)?10:11:z()}function cn(n,e){if(n===e)return!0;let t=ui(n);if(t!==ui(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return ba(n).isEqual(ba(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;let o=Ln(i.timestampValue),a=Ln(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(i,s){return Ir(i.bytesValue).isEqual(Ir(s.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(i,s){return Ae(i.geoPointValue.latitude)===Ae(s.geoPointValue.latitude)&&Ae(i.geoPointValue.longitude)===Ae(s.geoPointValue.longitude)}(n,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return Ae(i.integerValue)===Ae(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){let o=Ae(i.doubleValue),a=Ae(s.doubleValue);return o===a?Ta(o)===Ta(a):isNaN(o)&&isNaN(a)}return!1}(n,e);case 9:return vs(n.arrayValue.values||[],e.arrayValue.values||[],cn);case 10:case 11:return function(i,s){let o=i.mapValue.fields||{},a=s.mapValue.fields||{};if(VI(o)!==VI(a))return!1;for(let c in o)if(o.hasOwnProperty(c)&&(a[c]===void 0||!cn(o[c],a[c])))return!1;return!0}(n,e);default:return z()}}function Da(n,e){return(n.values||[]).find(t=>cn(t,e))!==void 0}function Tr(n,e){if(n===e)return 0;let t=ui(n),r=ui(e);if(t!==r)return Z(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return Z(n.booleanValue,e.booleanValue);case 2:return function(s,o){let a=Ae(s.integerValue||s.doubleValue),c=Ae(o.integerValue||o.doubleValue);return a<c?-1:a>c?1:a===c?0:isNaN(a)?isNaN(c)?0:-1:1}(n,e);case 3:return UI(n.timestampValue,e.timestampValue);case 4:return UI(ba(n),ba(e));case 5:return Z(n.stringValue,e.stringValue);case 6:return function(s,o){let a=Ir(s),c=Ir(o);return a.compareTo(c)}(n.bytesValue,e.bytesValue);case 7:return function(s,o){let a=s.split("/"),c=o.split("/");for(let l=0;l<a.length&&l<c.length;l++){let d=Z(a[l],c[l]);if(d!==0)return d}return Z(a.length,c.length)}(n.referenceValue,e.referenceValue);case 8:return function(s,o){let a=Z(Ae(s.latitude),Ae(o.latitude));return a!==0?a:Z(Ae(s.longitude),Ae(o.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return BI(n.arrayValue,e.arrayValue);case 10:return function(s,o){var a,c,l,d;let p=s.fields||{},m=o.fields||{},w=(a=p.value)===null||a===void 0?void 0:a.arrayValue,D=(c=m.value)===null||c===void 0?void 0:c.arrayValue,k=Z(((l=w?.values)===null||l===void 0?void 0:l.length)||0,((d=D?.values)===null||d===void 0?void 0:d.length)||0);return k!==0?k:BI(w,D)}(n.mapValue,e.mapValue);case 11:return function(s,o){if(s===vr.mapValue&&o===vr.mapValue)return 0;if(s===vr.mapValue)return 1;if(o===vr.mapValue)return-1;let a=s.fields||{},c=Object.keys(a),l=o.fields||{},d=Object.keys(l);c.sort(),d.sort();for(let p=0;p<c.length&&p<d.length;++p){let m=Z(c[p],d[p]);if(m!==0)return m;let w=Tr(a[c[p]],l[d[p]]);if(w!==0)return w}return Z(c.length,d.length)}(n.mapValue,e.mapValue);default:throw z()}}function UI(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return Z(n,e);let t=Ln(n),r=Ln(e),i=Z(t.seconds,r.seconds);return i!==0?i:Z(t.nanos,r.nanos)}function BI(n,e){let t=n.values||[],r=e.values||[];for(let i=0;i<t.length&&i<r.length;++i){let s=Tr(t[i],r[i]);if(s)return s}return Z(t.length,r.length)}function Is(n){return Wp(n)}function Wp(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){let r=Ln(t);return`time(${r.seconds},${r.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return Ir(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return B.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let r="[",i=!0;for(let s of t.values||[])i?i=!1:r+=",",r+=Wp(s);return r+"]"}(n.arrayValue):"mapValue"in n?function(t){let r=Object.keys(t.fields||{}).sort(),i="{",s=!0;for(let o of r)s?s=!1:i+=",",i+=`${o}:${Wp(t.fields[o])}`;return i+"}"}(n.mapValue):z()}function ci(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function Hp(n){return!!n&&"integerValue"in n}function Sa(n){return!!n&&"arrayValue"in n}function $I(n){return!!n&&"nullValue"in n}function jI(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Hc(n){return!!n&&"mapValue"in n}function Kl(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="__vector__"}function ya(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){let e={mapValue:{fields:{}}};return _i(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=ya(r)),e}if(n.arrayValue){let e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=ya(n.arrayValue.values[t]);return e}return Object.assign({},n)}function KT(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}var QT={mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{}}}}};function t1(n){return"nullValue"in n?Wc:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?ci(Es.empty(),B.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?Kl(n)?QT:{mapValue:{}}:z()}function n1(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?ci(Es.empty(),B.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?QT:"mapValue"in n?Kl(n)?{mapValue:{}}:vr:z()}function zI(n,e){let t=Tr(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function qI(n,e){let t=Tr(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}var ct=class n{constructor(e){this.value=e}static empty(){return new n({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!Hc(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=ya(t)}setAll(e){let t=He.emptyPath(),r={},i=[];e.forEach((o,a)=>{if(!t.isImmediateParentOf(a)){let c=this.getFieldsMap(t);this.applyChanges(c,r,i),r={},i=[],t=a.popLast()}o?r[a.lastSegment()]=ya(o):i.push(a.lastSegment())});let s=this.getFieldsMap(t);this.applyChanges(s,r,i)}delete(e){let t=this.field(e.popLast());Hc(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return cn(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];Hc(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){_i(t,(i,s)=>e[i]=s);for(let i of r)delete e[i]}clone(){return new n(ya(this.value))}};function YT(n){let e=[];return _i(n.fields,(t,r)=>{let i=new He([t]);if(Hc(r)){let s=YT(r.mapValue).fields;if(s.length===0)e.push(i);else for(let o of s)e.push(i.child(o))}else e.push(i)}),new bt(e)}var We=class n{constructor(e,t,r,i,s,o,a){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new n(e,0,H.min(),H.min(),H.min(),ct.empty(),0)}static newFoundDocument(e,t,r,i){return new n(e,1,t,H.min(),r,i,0)}static newNoDocument(e,t){return new n(e,2,t,H.min(),H.min(),ct.empty(),0)}static newUnknownDocument(e,t){return new n(e,3,t,H.min(),H.min(),ct.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(H.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=ct.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=ct.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=H.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof n&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new n(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var ln=class{constructor(e,t){this.position=e,this.inclusive=t}};function GI(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){let s=e[i],o=n.position[i];if(s.field.isKeyField()?r=B.comparator(B.fromName(o.referenceValue),t.key):r=Tr(o,t.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function WI(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!cn(n.position[t],e.position[t]))return!1;return!0}var li=class{constructor(e,t="asc"){this.field=e,this.dir=t}};function r1(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}var il=class{},se=class n extends il{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new Yp(e,t,r):t==="array-contains"?new Zp(e,r):t==="in"?new sl(e,r):t==="not-in"?new eg(e,r):t==="array-contains-any"?new tg(e,r):new n(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new Jp(e,r):new Xp(e,r)}matches(e){let t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(Tr(t,this.value)):t!==null&&ui(this.value)===ui(t)&&this.matchesComparison(Tr(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return z()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},ge=class n extends il{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new n(e,t)}matches(e){return Ts(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}};function Ts(n){return n.op==="and"}function Kp(n){return n.op==="or"}function Vm(n){return JT(n)&&Ts(n)}function JT(n){for(let e of n.filters)if(e instanceof ge)return!1;return!0}function Qp(n){if(n instanceof se)return n.field.canonicalString()+n.op.toString()+Is(n.value);if(Vm(n))return n.filters.map(e=>Qp(e)).join(",");{let e=n.filters.map(t=>Qp(t)).join(",");return`${n.op}(${e})`}}function XT(n,e){return n instanceof se?function(r,i){return i instanceof se&&r.op===i.op&&r.field.isEqual(i.field)&&cn(r.value,i.value)}(n,e):n instanceof ge?function(r,i){return i instanceof ge&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,o,a)=>s&&XT(o,i.filters[a]),!0):!1}(n,e):void z()}function ZT(n,e){let t=n.filters.concat(e);return ge.create(t,n.op)}function e0(n){return n instanceof se?function(t){return`${t.field.canonicalString()} ${t.op} ${Is(t.value)}`}(n):n instanceof ge?function(t){return t.op.toString()+" {"+t.getFilters().map(e0).join(" ,")+"}"}(n):"Filter"}var Yp=class extends se{constructor(e,t,r){super(e,t,r),this.key=B.fromName(r.referenceValue)}matches(e){let t=B.comparator(e.key,this.key);return this.matchesComparison(t)}},Jp=class extends se{constructor(e,t){super(e,"in",t),this.keys=t0("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}},Xp=class extends se{constructor(e,t){super(e,"not-in",t),this.keys=t0("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}};function t0(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(r=>B.fromName(r.referenceValue))}var Zp=class extends se{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return Sa(t)&&Da(t.arrayValue,this.value)}},sl=class extends se{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return t!==null&&Da(this.value.arrayValue,t)}},eg=class extends se{constructor(e,t){super(e,"not-in",t)}matches(e){if(Da(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return t!==null&&!Da(this.value.arrayValue,t)}},tg=class extends se{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!(!Sa(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>Da(this.value.arrayValue,r))}};var ng=class{constructor(e,t=null,r=[],i=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=a,this.ue=null}};function rg(n,e=null,t=[],r=[],i=null,s=null,o=null){return new ng(n,e,t,r,i,s,o)}function hi(n){let e=V(n);if(e.ue===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>Qp(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),Wa(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>Is(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>Is(r)).join(",")),e.ue=t}return e.ue}function Ha(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!r1(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!XT(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!WI(n.startAt,e.startAt)&&WI(n.endAt,e.endAt)}function ol(n){return B.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function al(n,e){return n.filters.filter(t=>t instanceof se&&t.field.isEqual(e))}function HI(n,e,t){let r=Wc,i=!0;for(let s of al(n,e)){let o=Wc,a=!0;switch(s.op){case"<":case"<=":o=t1(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,a=!1;break;case"!=":case"not-in":o=Wc}zI({value:r,inclusive:i},{value:o,inclusive:a})<0&&(r=o,i=a)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){let o=t.position[s];zI({value:r,inclusive:i},{value:o,inclusive:t.inclusive})<0&&(r=o,i=t.inclusive);break}}return{value:r,inclusive:i}}function KI(n,e,t){let r=vr,i=!0;for(let s of al(n,e)){let o=vr,a=!0;switch(s.op){case">=":case">":o=n1(s.value),a=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,a=!1;break;case"!=":case"not-in":o=vr}qI({value:r,inclusive:i},{value:o,inclusive:a})>0&&(r=o,i=a)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){let o=t.position[s];qI({value:r,inclusive:i},{value:o,inclusive:t.inclusive})>0&&(r=o,i=t.inclusive);break}}return{value:r,inclusive:i}}var qt=class{constructor(e,t=null,r=[],i=[],s=null,o="F",a=null,c=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=c,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}};function n0(n,e,t,r,i,s,o,a){return new qt(n,e,t,r,i,s,o,a)}function Vs(n){return new qt(n)}function QI(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function Um(n){return n.collectionGroup!==null}function ms(n){let e=V(n);if(e.ce===null){e.ce=[];let t=new Set;for(let s of e.explicitOrderBy)e.ce.push(s),t.add(s.field.canonicalString());let r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new ve(He.comparator);return o.filters.forEach(c=>{c.getFlattenedFilters().forEach(l=>{l.isInequality()&&(a=a.add(l.field))})}),a})(e).forEach(s=>{t.has(s.canonicalString())||s.isKeyField()||e.ce.push(new li(s,r))}),t.has(He.keyField().canonicalString())||e.ce.push(new li(He.keyField(),r))}return e.ce}function pt(n){let e=V(n);return e.le||(e.le=i1(e,ms(n))),e.le}function i1(n,e){if(n.limitType==="F")return rg(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(i=>{let s=i.dir==="desc"?"asc":"desc";return new li(i.field,s)});let t=n.endAt?new ln(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new ln(n.startAt.position,n.startAt.inclusive):null;return rg(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function ig(n,e){let t=n.filters.concat([e]);return new qt(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function ul(n,e,t){return new qt(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Ka(n,e){return Ha(pt(n),pt(e))&&n.limitType===e.limitType}function r0(n){return`${hi(pt(n))}|lt:${n.limitType}`}function ls(n){return`Query(target=${function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(i=>e0(i)).join(", ")}]`),Wa(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(i=>Is(i)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(i=>Is(i)).join(",")),`Target(${r})`}(pt(n))}; limitType=${n.limitType})`}function Qa(n,e){return e.isFoundDocument()&&function(r,i){let s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):B.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(n,e)&&function(r,i){for(let s of ms(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(n,e)&&function(r,i){for(let s of r.filters)if(!s.matches(i))return!1;return!0}(n,e)&&function(r,i){return!(r.startAt&&!function(o,a,c){let l=GI(o,a,c);return o.inclusive?l<=0:l<0}(r.startAt,ms(r),i)||r.endAt&&!function(o,a,c){let l=GI(o,a,c);return o.inclusive?l>=0:l>0}(r.endAt,ms(r),i))}(n,e)}function i0(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function s0(n){return(e,t)=>{let r=!1;for(let i of ms(n)){let s=s1(i,e,t);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function s1(n,e,t){let r=n.field.isKeyField()?B.comparator(e.key,t.key):function(s,o,a){let c=o.data.field(s),l=a.data.field(s);return c!==null&&l!==null?Tr(c,l):z()}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return z()}}var hn=class{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(let[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){let r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){_i(this.inner,(t,r)=>{for(let[i,s]of r)e(i,s)})}isEmpty(){return HT(this.inner)}size(){return this.innerSize}};var o1=new Te(B.comparator);function yt(){return o1}var o0=new Te(B.comparator);function ga(...n){let e=o0;for(let t of n)e=e.insert(t.key,t);return e}function a0(n){let e=o0;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function rn(){return _a()}function u0(){return _a()}function _a(){return new hn(n=>n.toString(),(n,e)=>n.isEqual(e))}var a1=new Te(B.comparator),u1=new ve(B.comparator);function ee(...n){let e=u1;for(let t of n)e=e.add(t);return e}var c1=new ve(Z);function Bm(){return c1}function $m(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ta(e)?"-0":e}}function c0(n){return{integerValue:""+n}}function l0(n,e){return jT(e)?c0(e):$m(n,e)}var As=class{constructor(){this._=void 0}};function l1(n,e,t){return n instanceof Ar?function(i,s){let o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&Hl(s)&&(s=Lm(s)),s&&(o.fields.__previous_value__=s),{mapValue:o}}(t,e):n instanceof Vn?d0(n,e):n instanceof Un?f0(n,e):function(i,s){let o=h0(i,s),a=YI(o)+YI(i.Pe);return Hp(o)&&Hp(i.Pe)?c0(a):$m(i.serializer,a)}(n,e)}function h1(n,e,t){return n instanceof Vn?d0(n,e):n instanceof Un?f0(n,e):t}function h0(n,e){return n instanceof br?function(r){return Hp(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}var Ar=class extends As{},Vn=class extends As{constructor(e){super(),this.elements=e}};function d0(n,e){let t=p0(e);for(let r of n.elements)t.some(i=>cn(i,r))||t.push(r);return{arrayValue:{values:t}}}var Un=class extends As{constructor(e){super(),this.elements=e}};function f0(n,e){let t=p0(e);for(let r of n.elements)t=t.filter(i=>!cn(i,r));return{arrayValue:{values:t}}}var br=class extends As{constructor(e,t){super(),this.serializer=e,this.Pe=t}};function YI(n){return Ae(n.integerValue||n.doubleValue)}function p0(n){return Sa(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}var di=class{constructor(e,t){this.field=e,this.transform=t}};function d1(n,e){return n.field.isEqual(e.field)&&function(r,i){return r instanceof Vn&&i instanceof Vn||r instanceof Un&&i instanceof Un?vs(r.elements,i.elements,cn):r instanceof br&&i instanceof br?cn(r.Pe,i.Pe):r instanceof Ar&&i instanceof Ar}(n.transform,e.transform)}var sg=class{constructor(e,t){this.version=e,this.transformResults=t}},Re=class n{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new n}static exists(e){return new n(void 0,e)}static updateTime(e){return new n(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function Kc(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}var bs=class{};function g0(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Sr(n.key,Re.none()):new Dr(n.key,n.data,Re.none());{let t=n.data,r=ct.empty(),i=new ve(He.comparator);for(let s of e.fields)if(!i.has(s)){let o=t.field(s);o===null&&s.length>1&&(s=s.popLast(),o=t.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new Gt(n.key,r,new bt(i.toArray()),Re.none())}}function f1(n,e,t){n instanceof Dr?function(i,s,o){let a=i.value.clone(),c=XI(i.fieldTransforms,s,o.transformResults);a.setAll(c),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(n,e,t):n instanceof Gt?function(i,s,o){if(!Kc(i.precondition,s))return void s.convertToUnknownDocument(o.version);let a=XI(i.fieldTransforms,s,o.transformResults),c=s.data;c.setAll(m0(i)),c.setAll(a),s.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(n,e,t):function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,t)}function va(n,e,t,r){return n instanceof Dr?function(s,o,a,c){if(!Kc(s.precondition,o))return a;let l=s.value.clone(),d=ZI(s.fieldTransforms,c,o);return l.setAll(d),o.convertToFoundDocument(o.version,l).setHasLocalMutations(),null}(n,e,t,r):n instanceof Gt?function(s,o,a,c){if(!Kc(s.precondition,o))return a;let l=ZI(s.fieldTransforms,c,o),d=o.data;return d.setAll(m0(s)),d.setAll(l),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),a===null?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(p=>p.field))}(n,e,t,r):function(s,o,a){return Kc(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(n,e,t)}function p1(n,e){let t=null;for(let r of n.fieldTransforms){let i=e.data.field(r.field),s=h0(r.transform,i||null);s!=null&&(t===null&&(t=ct.empty()),t.set(r.field,s))}return t||null}function JI(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&vs(r,i,(s,o)=>d1(s,o))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}var Dr=class extends bs{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}},Gt=class extends bs{constructor(e,t,r,i,s=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}};function m0(n){let e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){let r=n.data.field(t);e.set(t,r)}}),e}function XI(n,e,t){let r=new Map;G(n.length===t.length);for(let i=0;i<t.length;i++){let s=n[i],o=s.transform,a=e.data.field(s.field);r.set(s.field,h1(o,a,t[i]))}return r}function ZI(n,e,t){let r=new Map;for(let i of n){let s=i.transform,o=t.data.field(i.field);r.set(i.field,l1(s,o,e))}return r}var Sr=class extends bs{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},Ra=class extends bs{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var Ca=class{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){let r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){let s=this.mutations[i];s.key.isEqual(e.key)&&f1(s,e,r[i])}}applyToLocalView(e,t){for(let r of this.baseMutations)r.key.isEqual(e.key)&&(t=va(r,e,t,this.localWriteTime));for(let r of this.mutations)r.key.isEqual(e.key)&&(t=va(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let r=u0();return this.mutations.forEach(i=>{let s=e.get(i.key),o=s.overlayedDocument,a=this.applyToLocalView(o,s.mutatedFields);a=t.has(i.key)?null:a;let c=g0(o,a);c!==null&&r.set(i.key,c),o.isValidDocument()||o.convertToNoDocument(H.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),ee())}isEqual(e){return this.batchId===e.batchId&&vs(this.mutations,e.mutations,(t,r)=>JI(t,r))&&vs(this.baseMutations,e.baseMutations,(t,r)=>JI(t,r))}},og=class n{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){G(e.mutations.length===r.length);let i=function(){return a1}(),s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new n(e,t,r,i)}};var Pa=class{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var ag=class{constructor(e,t){this.count=e,this.unchangedNames=t}};var je,oe;function y0(n){switch(n){default:return z();case P.CANCELLED:case P.UNKNOWN:case P.DEADLINE_EXCEEDED:case P.RESOURCE_EXHAUSTED:case P.INTERNAL:case P.UNAVAILABLE:case P.UNAUTHENTICATED:return!1;case P.INVALID_ARGUMENT:case P.NOT_FOUND:case P.ALREADY_EXISTS:case P.PERMISSION_DENIED:case P.FAILED_PRECONDITION:case P.ABORTED:case P.OUT_OF_RANGE:case P.UNIMPLEMENTED:case P.DATA_LOSS:return!0}}function _0(n){if(n===void 0)return ke("GRPC error has no .code"),P.UNKNOWN;switch(n){case je.OK:return P.OK;case je.CANCELLED:return P.CANCELLED;case je.UNKNOWN:return P.UNKNOWN;case je.DEADLINE_EXCEEDED:return P.DEADLINE_EXCEEDED;case je.RESOURCE_EXHAUSTED:return P.RESOURCE_EXHAUSTED;case je.INTERNAL:return P.INTERNAL;case je.UNAVAILABLE:return P.UNAVAILABLE;case je.UNAUTHENTICATED:return P.UNAUTHENTICATED;case je.INVALID_ARGUMENT:return P.INVALID_ARGUMENT;case je.NOT_FOUND:return P.NOT_FOUND;case je.ALREADY_EXISTS:return P.ALREADY_EXISTS;case je.PERMISSION_DENIED:return P.PERMISSION_DENIED;case je.FAILED_PRECONDITION:return P.FAILED_PRECONDITION;case je.ABORTED:return P.ABORTED;case je.OUT_OF_RANGE:return P.OUT_OF_RANGE;case je.UNIMPLEMENTED:return P.UNIMPLEMENTED;case je.DATA_LOSS:return P.DATA_LOSS;default:return z()}}(oe=je||(je={}))[oe.OK=0]="OK",oe[oe.CANCELLED=1]="CANCELLED",oe[oe.UNKNOWN=2]="UNKNOWN",oe[oe.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",oe[oe.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",oe[oe.NOT_FOUND=5]="NOT_FOUND",oe[oe.ALREADY_EXISTS=6]="ALREADY_EXISTS",oe[oe.PERMISSION_DENIED=7]="PERMISSION_DENIED",oe[oe.UNAUTHENTICATED=16]="UNAUTHENTICATED",oe[oe.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",oe[oe.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",oe[oe.ABORTED=10]="ABORTED",oe[oe.OUT_OF_RANGE=11]="OUT_OF_RANGE",oe[oe.UNIMPLEMENTED=12]="UNIMPLEMENTED",oe[oe.INTERNAL=13]="INTERNAL",oe[oe.UNAVAILABLE=14]="UNAVAILABLE",oe[oe.DATA_LOSS=15]="DATA_LOSS";var eT=null;function v0(){return new TextEncoder}var g1=new pr([4294967295,4294967295],0);function tT(n){let e=v0().encode(n),t=new Ip;return t.update(e),new Uint8Array(t.digest())}function nT(n){let e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new pr([t,r],0),new pr([i,s],0)]}var ug=class n{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new oi(`Invalid padding: ${t}`);if(r<0)throw new oi(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new oi(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new oi(`Invalid padding when bitmap length is 0: ${t}`);this.Ie=8*e.length-t,this.Te=pr.fromNumber(this.Ie)}Ee(e,t,r){let i=e.add(t.multiply(pr.fromNumber(r)));return i.compare(g1)===1&&(i=new pr([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;let t=tT(e),[r,i]=nT(t);for(let s=0;s<this.hashCount;s++){let o=this.Ee(r,i,s);if(!this.de(o))return!1}return!0}static create(e,t,r){let i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new n(s,i,t);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.Ie===0)return;let t=tT(e),[r,i]=nT(t);for(let s=0;s<this.hashCount;s++){let o=this.Ee(r,i,s);this.Ae(o)}}Ae(e){let t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}},oi=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var Na=class n{constructor(e,t,r,i,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,r){let i=new Map;return i.set(e,ka.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new n(H.min(),i,new Te(Z),yt(),ee())}},ka=class n{constructor(e,t,r,i,s){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new n(r,t,ee(),ee(),ee())}};var ys=class{constructor(e,t,r,i){this.Re=e,this.removedTargetIds=t,this.key=r,this.Ve=i}},cl=class{constructor(e,t){this.targetId=e,this.me=t}},ll=class{constructor(e,t,r=Fe.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}},hl=class{constructor(){this.fe=0,this.ge=iT(),this.pe=Fe.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=ee(),t=ee(),r=ee();return this.ge.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:z()}}),new ka(this.pe,this.ye,e,t,r)}Ce(){this.we=!1,this.ge=iT()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,G(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}},cg=class{constructor(e){this.Le=e,this.Be=new Map,this.ke=yt(),this.qe=rT(),this.Qe=new Te(Z)}Ke(e){for(let t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(t,e.Ve):this.Ue(t,e.key,e.Ve);for(let t of e.removedTargetIds)this.Ue(t,e.key,e.Ve)}We(e){this.forEachTarget(e,t=>{let r=this.Ge(t);switch(e.state){case 0:this.ze(t)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(t);break;case 3:this.ze(t)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(t)&&(this.je(t),r.De(e.resumeToken));break;default:z()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Be.forEach((r,i)=>{this.ze(i)&&t(i)})}He(e){let t=e.targetId,r=e.me.count,i=this.Je(t);if(i){let s=i.target;if(ol(s))if(r===0){let o=new B(s.path);this.Ue(t,o,We.newNoDocument(o,H.min()))}else G(r===1);else{let o=this.Ye(t);if(o!==r){let a=this.Ze(e),c=a?this.Xe(a,e,o):1;if(c!==0){this.je(t);let l=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(t,l)}eT?.et(function(d,p,m,w,D){var k,S,x,$,F,U;let J={localCacheCount:d,existenceFilterCount:p.count,databaseId:m.database,projectId:m.projectId},W=p.unchangedNames;return W&&(J.bloomFilter={applied:D===0,hashCount:(k=W?.hashCount)!==null&&k!==void 0?k:0,bitmapLength:($=(x=(S=W?.bits)===null||S===void 0?void 0:S.bitmap)===null||x===void 0?void 0:x.length)!==null&&$!==void 0?$:0,padding:(U=(F=W?.bits)===null||F===void 0?void 0:F.padding)!==null&&U!==void 0?U:0,mightContain:I=>{var _;return(_=w?.mightContain(I))!==null&&_!==void 0&&_}}),J}(o,e.me,this.Le.tt(),a,c))}}}}Ze(e){let t=e.me.unchangedNames;if(!t||!t.bits)return null;let{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=t,o,a;try{o=Ir(r).toUint8Array()}catch(c){if(c instanceof rl)return un("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{a=new ug(o,i,s)}catch(c){return un(c instanceof oi?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return a.Ie===0?null:a}Xe(e,t,r){return t.me.count===r-this.nt(e,t.targetId)?0:2}nt(e,t){let r=this.Le.getRemoteKeysForTarget(t),i=0;return r.forEach(s=>{let o=this.Le.tt(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(a)||(this.Ue(t,s,null),i++)}),i}rt(e){let t=new Map;this.Be.forEach((s,o)=>{let a=this.Je(o);if(a){if(s.current&&ol(a.target)){let c=new B(a.target.path);this.ke.get(c)!==null||this.it(o,c)||this.Ue(o,c,We.newNoDocument(c,e))}s.be&&(t.set(o,s.ve()),s.Ce())}});let r=ee();this.qe.forEach((s,o)=>{let a=!0;o.forEachWhile(c=>{let l=this.Je(c);return!l||l.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(s))}),this.ke.forEach((s,o)=>o.setReadTime(e));let i=new Na(e,t,this.Qe,this.ke,r);return this.ke=yt(),this.qe=rT(),this.Qe=new Te(Z),i}$e(e,t){if(!this.ze(e))return;let r=this.it(e,t.key)?2:0;this.Ge(e).Fe(t.key,r),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e))}Ue(e,t,r){if(!this.ze(e))return;let i=this.Ge(e);this.it(e,t)?i.Fe(t,1):i.Me(t),this.qe=this.qe.insert(t,this.st(t).delete(e)),r&&(this.ke=this.ke.insert(t,r))}removeTarget(e){this.Be.delete(e)}Ye(e){let t=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let t=this.Be.get(e);return t||(t=new hl,this.Be.set(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new ve(Z),this.qe=this.qe.insert(e,t)),t}ze(e){let t=this.Je(e)!==null;return t||O("WatchChangeAggregator","Detected inactive target",e),t}Je(e){let t=this.Be.get(e);return t&&t.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new hl),this.Le.getRemoteKeysForTarget(e).forEach(t=>{this.Ue(e,t,null)})}it(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}};function rT(){return new Te(B.comparator)}function iT(){return new Te(B.comparator)}var m1={asc:"ASCENDING",desc:"DESCENDING"},y1={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},_1={and:"AND",or:"OR"},lg=class{constructor(e,t){this.databaseId=e,this.useProto3Json=t}};function hg(n,e){return n.useProto3Json||Wa(e)?e:{value:e}}function Ds(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function w0(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function v1(n,e){return Ds(n,e.toTimestamp())}function Me(n){return G(!!n),H.fromTimestamp(function(t){let r=Ln(t);return new Oe(r.seconds,r.nanos)}(n))}function jm(n,e){return dg(n,e).canonicalString()}function dg(n,e){let t=function(i){return new ae(["projects",i.projectId,"databases",i.database])}(n).child("documents");return e===void 0?t:t.child(e)}function E0(n){let e=ae.fromString(n);return G(N0(e)),e}function Oa(n,e){return jm(n.databaseId,e.path)}function on(n,e){let t=E0(e);if(t.get(1)!==n.databaseId.projectId)throw new M(P.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new M(P.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new B(A0(t))}function I0(n,e){return jm(n.databaseId,e)}function T0(n){let e=E0(n);return e.length===4?ae.emptyPath():A0(e)}function fg(n){return new ae(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function A0(n){return G(n.length>4&&n.get(4)==="documents"),n.popFirst(5)}function sT(n,e,t){return{name:Oa(n,e),fields:t.value.mapValue.fields}}function b0(n,e,t){let r=on(n,e.name),i=Me(e.updateTime),s=e.createTime?Me(e.createTime):H.min(),o=new ct({mapValue:{fields:e.fields}}),a=We.newFoundDocument(r,i,s,o);return t&&a.setHasCommittedMutations(),t?a.setHasCommittedMutations():a}function w1(n,e){return"found"in e?function(r,i){G(!!i.found),i.found.name,i.found.updateTime;let s=on(r,i.found.name),o=Me(i.found.updateTime),a=i.found.createTime?Me(i.found.createTime):H.min(),c=new ct({mapValue:{fields:i.found.fields}});return We.newFoundDocument(s,o,a,c)}(n,e):"missing"in e?function(r,i){G(!!i.missing),G(!!i.readTime);let s=on(r,i.missing),o=Me(i.readTime);return We.newNoDocument(s,o)}(n,e):z()}function E1(n,e){let t;if("targetChange"in e){e.targetChange;let r=function(l){return l==="NO_CHANGE"?0:l==="ADD"?1:l==="REMOVE"?2:l==="CURRENT"?3:l==="RESET"?4:z()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(l,d){return l.useProto3Json?(G(d===void 0||typeof d=="string"),Fe.fromBase64String(d||"")):(G(d===void 0||d instanceof Buffer||d instanceof Uint8Array),Fe.fromUint8Array(d||new Uint8Array))}(n,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(l){let d=l.code===void 0?P.UNKNOWN:_0(l.code);return new M(d,l.message||"")}(o);t=new ll(r,i,s,a||null)}else if("documentChange"in e){e.documentChange;let r=e.documentChange;r.document,r.document.name,r.document.updateTime;let i=on(n,r.document.name),s=Me(r.document.updateTime),o=r.document.createTime?Me(r.document.createTime):H.min(),a=new ct({mapValue:{fields:r.document.fields}}),c=We.newFoundDocument(i,s,o,a),l=r.targetIds||[],d=r.removedTargetIds||[];t=new ys(l,d,c.key,c)}else if("documentDelete"in e){e.documentDelete;let r=e.documentDelete;r.document;let i=on(n,r.document),s=r.readTime?Me(r.readTime):H.min(),o=We.newNoDocument(i,s),a=r.removedTargetIds||[];t=new ys([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;let r=e.documentRemove;r.document;let i=on(n,r.document),s=r.removedTargetIds||[];t=new ys([],s,i,null)}else{if(!("filter"in e))return z();{e.filter;let r=e.filter;r.targetId;let{count:i=0,unchangedNames:s}=r,o=new ag(i,s),a=r.targetId;t=new cl(a,o)}}return t}function Ma(n,e){let t;if(e instanceof Dr)t={update:sT(n,e.key,e.value)};else if(e instanceof Sr)t={delete:Oa(n,e.key)};else if(e instanceof Gt)t={update:sT(n,e.key,e.data),updateMask:S1(e.fieldMask)};else{if(!(e instanceof Ra))return z();t={verify:Oa(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(s,o){let a=o.transform;if(a instanceof Ar)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof Vn)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof Un)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof br)return{fieldPath:o.field.canonicalString(),increment:a.Pe};throw z()}(0,r))),e.precondition.isNone||(t.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:v1(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:z()}(n,e.precondition)),t}function pg(n,e){let t=e.currentDocument?function(s){return s.updateTime!==void 0?Re.updateTime(Me(s.updateTime)):s.exists!==void 0?Re.exists(s.exists):Re.none()}(e.currentDocument):Re.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(o,a){let c=null;if("setToServerValue"in a)G(a.setToServerValue==="REQUEST_TIME"),c=new Ar;else if("appendMissingElements"in a){let d=a.appendMissingElements.values||[];c=new Vn(d)}else if("removeAllFromArray"in a){let d=a.removeAllFromArray.values||[];c=new Un(d)}else"increment"in a?c=new br(o,a.increment):z();let l=He.fromServerFormat(a.fieldPath);return new di(l,c)}(n,i)):[];if(e.update){e.update.name;let i=on(n,e.update.name),s=new ct({mapValue:{fields:e.update.fields}});if(e.updateMask){let o=function(c){let l=c.fieldPaths||[];return new bt(l.map(d=>He.fromServerFormat(d)))}(e.updateMask);return new Gt(i,s,o,t,r)}return new Dr(i,s,t,r)}if(e.delete){let i=on(n,e.delete);return new Sr(i,t)}if(e.verify){let i=on(n,e.verify);return new Ra(i,t)}return z()}function I1(n,e){return n&&n.length>0?(G(e!==void 0),n.map(t=>function(i,s){let o=i.updateTime?Me(i.updateTime):Me(s);return o.isEqual(H.min())&&(o=Me(s)),new sg(o,i.transformResults||[])}(t,e))):[]}function D0(n,e){return{documents:[I0(n,e.path)]}}function S0(n,e){let t={structuredQuery:{}},r=e.path,i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=I0(n,i);let s=function(l){if(l.length!==0)return P0(ge.create(l,"and"))}(e.filters);s&&(t.structuredQuery.where=s);let o=function(l){if(l.length!==0)return l.map(d=>function(m){return{field:hs(m.field),direction:A1(m.dir)}}(d))}(e.orderBy);o&&(t.structuredQuery.orderBy=o);let a=hg(n,e.limit);return a!==null&&(t.structuredQuery.limit=a),e.startAt&&(t.structuredQuery.startAt=function(l){return{before:l.inclusive,values:l.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(l){return{before:!l.inclusive,values:l.position}}(e.endAt)),{_t:t,parent:i}}function R0(n){let e=T0(n.parent),t=n.structuredQuery,r=t.from?t.from.length:0,i=null;if(r>0){G(r===1);let d=t.from[0];d.allDescendants?i=d.collectionId:e=e.child(d.collectionId)}let s=[];t.where&&(s=function(p){let m=C0(p);return m instanceof ge&&Vm(m)?m.getFilters():[m]}(t.where));let o=[];t.orderBy&&(o=function(p){return p.map(m=>function(D){return new li(ds(D.field),function(S){switch(S){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(D.direction))}(m))}(t.orderBy));let a=null;t.limit&&(a=function(p){let m;return m=typeof p=="object"?p.value:p,Wa(m)?null:m}(t.limit));let c=null;t.startAt&&(c=function(p){let m=!!p.before,w=p.values||[];return new ln(w,m)}(t.startAt));let l=null;return t.endAt&&(l=function(p){let m=!p.before,w=p.values||[];return new ln(w,m)}(t.endAt)),n0(e,i,o,s,a,"F",c,l)}function T1(n,e){let t=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return z()}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function C0(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":let r=ds(t.unaryFilter.field);return se.create(r,"==",{doubleValue:NaN});case"IS_NULL":let i=ds(t.unaryFilter.field);return se.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let s=ds(t.unaryFilter.field);return se.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let o=ds(t.unaryFilter.field);return se.create(o,"!=",{nullValue:"NULL_VALUE"});default:return z()}}(n):n.fieldFilter!==void 0?function(t){return se.create(ds(t.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return z()}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return ge.create(t.compositeFilter.filters.map(r=>C0(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return z()}}(t.compositeFilter.op))}(n):z()}function A1(n){return m1[n]}function b1(n){return y1[n]}function D1(n){return _1[n]}function hs(n){return{fieldPath:n.canonicalString()}}function ds(n){return He.fromServerFormat(n.fieldPath)}function P0(n){return n instanceof se?function(t){if(t.op==="=="){if(jI(t.value))return{unaryFilter:{field:hs(t.field),op:"IS_NAN"}};if($I(t.value))return{unaryFilter:{field:hs(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(jI(t.value))return{unaryFilter:{field:hs(t.field),op:"IS_NOT_NAN"}};if($I(t.value))return{unaryFilter:{field:hs(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:hs(t.field),op:b1(t.op),value:t.value}}}(n):n instanceof ge?function(t){let r=t.getFilters().map(i=>P0(i));return r.length===1?r[0]:{compositeFilter:{op:D1(t.op),filters:r}}}(n):z()}function S1(n){let e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function N0(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}var Ss=class n{constructor(e,t,r,i,s=H.min(),o=H.min(),a=Fe.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=c}withSequenceNumber(e){return new n(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var dl=class{constructor(e){this.ct=e}};function R1(n,e){let t;if(e.document)t=b0(n.ct,e.document,!!e.hasCommittedMutations);else if(e.noDocument){let r=B.fromSegments(e.noDocument.path),i=pi(e.noDocument.readTime);t=We.newNoDocument(r,i),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return z();{let r=B.fromSegments(e.unknownDocument.path),i=pi(e.unknownDocument.version);t=We.newUnknownDocument(r,i)}}return e.readTime&&t.setReadTime(function(i){let s=new Oe(i[0],i[1]);return H.fromTimestamp(s)}(e.readTime)),t}function oT(n,e){let t=e.key,r={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:fl(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(s,o){return{name:Oa(s,o.key),fields:o.data.value.mapValue.fields,updateTime:Ds(s,o.version.toTimestamp()),createTime:Ds(s,o.createTime.toTimestamp())}}(n.ct,e);else if(e.isNoDocument())r.noDocument={path:t.path.toArray(),readTime:fi(e.version)};else{if(!e.isUnknownDocument())return z();r.unknownDocument={path:t.path.toArray(),version:fi(e.version)}}return r}function fl(n){let e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function fi(n){let e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function pi(n){let e=new Oe(n.seconds,n.nanoseconds);return H.fromTimestamp(e)}function ri(n,e){let t=(e.baseMutations||[]).map(s=>pg(n.ct,s));for(let s=0;s<e.mutations.length-1;++s){let o=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){let a=e.mutations[s+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}let r=e.mutations.map(s=>pg(n.ct,s)),i=Oe.fromMillis(e.localWriteTimeMs);return new Ca(e.batchId,i,t,r)}function ma(n){let e=pi(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?pi(n.lastLimboFreeSnapshotVersion):H.min(),r;return r=function(s){return s.documents!==void 0}(n.query)?function(s){return G(s.documents.length===1),pt(Vs(T0(s.documents[0])))}(n.query):function(s){return pt(R0(s))}(n.query),new Ss(r,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,Fe.fromBase64String(n.resumeToken))}function k0(n,e){let t=fi(e.snapshotVersion),r=fi(e.lastLimboFreeSnapshotVersion),i;i=ol(e.target)?D0(n.ct,e.target):S0(n.ct,e.target)._t;let s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:hi(e.target),readTime:t,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function zm(n){let e=R0({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?ul(e,e.limit,"L"):e}function Cp(n,e){return new Pa(e.largestBatchId,pg(n.ct,e.overlayMutation))}function aT(n,e){let t=e.path.lastSegment();return[n,ft(e.path.popLast()),t]}function uT(n,e,t,r){return{indexId:n,uid:e,sequenceNumber:t,readTime:fi(r.readTime),documentKey:ft(r.documentKey.path),largestBatchId:r.largestBatchId}}var gg=class{getBundleMetadata(e,t){return cT(e).get(t).next(r=>{if(r)return function(s){return{id:s.bundleId,createTime:pi(s.createTime),version:s.version}}(r)})}saveBundleMetadata(e,t){return cT(e).put(function(i){return{bundleId:i.id,createTime:fi(Me(i.createTime)),version:i.version}}(t))}getNamedQuery(e,t){return lT(e).get(t).next(r=>{if(r)return function(s){return{name:s.name,query:zm(s.bundledQuery),readTime:pi(s.readTime)}}(r)})}saveNamedQuery(e,t){return lT(e).put(function(i){return{name:i.name,readTime:fi(Me(i.readTime)),bundledQuery:i.bundledQuery}}(t))}};function cT(n){return Ke(n,"bundles")}function lT(n){return Ke(n,"namedQueries")}var pl=class n{constructor(e,t){this.serializer=e,this.userId=t}static lt(e,t){let r=t.uid||"";return new n(e,r)}getOverlay(e,t){return ha(e).get(aT(this.userId,t)).next(r=>r?Cp(this.serializer,r):null)}getOverlays(e,t){let r=rn();return C.forEach(t,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,t,r){let i=[];return r.forEach((s,o)=>{let a=new Pa(t,o);i.push(this.ht(e,a))}),C.waitFor(i)}removeOverlaysForBatchId(e,t,r){let i=new Set;t.forEach(o=>i.add(ft(o.getCollectionPath())));let s=[];return i.forEach(o=>{let a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);s.push(ha(e).j("collectionPathOverlayIndex",a))}),C.waitFor(s)}getOverlaysForCollection(e,t,r){let i=rn(),s=ft(t),o=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,Number.POSITIVE_INFINITY],!0);return ha(e).U("collectionPathOverlayIndex",o).next(a=>{for(let c of a){let l=Cp(this.serializer,c);i.set(l.getKey(),l)}return i})}getOverlaysForCollectionGroup(e,t,r,i){let s=rn(),o,a=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,Number.POSITIVE_INFINITY],!0);return ha(e).J({index:"collectionGroupOverlayIndex",range:a},(c,l,d)=>{let p=Cp(this.serializer,l);s.size()<i||p.largestBatchId===o?(s.set(p.getKey(),p),o=p.largestBatchId):d.done()}).next(()=>s)}ht(e,t){return ha(e).put(function(i,s,o){let[a,c,l]=aT(s,o.mutation.key);return{userId:s,collectionPath:c,documentId:l,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:Ma(i.ct,o.mutation)}}(this.serializer,this.userId,t))}};function ha(n){return Ke(n,"documentOverlays")}var mg=class{Pt(e){return Ke(e,"globals")}getSessionToken(e){return this.Pt(e).get("sessionToken").next(t=>{let r=t?.value;return r?Fe.fromUint8Array(r):Fe.EMPTY_BYTE_STRING})}setSessionToken(e,t){return this.Pt(e).put({name:"sessionToken",value:t.toUint8Array()})}};var xn=class{constructor(){}It(e,t){this.Tt(e,t),t.Et()}Tt(e,t){if("nullValue"in e)this.dt(t,5);else if("booleanValue"in e)this.dt(t,10),t.At(e.booleanValue?1:0);else if("integerValue"in e)this.dt(t,15),t.At(Ae(e.integerValue));else if("doubleValue"in e){let r=Ae(e.doubleValue);isNaN(r)?this.dt(t,13):(this.dt(t,15),Ta(r)?t.At(0):t.At(r))}else if("timestampValue"in e){let r=e.timestampValue;this.dt(t,20),typeof r=="string"&&(r=Ln(r)),t.Rt(`${r.seconds||""}`),t.At(r.nanos||0)}else if("stringValue"in e)this.Vt(e.stringValue,t),this.ft(t);else if("bytesValue"in e)this.dt(t,30),t.gt(Ir(e.bytesValue)),this.ft(t);else if("referenceValue"in e)this.yt(e.referenceValue,t);else if("geoPointValue"in e){let r=e.geoPointValue;this.dt(t,45),t.At(r.latitude||0),t.At(r.longitude||0)}else"mapValue"in e?KT(e)?this.dt(t,Number.MAX_SAFE_INTEGER):Kl(e)?this.wt(e.mapValue,t):(this.St(e.mapValue,t),this.ft(t)):"arrayValue"in e?(this.bt(e.arrayValue,t),this.ft(t)):z()}Vt(e,t){this.dt(t,25),this.Dt(e,t)}Dt(e,t){t.Rt(e)}St(e,t){let r=e.fields||{};this.dt(t,55);for(let i of Object.keys(r))this.Vt(i,t),this.Tt(r[i],t)}wt(e,t){var r,i;let s=e.fields||{};this.dt(t,53);let o="value",a=((i=(r=s[o].arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.length)||0;this.dt(t,15),t.At(Ae(a)),this.Vt(o,t),this.Tt(s[o],t)}bt(e,t){let r=e.values||[];this.dt(t,50);for(let i of r)this.Tt(i,t)}yt(e,t){this.dt(t,37),B.fromName(e).path.forEach(r=>{this.dt(t,60),this.Dt(r,t)})}dt(e,t){e.At(t)}ft(e){e.At(2)}};xn.vt=new xn;function C1(n){if(n===0)return 8;let e=0;return!(n>>4)&&(e+=4,n<<=4),!(n>>6)&&(e+=2,n<<=2),!(n>>7)&&(e+=1),e}function hT(n){let e=64-function(r){let i=0;for(let s=0;s<8;++s){let o=C1(255&r[s]);if(i+=o,o!==8)break}return i}(n);return Math.ceil(e/8)}var yg=class{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Ct(e){let t=e[Symbol.iterator](),r=t.next();for(;!r.done;)this.Ft(r.value),r=t.next();this.Mt()}xt(e){let t=e[Symbol.iterator](),r=t.next();for(;!r.done;)this.Ot(r.value),r=t.next();this.Nt()}Lt(e){for(let t of e){let r=t.charCodeAt(0);if(r<128)this.Ft(r);else if(r<2048)this.Ft(960|r>>>6),this.Ft(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Ft(480|r>>>12),this.Ft(128|63&r>>>6),this.Ft(128|63&r);else{let i=t.codePointAt(0);this.Ft(240|i>>>18),this.Ft(128|63&i>>>12),this.Ft(128|63&i>>>6),this.Ft(128|63&i)}}this.Mt()}Bt(e){for(let t of e){let r=t.charCodeAt(0);if(r<128)this.Ot(r);else if(r<2048)this.Ot(960|r>>>6),this.Ot(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Ot(480|r>>>12),this.Ot(128|63&r>>>6),this.Ot(128|63&r);else{let i=t.codePointAt(0);this.Ot(240|i>>>18),this.Ot(128|63&i>>>12),this.Ot(128|63&i>>>6),this.Ot(128|63&i)}}this.Nt()}kt(e){let t=this.qt(e),r=hT(t);this.Qt(1+r),this.buffer[this.position++]=255&r;for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=255&t[i]}Kt(e){let t=this.qt(e),r=hT(t);this.Qt(1+r),this.buffer[this.position++]=~(255&r);for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=~(255&t[i])}$t(){this.Ut(255),this.Ut(255)}Wt(){this.Gt(255),this.Gt(255)}reset(){this.position=0}seed(e){this.Qt(e.length),this.buffer.set(e,this.position),this.position+=e.length}zt(){return this.buffer.slice(0,this.position)}qt(e){let t=function(s){let o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,s,!1),new Uint8Array(o.buffer)}(e),r=(128&t[0])!=0;t[0]^=r?255:128;for(let i=1;i<t.length;++i)t[i]^=r?255:0;return t}Ft(e){let t=255&e;t===0?(this.Ut(0),this.Ut(255)):t===255?(this.Ut(255),this.Ut(0)):this.Ut(t)}Ot(e){let t=255&e;t===0?(this.Gt(0),this.Gt(255)):t===255?(this.Gt(255),this.Gt(0)):this.Gt(e)}Mt(){this.Ut(0),this.Ut(1)}Nt(){this.Gt(0),this.Gt(1)}Ut(e){this.Qt(1),this.buffer[this.position++]=e}Gt(e){this.Qt(1),this.buffer[this.position++]=~e}Qt(e){let t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);let i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}},_g=class{constructor(e){this.jt=e}gt(e){this.jt.Ct(e)}Rt(e){this.jt.Lt(e)}At(e){this.jt.kt(e)}Et(){this.jt.$t()}},vg=class{constructor(e){this.jt=e}gt(e){this.jt.xt(e)}Rt(e){this.jt.Bt(e)}At(e){this.jt.Kt(e)}Et(){this.jt.Wt()}},ii=class{constructor(){this.jt=new yg,this.Ht=new _g(this.jt),this.Jt=new vg(this.jt)}seed(e){this.jt.seed(e)}Yt(e){return e===0?this.Ht:this.Jt}zt(){return this.jt.zt()}reset(){this.jt.reset()}};var si=class n{constructor(e,t,r,i){this.indexId=e,this.documentKey=t,this.arrayValue=r,this.directionalValue=i}Zt(){let e=this.directionalValue.length,t=e===0||this.directionalValue[e-1]===255?e+1:e,r=new Uint8Array(t);return r.set(this.directionalValue,0),t!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new n(this.indexId,this.documentKey,this.arrayValue,r)}};function gr(n,e){let t=n.indexId-e.indexId;return t!==0?t:(t=dT(n.arrayValue,e.arrayValue),t!==0?t:(t=dT(n.directionalValue,e.directionalValue),t!==0?t:B.comparator(n.documentKey,e.documentKey)))}function dT(n,e){for(let t=0;t<n.length&&t<e.length;++t){let r=n[t]-e[t];if(r!==0)return r}return n.length-e.length}var gl=class{constructor(e){this.Xt=new ve((t,r)=>He.comparator(t.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.en=e.orderBy,this.tn=[];for(let t of e.filters){let r=t;r.isInequality()?this.Xt=this.Xt.add(r):this.tn.push(r)}}get nn(){return this.Xt.size>1}rn(e){if(G(e.collectionGroup===this.collectionId),this.nn)return!1;let t=Bp(e);if(t!==void 0&&!this.sn(t))return!1;let r=ti(e),i=new Set,s=0,o=0;for(;s<r.length&&this.sn(r[s]);++s)i=i.add(r[s].fieldPath.canonicalString());if(s===r.length)return!0;if(this.Xt.size>0){let a=this.Xt.getIterator().getNext();if(!i.has(a.field.canonicalString())){let c=r[s];if(!this.on(a,c)||!this._n(this.en[o++],c))return!1}++s}for(;s<r.length;++s){let a=r[s];if(o>=this.en.length||!this._n(this.en[o++],a))return!1}return!0}an(){if(this.nn)return null;let e=new ve(He.comparator),t=[];for(let r of this.tn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")t.push(new gs(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),t.push(new gs(r.field,0))}for(let r of this.en)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),t.push(new gs(r.field,r.dir==="asc"?0:1)));return new ws(ws.UNKNOWN_ID,this.collectionId,t,Ia.empty())}sn(e){for(let t of this.tn)if(this.on(t,e))return!0;return!1}on(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;let r=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===r}_n(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}};function O0(n){var e,t;if(G(n instanceof se||n instanceof ge),n instanceof se){if(n instanceof sl){let i=((t=(e=n.value.arrayValue)===null||e===void 0?void 0:e.values)===null||t===void 0?void 0:t.map(s=>se.create(n.field,"==",s)))||[];return ge.create(i,"or")}return n}let r=n.filters.map(i=>O0(i));return ge.create(r,n.op)}function P1(n){if(n.getFilters().length===0)return[];let e=Ig(O0(n));return G(M0(e)),wg(e)||Eg(e)?[e]:e.getFilters()}function wg(n){return n instanceof se}function Eg(n){return n instanceof ge&&Vm(n)}function M0(n){return wg(n)||Eg(n)||function(t){if(t instanceof ge&&Kp(t)){for(let r of t.getFilters())if(!wg(r)&&!Eg(r))return!1;return!0}return!1}(n)}function Ig(n){if(G(n instanceof se||n instanceof ge),n instanceof se)return n;if(n.filters.length===1)return Ig(n.filters[0]);let e=n.filters.map(r=>Ig(r)),t=ge.create(e,n.op);return t=ml(t),M0(t)?t:(G(t instanceof ge),G(Ts(t)),G(t.filters.length>1),t.filters.reduce((r,i)=>qm(r,i)))}function qm(n,e){let t;return G(n instanceof se||n instanceof ge),G(e instanceof se||e instanceof ge),t=n instanceof se?e instanceof se?function(i,s){return ge.create([i,s],"and")}(n,e):fT(n,e):e instanceof se?fT(e,n):function(i,s){if(G(i.filters.length>0&&s.filters.length>0),Ts(i)&&Ts(s))return ZT(i,s.getFilters());let o=Kp(i)?i:s,a=Kp(i)?s:i,c=o.filters.map(l=>qm(l,a));return ge.create(c,"or")}(n,e),ml(t)}function fT(n,e){if(Ts(e))return ZT(e,n.getFilters());{let t=e.filters.map(r=>qm(n,r));return ge.create(t,"or")}}function ml(n){if(G(n instanceof se||n instanceof ge),n instanceof se)return n;let e=n.getFilters();if(e.length===1)return ml(e[0]);if(JT(n))return n;let t=e.map(i=>ml(i)),r=[];return t.forEach(i=>{i instanceof se?r.push(i):i instanceof ge&&(i.op===n.op?r.push(...i.filters):r.push(i))}),r.length===1?r[0]:ge.create(r,n.op)}var Tg=class{constructor(){this.un=new xa}addToCollectionParentIndex(e,t){return this.un.add(t),C.resolve()}getCollectionParents(e,t){return C.resolve(this.un.getEntries(t))}addFieldIndex(e,t){return C.resolve()}deleteFieldIndex(e,t){return C.resolve()}deleteAllFieldIndexes(e){return C.resolve()}createTargetIndexes(e,t){return C.resolve()}getDocumentsMatchingTarget(e,t){return C.resolve(null)}getIndexType(e,t){return C.resolve(0)}getFieldIndexes(e,t){return C.resolve([])}getNextCollectionGroupToUpdate(e){return C.resolve(null)}getMinOffset(e,t){return C.resolve(Ft.min())}getMinOffsetFromCollectionGroup(e,t){return C.resolve(Ft.min())}updateCollectionGroup(e,t,r){return C.resolve()}updateIndexEntries(e,t){return C.resolve()}},xa=class{constructor(){this.index={}}add(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new ve(ae.comparator),s=!i.has(r);return this.index[t]=i.add(r),s}has(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new ve(ae.comparator)).toArray()}};var $c=new Uint8Array(0),Ag=class{constructor(e,t){this.databaseId=t,this.cn=new xa,this.ln=new hn(r=>hi(r),(r,i)=>Ha(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.cn.has(t)){let r=t.lastSegment(),i=t.popLast();e.addOnCommittedListener(()=>{this.cn.add(t)});let s={collectionId:r,parent:ft(i)};return pT(e).put(s)}return C.resolve()}getCollectionParents(e,t){let r=[],i=IDBKeyRange.bound([t,""],[LT(t),""],!1,!0);return pT(e).U(i).next(s=>{for(let o of s){if(o.collectionId!==t)break;r.push(nn(o.parent))}return r})}addFieldIndex(e,t){let r=da(e),i=function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(c=>[c.fieldPath.canonicalString(),c.kind])}}(t);delete i.indexId;let s=r.add(i);if(t.indexState){let o=as(e);return s.next(a=>{o.put(uT(a,this.uid,t.indexState.sequenceNumber,t.indexState.offset))})}return s.next()}deleteFieldIndex(e,t){let r=da(e),i=as(e),s=os(e);return r.delete(t.indexId).next(()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){let t=da(e),r=os(e),i=as(e);return t.j().next(()=>r.j()).next(()=>i.j())}createTargetIndexes(e,t){return C.forEach(this.hn(t),r=>this.getIndexType(e,r).next(i=>{if(i===0||i===1){let s=new gl(r).an();if(s!=null)return this.addFieldIndex(e,s)}}))}getDocumentsMatchingTarget(e,t){let r=os(e),i=!0,s=new Map;return C.forEach(this.hn(t),o=>this.Pn(e,o).next(a=>{i&&(i=!!a),s.set(o,a)})).next(()=>{if(i){let o=ee(),a=[];return C.forEach(s,(c,l)=>{O("IndexedDbIndexManager",`Using index ${function(F){return`id=${F.indexId}|cg=${F.collectionGroup}|f=${F.fields.map(U=>`${U.fieldPath}:${U.kind}`).join(",")}`}(c)} to execute ${hi(t)}`);let d=function(F,U){let J=Bp(U);if(J===void 0)return null;for(let W of al(F,J.fieldPath))switch(W.op){case"array-contains-any":return W.value.arrayValue.values||[];case"array-contains":return[W.value]}return null}(l,c),p=function(F,U){let J=new Map;for(let W of ti(U))for(let I of al(F,W.fieldPath))switch(I.op){case"==":case"in":J.set(W.fieldPath.canonicalString(),I.value);break;case"not-in":case"!=":return J.set(W.fieldPath.canonicalString(),I.value),Array.from(J.values())}return null}(l,c),m=function(F,U){let J=[],W=!0;for(let I of ti(U)){let _=I.kind===0?HI(F,I.fieldPath,F.startAt):KI(F,I.fieldPath,F.startAt);J.push(_.value),W&&(W=_.inclusive)}return new ln(J,W)}(l,c),w=function(F,U){let J=[],W=!0;for(let I of ti(U)){let _=I.kind===0?KI(F,I.fieldPath,F.endAt):HI(F,I.fieldPath,F.endAt);J.push(_.value),W&&(W=_.inclusive)}return new ln(J,W)}(l,c),D=this.In(c,l,m),k=this.In(c,l,w),S=this.Tn(c,l,p),x=this.En(c.indexId,d,D,m.inclusive,k,w.inclusive,S);return C.forEach(x,$=>r.G($,t.limit).next(F=>{F.forEach(U=>{let J=B.fromSegments(U.documentKey);o.has(J)||(o=o.add(J),a.push(J))})}))}).next(()=>a)}return C.resolve(null)})}hn(e){let t=this.ln.get(e);return t||(e.filters.length===0?t=[e]:t=P1(ge.create(e.filters,"and")).map(r=>rg(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.ln.set(e,t),t)}En(e,t,r,i,s,o,a){let c=(t!=null?t.length:1)*Math.max(r.length,s.length),l=c/(t!=null?t.length:1),d=[];for(let p=0;p<c;++p){let m=t?this.dn(t[p/l]):$c,w=this.An(e,m,r[p%l],i),D=this.Rn(e,m,s[p%l],o),k=a.map(S=>this.An(e,m,S,!0));d.push(...this.createRange(w,D,k))}return d}An(e,t,r,i){let s=new si(e,B.empty(),t,r);return i?s:s.Zt()}Rn(e,t,r,i){let s=new si(e,B.empty(),t,r);return i?s.Zt():s}Pn(e,t){let r=new gl(t),i=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,i).next(s=>{let o=null;for(let a of s)r.rn(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,t){let r=2,i=this.hn(t);return C.forEach(i,s=>this.Pn(e,s).next(o=>{o?r!==0&&o.fields.length<function(c){let l=new ve(He.comparator),d=!1;for(let p of c.filters)for(let m of p.getFlattenedFilters())m.field.isKeyField()||(m.op==="array-contains"||m.op==="array-contains-any"?d=!0:l=l.add(m.field));for(let p of c.orderBy)p.field.isKeyField()||(l=l.add(p.field));return l.size+(d?1:0)}(s)&&(r=1):r=0})).next(()=>function(o){return o.limit!==null}(t)&&i.length>1&&r===2?1:r)}Vn(e,t){let r=new ii;for(let i of ti(e)){let s=t.data.field(i.fieldPath);if(s==null)return null;let o=r.Yt(i.kind);xn.vt.It(s,o)}return r.zt()}dn(e){let t=new ii;return xn.vt.It(e,t.Yt(0)),t.zt()}mn(e,t){let r=new ii;return xn.vt.It(ci(this.databaseId,t),r.Yt(function(s){let o=ti(s);return o.length===0?0:o[o.length-1].kind}(e))),r.zt()}Tn(e,t,r){if(r===null)return[];let i=[];i.push(new ii);let s=0;for(let o of ti(e)){let a=r[s++];for(let c of i)if(this.fn(t,o.fieldPath)&&Sa(a))i=this.gn(i,o,a);else{let l=c.Yt(o.kind);xn.vt.It(a,l)}}return this.pn(i)}In(e,t,r){return this.Tn(e,t,r.position)}pn(e){let t=[];for(let r=0;r<e.length;++r)t[r]=e[r].zt();return t}gn(e,t,r){let i=[...e],s=[];for(let o of r.arrayValue.values||[])for(let a of i){let c=new ii;c.seed(a.zt()),xn.vt.It(o,c.Yt(t.kind)),s.push(c)}return s}fn(e,t){return!!e.filters.find(r=>r instanceof se&&r.field.isEqual(t)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,t){let r=da(e),i=as(e);return(t?r.U("collectionGroupIndex",IDBKeyRange.bound(t,t)):r.U()).next(s=>{let o=[];return C.forEach(s,a=>i.get([a.indexId,this.uid]).next(c=>{o.push(function(d,p){let m=p?new Ia(p.sequenceNumber,new Ft(pi(p.readTime),new B(nn(p.documentKey)),p.largestBatchId)):Ia.empty(),w=d.fields.map(([D,k])=>new gs(He.fromServerFormat(D),k));return new ws(d.indexId,d.collectionGroup,w,m)}(a,c))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(t=>t.length===0?null:(t.sort((r,i)=>{let s=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return s!==0?s:Z(r.collectionGroup,i.collectionGroup)}),t[0].collectionGroup))}updateCollectionGroup(e,t,r){let i=da(e),s=as(e);return this.yn(e).next(o=>i.U("collectionGroupIndex",IDBKeyRange.bound(t,t)).next(a=>C.forEach(a,c=>s.put(uT(c.indexId,this.uid,o,r)))))}updateIndexEntries(e,t){let r=new Map;return C.forEach(t,(i,s)=>{let o=r.get(i.collectionGroup);return(o?C.resolve(o):this.getFieldIndexes(e,i.collectionGroup)).next(a=>(r.set(i.collectionGroup,a),C.forEach(a,c=>this.wn(e,i,c).next(l=>{let d=this.Sn(s,c);return l.isEqual(d)?C.resolve():this.bn(e,s,c,l,d)}))))})}Dn(e,t,r,i){return os(e).put({indexId:i.indexId,uid:this.uid,arrayValue:i.arrayValue,directionalValue:i.directionalValue,orderedDocumentKey:this.mn(r,t.key),documentKey:t.key.path.toArray()})}vn(e,t,r,i){return os(e).delete([i.indexId,this.uid,i.arrayValue,i.directionalValue,this.mn(r,t.key),t.key.path.toArray()])}wn(e,t,r){let i=os(e),s=new ve(gr);return i.J({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.mn(r,t)])},(o,a)=>{s=s.add(new si(r.indexId,t,a.arrayValue,a.directionalValue))}).next(()=>s)}Sn(e,t){let r=new ve(gr),i=this.Vn(t,e);if(i==null)return r;let s=Bp(t);if(s!=null){let o=e.data.field(s.fieldPath);if(Sa(o))for(let a of o.arrayValue.values||[])r=r.add(new si(t.indexId,e.key,this.dn(a),i))}else r=r.add(new si(t.indexId,e.key,$c,i));return r}bn(e,t,r,i,s){O("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);let o=[];return function(c,l,d,p,m){let w=c.getIterator(),D=l.getIterator(),k=ss(w),S=ss(D);for(;k||S;){let x=!1,$=!1;if(k&&S){let F=d(k,S);F<0?$=!0:F>0&&(x=!0)}else k!=null?$=!0:x=!0;x?(p(S),S=ss(D)):$?(m(k),k=ss(w)):(k=ss(w),S=ss(D))}}(i,s,gr,a=>{o.push(this.Dn(e,t,r,a))},a=>{o.push(this.vn(e,t,r,a))}),C.waitFor(o)}yn(e){let t=1;return as(e).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,s)=>{s.done(),t=i.sequenceNumber+1}).next(()=>t)}createRange(e,t,r){r=r.sort((o,a)=>gr(o,a)).filter((o,a,c)=>!a||gr(o,c[a-1])!==0);let i=[];i.push(e);for(let o of r){let a=gr(o,e),c=gr(o,t);if(a===0)i[0]=e.Zt();else if(a>0&&c<0)i.push(o),i.push(o.Zt());else if(c>0)break}i.push(t);let s=[];for(let o=0;o<i.length;o+=2){if(this.Cn(i[o],i[o+1]))return[];let a=[i[o].indexId,this.uid,i[o].arrayValue,i[o].directionalValue,$c,[]],c=[i[o+1].indexId,this.uid,i[o+1].arrayValue,i[o+1].directionalValue,$c,[]];s.push(IDBKeyRange.bound(a,c))}return s}Cn(e,t){return gr(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(gT)}getMinOffset(e,t){return C.mapArray(this.hn(t),r=>this.Pn(e,r).next(i=>i||z())).next(gT)}};function pT(n){return Ke(n,"collectionParents")}function os(n){return Ke(n,"indexEntries")}function da(n){return Ke(n,"indexConfiguration")}function as(n){return Ke(n,"indexState")}function gT(n){G(n.length!==0);let e=n[0].indexState.offset,t=e.largestBatchId;for(let r=1;r<n.length;r++){let i=n[r].indexState.offset;Mm(i,e)<0&&(e=i),t<i.largestBatchId&&(t=i.largestBatchId)}return new Ft(e.readTime,e.documentKey,t)}var mT={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},xt=class n{constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new n(e,n.DEFAULT_COLLECTION_PERCENTILE,n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}};function x0(n,e,t){let r=n.store("mutations"),i=n.store("documentMutations"),s=[],o=IDBKeyRange.only(t.batchId),a=0,c=r.J({range:o},(d,p,m)=>(a++,m.delete()));s.push(c.next(()=>{G(a===1)}));let l=[];for(let d of t.mutations){let p=zT(e,d.key.path,t.batchId);s.push(i.delete(p)),l.push(d.key)}return C.waitFor(s).next(()=>l)}function yl(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw z();e=n.noDocument}return JSON.stringify(e).length}xt.DEFAULT_COLLECTION_PERCENTILE=10,xt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,xt.DEFAULT=new xt(41943040,xt.DEFAULT_COLLECTION_PERCENTILE,xt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),xt.DISABLED=new xt(-1,0,0);var _l=class n{constructor(e,t,r,i){this.userId=e,this.serializer=t,this.indexManager=r,this.referenceDelegate=i,this.Fn={}}static lt(e,t,r,i){G(e.uid!=="");let s=e.isAuthenticated()?e.uid:"";return new n(s,t,r,i)}checkEmpty(e){let t=!0,r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return mr(e).J({index:"userMutationsIndex",range:r},(i,s,o)=>{t=!1,o.done()}).next(()=>t)}addMutationBatch(e,t,r,i){let s=fs(e),o=mr(e);return o.add({}).next(a=>{G(typeof a=="number");let c=new Ca(a,t,r,i),l=function(w,D,k){let S=k.baseMutations.map($=>Ma(w.ct,$)),x=k.mutations.map($=>Ma(w.ct,$));return{userId:D,batchId:k.batchId,localWriteTimeMs:k.localWriteTime.toMillis(),baseMutations:S,mutations:x}}(this.serializer,this.userId,c),d=[],p=new ve((m,w)=>Z(m.canonicalString(),w.canonicalString()));for(let m of i){let w=zT(this.userId,m.key.path,a);p=p.add(m.key.path.popLast()),d.push(o.put(l)),d.push(s.put(w,FO))}return p.forEach(m=>{d.push(this.indexManager.addToCollectionParentIndex(e,m))}),e.addOnCommittedListener(()=>{this.Fn[a]=c.keys()}),C.waitFor(d).next(()=>c)})}lookupMutationBatch(e,t){return mr(e).get(t).next(r=>r?(G(r.userId===this.userId),ri(this.serializer,r)):null)}Mn(e,t){return this.Fn[t]?C.resolve(this.Fn[t]):this.lookupMutationBatch(e,t).next(r=>{if(r){let i=r.keys();return this.Fn[t]=i,i}return null})}getNextMutationBatchAfterBatchId(e,t){let r=t+1,i=IDBKeyRange.lowerBound([this.userId,r]),s=null;return mr(e).J({index:"userMutationsIndex",range:i},(o,a,c)=>{a.userId===this.userId&&(G(a.batchId>=r),s=ri(this.serializer,a)),c.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){let t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),r=-1;return mr(e).J({index:"userMutationsIndex",range:t,reverse:!0},(i,s,o)=>{r=s.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){let t=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return mr(e).U("userMutationsIndex",t).next(r=>r.map(i=>ri(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,t){let r=Gc(this.userId,t.path),i=IDBKeyRange.lowerBound(r),s=[];return fs(e).J({range:i},(o,a,c)=>{let[l,d,p]=o,m=nn(d);if(l===this.userId&&t.path.isEqual(m))return mr(e).get(p).next(w=>{if(!w)throw z();G(w.userId===this.userId),s.push(ri(this.serializer,w))});c.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new ve(Z),i=[];return t.forEach(s=>{let o=Gc(this.userId,s.path),a=IDBKeyRange.lowerBound(o),c=fs(e).J({range:a},(l,d,p)=>{let[m,w,D]=l,k=nn(w);m===this.userId&&s.path.isEqual(k)?r=r.add(D):p.done()});i.push(c)}),C.waitFor(i).next(()=>this.xn(e,r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,i=r.length+1,s=Gc(this.userId,r),o=IDBKeyRange.lowerBound(s),a=new ve(Z);return fs(e).J({range:o},(c,l,d)=>{let[p,m,w]=c,D=nn(m);p===this.userId&&r.isPrefixOf(D)?D.length===i&&(a=a.add(w)):d.done()}).next(()=>this.xn(e,a))}xn(e,t){let r=[],i=[];return t.forEach(s=>{i.push(mr(e).get(s).next(o=>{if(o===null)throw z();G(o.userId===this.userId),r.push(ri(this.serializer,o))}))}),C.waitFor(i).next(()=>r)}removeMutationBatch(e,t){return x0(e._e,this.userId,t).next(r=>(e.addOnCommittedListener(()=>{this.On(t.batchId)}),C.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}On(e){delete this.Fn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return C.resolve();let r=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),i=[];return fs(e).J({range:r},(s,o,a)=>{if(s[0]===this.userId){let c=nn(s[1]);i.push(c)}else a.done()}).next(()=>{G(i.length===0)})})}containsKey(e,t){return F0(e,this.userId,t)}Nn(e){return L0(e).get(this.userId).next(t=>t||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}};function F0(n,e,t){let r=Gc(e,t.path),i=r[1],s=IDBKeyRange.lowerBound(r),o=!1;return fs(n).J({range:s,H:!0},(a,c,l)=>{let[d,p,m]=a;d===e&&p===i&&(o=!0),l.done()}).next(()=>o)}function mr(n){return Ke(n,"mutations")}function fs(n){return Ke(n,"documentMutations")}function L0(n){return Ke(n,"mutationQueues")}var Rs=class n{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new n(0)}static kn(){return new n(-1)}};var bg=class{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.qn(e).next(t=>{let r=new Rs(t.highestTargetId);return t.highestTargetId=r.next(),this.Qn(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.qn(e).next(t=>H.fromTimestamp(new Oe(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.qn(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,r){return this.qn(e).next(i=>(i.highestListenSequenceNumber=t,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),this.Qn(e,i)))}addTargetData(e,t){return this.Kn(e,t).next(()=>this.qn(e).next(r=>(r.targetCount+=1,this.$n(t,r),this.Qn(e,r))))}updateTargetData(e,t){return this.Kn(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>us(e).delete(t.targetId)).next(()=>this.qn(e)).next(r=>(G(r.targetCount>0),r.targetCount-=1,this.Qn(e,r)))}removeTargets(e,t,r){let i=0,s=[];return us(e).J((o,a)=>{let c=ma(a);c.sequenceNumber<=t&&r.get(c.targetId)===null&&(i++,s.push(this.removeTargetData(e,c)))}).next(()=>C.waitFor(s)).next(()=>i)}forEachTarget(e,t){return us(e).J((r,i)=>{let s=ma(i);t(s)})}qn(e){return yT(e).get("targetGlobalKey").next(t=>(G(t!==null),t))}Qn(e,t){return yT(e).put("targetGlobalKey",t)}Kn(e,t){return us(e).put(k0(this.serializer,t))}$n(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.qn(e).next(t=>t.targetCount)}getTargetData(e,t){let r=hi(t),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]),s=null;return us(e).J({range:i,index:"queryTargetsIndex"},(o,a,c)=>{let l=ma(a);Ha(t,l.target)&&(s=l,c.done())}).next(()=>s)}addMatchingKeys(e,t,r){let i=[],s=yr(e);return t.forEach(o=>{let a=ft(o.path);i.push(s.put({targetId:r,path:a})),i.push(this.referenceDelegate.addReference(e,r,o))}),C.waitFor(i)}removeMatchingKeys(e,t,r){let i=yr(e);return C.forEach(t,s=>{let o=ft(s.path);return C.waitFor([i.delete([r,o]),this.referenceDelegate.removeReference(e,r,s)])})}removeMatchingKeysForTargetId(e,t){let r=yr(e),i=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,t){let r=IDBKeyRange.bound([t],[t+1],!1,!0),i=yr(e),s=ee();return i.J({range:r,H:!0},(o,a,c)=>{let l=nn(o[1]),d=new B(l);s=s.add(d)}).next(()=>s)}containsKey(e,t){let r=ft(t.path),i=IDBKeyRange.bound([r],[LT(r)],!1,!0),s=0;return yr(e).J({index:"documentTargetsIndex",H:!0,range:i},([o,a],c,l)=>{o!==0&&(s++,l.done())}).next(()=>s>0)}ot(e,t){return us(e).get(t).next(r=>r?ma(r):null)}};function us(n){return Ke(n,"targets")}function yT(n){return Ke(n,"targetGlobal")}function yr(n){return Ke(n,"targetDocuments")}function _T([n,e],[t,r]){let i=Z(n,t);return i===0?Z(e,r):i}var Dg=class{constructor(e){this.Un=e,this.buffer=new ve(_T),this.Wn=0}Gn(){return++this.Wn}zn(e){let t=[e,this.Gn()];if(this.buffer.size<this.Un)this.buffer=this.buffer.add(t);else{let r=this.buffer.last();_T(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}},Sg=class{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.jn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Hn(6e4)}stop(){this.jn&&(this.jn.cancel(),this.jn=null)}get started(){return this.jn!==null}Hn(e){O("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.jn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,()=>y(this,null,function*(){this.jn=null;try{yield this.localStore.collectGarbage(this.garbageCollector)}catch(t){Or(t)?O("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",t):yield kr(t)}yield this.Hn(3e5)}))}},Rg=class{constructor(e,t){this.Jn=e,this.params=t}calculateTargetCount(e,t){return this.Jn.Yn(e).next(r=>Math.floor(t/100*r))}nthSequenceNumber(e,t){if(t===0)return C.resolve(At.oe);let r=new Dg(t);return this.Jn.forEachTarget(e,i=>r.zn(i.sequenceNumber)).next(()=>this.Jn.Zn(e,i=>r.zn(i))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.Jn.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.Jn.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(O("LruGarbageCollector","Garbage collection skipped; disabled"),C.resolve(mT)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(O("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),mT):this.Xn(e,t))}getCacheSize(e){return this.Jn.getCacheSize(e)}Xn(e,t){let r,i,s,o,a,c,l,d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(p=>(p>this.params.maximumSequenceNumbersToCollect?(O("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${p}`),i=this.params.maximumSequenceNumbersToCollect):i=p,o=Date.now(),this.nthSequenceNumber(e,i))).next(p=>(r=p,a=Date.now(),this.removeTargets(e,r,t))).next(p=>(s=p,c=Date.now(),this.removeOrphanedDocuments(e,r))).next(p=>(l=Date.now(),cs()<=re.DEBUG&&O("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-d}ms
	Determined least recently used ${i} in `+(a-o)+`ms
	Removed ${s} targets in `+(c-a)+`ms
	Removed ${p} documents in `+(l-c)+`ms
Total Duration: ${l-d}ms`),C.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:p})))}};function N1(n,e){return new Rg(n,e)}var Cg=class{constructor(e,t){this.db=e,this.garbageCollector=N1(this,t)}Yn(e){let t=this.er(e);return this.db.getTargetCache().getTargetCount(e).next(r=>t.next(i=>r+i))}er(e){let t=0;return this.Zn(e,r=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}Zn(e,t){return this.tr(e,(r,i)=>t(i))}addReference(e,t,r){return jc(e,r)}removeReference(e,t,r){return jc(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return jc(e,t)}nr(e,t){return function(i,s){let o=!1;return L0(i).Y(a=>F0(i,a,s).next(c=>(c&&(o=!0),C.resolve(!c)))).next(()=>o)}(e,t)}removeOrphanedDocuments(e,t){let r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[],s=0;return this.tr(e,(o,a)=>{if(a<=t){let c=this.nr(e,o).next(l=>{if(!l)return s++,r.getEntry(e,o).next(()=>(r.removeEntry(o,H.min()),yr(e).delete(function(p){return[0,ft(p.path)]}(o))))});i.push(c)}}).next(()=>C.waitFor(i)).next(()=>r.apply(e)).next(()=>s)}removeTarget(e,t){let r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return jc(e,t)}tr(e,t){let r=yr(e),i,s=At.oe;return r.J({index:"documentTargetsIndex"},([o,a],{path:c,sequenceNumber:l})=>{o===0?(s!==At.oe&&t(new B(nn(i)),s),s=l,i=c):s=At.oe}).next(()=>{s!==At.oe&&t(new B(nn(i)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}};function jc(n,e){return yr(n).put(function(r,i){return{targetId:0,path:ft(r.path),sequenceNumber:i}}(e,n.currentSequenceNumber))}var vl=class{constructor(){this.changes=new hn(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,We.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let r=this.changes.get(t);return r!==void 0?C.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var Pg=class{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return ei(e).put(r)}removeEntry(e,t,r){return ei(e).delete(function(s,o){let a=s.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],fl(o),a[a.length-1]]}(t,r))}updateMetadata(e,t){return this.getMetadata(e).next(r=>(r.byteSize+=t,this.rr(e,r)))}getEntry(e,t){let r=We.newInvalidDocument(t);return ei(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(fa(t))},(i,s)=>{r=this.ir(t,s)}).next(()=>r)}sr(e,t){let r={size:0,document:We.newInvalidDocument(t)};return ei(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(fa(t))},(i,s)=>{r={document:this.ir(t,s),size:yl(s)}}).next(()=>r)}getEntries(e,t){let r=yt();return this._r(e,t,(i,s)=>{let o=this.ir(i,s);r=r.insert(i,o)}).next(()=>r)}ar(e,t){let r=yt(),i=new Te(B.comparator);return this._r(e,t,(s,o)=>{let a=this.ir(s,o);r=r.insert(s,a),i=i.insert(s,yl(o))}).next(()=>({documents:r,ur:i}))}_r(e,t,r){if(t.isEmpty())return C.resolve();let i=new ve(ET);t.forEach(c=>i=i.add(c));let s=IDBKeyRange.bound(fa(i.first()),fa(i.last())),o=i.getIterator(),a=o.getNext();return ei(e).J({index:"documentKeyIndex",range:s},(c,l,d)=>{let p=B.fromSegments([...l.prefixPath,l.collectionGroup,l.documentId]);for(;a&&ET(a,p)<0;)r(a,null),a=o.getNext();a&&a.isEqual(p)&&(r(a,l),a=o.hasNext()?o.getNext():null),a?d.$(fa(a)):d.done()}).next(()=>{for(;a;)r(a,null),a=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,t,r,i,s){let o=t.path,a=[o.popLast().toArray(),o.lastSegment(),fl(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],c=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return ei(e).U(IDBKeyRange.bound(a,c,!0)).next(l=>{s?.incrementDocumentReadCount(l.length);let d=yt();for(let p of l){let m=this.ir(B.fromSegments(p.prefixPath.concat(p.collectionGroup,p.documentId)),p);m.isFoundDocument()&&(Qa(t,m)||i.has(m.key))&&(d=d.insert(m.key,m))}return d})}getAllFromCollectionGroup(e,t,r,i){let s=yt(),o=wT(t,r),a=wT(t,Ft.max());return ei(e).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,a,!0)},(c,l,d)=>{let p=this.ir(B.fromSegments(l.prefixPath.concat(l.collectionGroup,l.documentId)),l);s=s.insert(p.key,p),s.size===i&&d.done()}).next(()=>s)}newChangeBuffer(e){return new Ng(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return vT(e).get("remoteDocumentGlobalKey").next(t=>(G(!!t),t))}rr(e,t){return vT(e).put("remoteDocumentGlobalKey",t)}ir(e,t){if(t){let r=R1(this.serializer,t);if(!(r.isNoDocument()&&r.version.isEqual(H.min())))return r}return We.newInvalidDocument(e)}};function V0(n){return new Pg(n)}var Ng=class extends vl{constructor(e,t){super(),this.cr=e,this.trackRemovals=t,this.lr=new hn(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){let t=[],r=0,i=new ve((s,o)=>Z(s.canonicalString(),o.canonicalString()));return this.changes.forEach((s,o)=>{let a=this.lr.get(s);if(t.push(this.cr.removeEntry(e,s,a.readTime)),o.isValidDocument()){let c=oT(this.cr.serializer,o);i=i.add(s.path.popLast());let l=yl(c);r+=l-a.size,t.push(this.cr.addEntry(e,s,c))}else if(r-=a.size,this.trackRemovals){let c=oT(this.cr.serializer,o.convertToNoDocument(H.min()));t.push(this.cr.addEntry(e,s,c))}}),i.forEach(s=>{t.push(this.cr.indexManager.addToCollectionParentIndex(e,s))}),t.push(this.cr.updateMetadata(e,r)),C.waitFor(t)}getFromCache(e,t){return this.cr.sr(e,t).next(r=>(this.lr.set(t,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,t){return this.cr.ar(e,t).next(({documents:r,ur:i})=>(i.forEach((s,o)=>{this.lr.set(s,{size:o,readTime:r.get(s).readTime})}),r))}};function vT(n){return Ke(n,"remoteDocumentGlobal")}function ei(n){return Ke(n,"remoteDocumentsV14")}function fa(n){let e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function wT(n,e){let t=e.documentKey.path.toArray();return[n,fl(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function ET(n,e){let t=n.path.toArray(),r=e.path.toArray(),i=0;for(let s=0;s<t.length-2&&s<r.length-2;++s)if(i=Z(t[s],r[s]),i)return i;return i=Z(t.length,r.length),i||(i=Z(t[t.length-2],r[r.length-2]),i||Z(t[t.length-1],r[r.length-1]))}var kg=class{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}};var wl=class{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(r!==null&&va(r.mutation,i,bt.empty(),Oe.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,ee()).next(()=>r))}getLocalViewOfDocuments(e,t,r=ee()){let i=rn();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(s=>{let o=ga();return s.forEach((a,c)=>{o=o.insert(a,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){let r=rn();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,ee()))}populateOverlays(e,t,r){let i=[];return r.forEach(s=>{t.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,a)=>{t.set(o,a)})})}computeViews(e,t,r,i){let s=yt(),o=_a(),a=function(){return _a()}();return t.forEach((c,l)=>{let d=r.get(l.key);i.has(l.key)&&(d===void 0||d.mutation instanceof Gt)?s=s.insert(l.key,l):d!==void 0?(o.set(l.key,d.mutation.getFieldMask()),va(d.mutation,l,d.mutation.getFieldMask(),Oe.now())):o.set(l.key,bt.empty())}),this.recalculateAndSaveOverlays(e,s).next(c=>(c.forEach((l,d)=>o.set(l,d)),t.forEach((l,d)=>{var p;return a.set(l,new kg(d,(p=o.get(l))!==null&&p!==void 0?p:null))}),a))}recalculateAndSaveOverlays(e,t){let r=_a(),i=new Te((o,a)=>o-a),s=ee();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(let a of o)a.keys().forEach(c=>{let l=t.get(c);if(l===null)return;let d=r.get(c)||bt.empty();d=a.applyToLocalView(l,d),r.set(c,d);let p=(i.get(a.batchId)||ee()).add(c);i=i.insert(a.batchId,p)})}).next(()=>{let o=[],a=i.getReverseIterator();for(;a.hasNext();){let c=a.getNext(),l=c.key,d=c.value,p=u0();d.forEach(m=>{if(!s.has(m)){let w=g0(t.get(m),r.get(m));w!==null&&p.set(m,w),s=s.add(m)}}),o.push(this.documentOverlayCache.saveOverlays(e,l,p))}return C.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,i){return function(o){return B.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Um(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(s=>{let o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-s.size):C.resolve(rn()),a=-1,c=s;return o.next(l=>C.forEach(l,(d,p)=>(a<p.largestBatchId&&(a=p.largestBatchId),s.get(d)?C.resolve():this.remoteDocumentCache.getEntry(e,d).next(m=>{c=c.insert(d,m)}))).next(()=>this.populateOverlays(e,l,s)).next(()=>this.computeViews(e,c,l,ee())).next(d=>({batchId:a,changes:a0(d)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new B(t)).next(r=>{let i=ga();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){let s=t.collectionGroup,o=ga();return this.indexManager.getCollectionParents(e,s).next(a=>C.forEach(a,c=>{let l=function(p,m){return new qt(m,null,p.explicitOrderBy.slice(),p.filters.slice(),p.limit,p.limitType,p.startAt,p.endAt)}(t,c.child(s));return this.getDocumentsMatchingCollectionQuery(e,l,r,i).next(d=>{d.forEach((p,m)=>{o=o.insert(p,m)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,t,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,s,i))).next(o=>{s.forEach((c,l)=>{let d=l.getKey();o.get(d)===null&&(o=o.insert(d,We.newInvalidDocument(d)))});let a=ga();return o.forEach((c,l)=>{let d=s.get(c);d!==void 0&&va(d.mutation,l,bt.empty(),Oe.now()),Qa(t,l)&&(a=a.insert(c,l))}),a})}};var Og=class{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,t){return C.resolve(this.hr.get(t))}saveBundleMetadata(e,t){return this.hr.set(t.id,function(i){return{id:i.id,version:i.version,createTime:Me(i.createTime)}}(t)),C.resolve()}getNamedQuery(e,t){return C.resolve(this.Pr.get(t))}saveNamedQuery(e,t){return this.Pr.set(t.name,function(i){return{name:i.name,query:zm(i.bundledQuery),readTime:Me(i.readTime)}}(t)),C.resolve()}};var Mg=class{constructor(){this.overlays=new Te(B.comparator),this.Ir=new Map}getOverlay(e,t){return C.resolve(this.overlays.get(t))}getOverlays(e,t){let r=rn();return C.forEach(t,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((i,s)=>{this.ht(e,t,s)}),C.resolve()}removeOverlaysForBatchId(e,t,r){let i=this.Ir.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.Ir.delete(r)),C.resolve()}getOverlaysForCollection(e,t,r){let i=rn(),s=t.length+1,o=new B(t.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){let c=a.getNext().value,l=c.getKey();if(!t.isPrefixOf(l.path))break;l.path.length===s&&c.largestBatchId>r&&i.set(c.getKey(),c)}return C.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let s=new Te((l,d)=>l-d),o=this.overlays.getIterator();for(;o.hasNext();){let l=o.getNext().value;if(l.getKey().getCollectionGroup()===t&&l.largestBatchId>r){let d=s.get(l.largestBatchId);d===null&&(d=rn(),s=s.insert(l.largestBatchId,d)),d.set(l.getKey(),l)}}let a=rn(),c=s.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((l,d)=>a.set(l,d)),!(a.size()>=i)););return C.resolve(a)}ht(e,t,r){let i=this.overlays.get(r.key);if(i!==null){let o=this.Ir.get(i.largestBatchId).delete(r.key);this.Ir.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new Pa(t,r));let s=this.Ir.get(t);s===void 0&&(s=ee(),this.Ir.set(t,s)),this.Ir.set(t,s.add(r.key))}};var xg=class{constructor(){this.sessionToken=Fe.EMPTY_BYTE_STRING}getSessionToken(e){return C.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,C.resolve()}};var Fa=class{constructor(){this.Tr=new ve(ze.Er),this.dr=new ve(ze.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,t){let r=new ze(e,t);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.Vr(new ze(e,t))}mr(e,t){e.forEach(r=>this.removeReference(r,t))}gr(e){let t=new B(new ae([])),r=new ze(t,e),i=new ze(t,e+1),s=[];return this.dr.forEachInRange([r,i],o=>{this.Vr(o),s.push(o.key)}),s}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){let t=new B(new ae([])),r=new ze(t,e),i=new ze(t,e+1),s=ee();return this.dr.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){let t=new ze(e,0),r=this.Tr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}},ze=class{constructor(e,t){this.key=e,this.wr=t}static Er(e,t){return B.comparator(e.key,t.key)||Z(e.wr,t.wr)}static Ar(e,t){return Z(e.wr,t.wr)||B.comparator(e.key,t.key)}};var Fg=class{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Sr=1,this.br=new ve(ze.Er)}checkEmpty(e){return C.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){let s=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let o=new Ca(s,t,r,i);this.mutationQueue.push(o);for(let a of i)this.br=this.br.add(new ze(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return C.resolve(o)}lookupMutationBatch(e,t){return C.resolve(this.Dr(t))}getNextMutationBatchAfterBatchId(e,t){let r=t+1,i=this.vr(r),s=i<0?0:i;return C.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return C.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return C.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let r=new ze(t,0),i=new ze(t,Number.POSITIVE_INFINITY),s=[];return this.br.forEachInRange([r,i],o=>{let a=this.Dr(o.wr);s.push(a)}),C.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new ve(Z);return t.forEach(i=>{let s=new ze(i,0),o=new ze(i,Number.POSITIVE_INFINITY);this.br.forEachInRange([s,o],a=>{r=r.add(a.wr)})}),C.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,i=r.length+1,s=r;B.isDocumentKey(s)||(s=s.child(""));let o=new ze(new B(s),0),a=new ve(Z);return this.br.forEachWhile(c=>{let l=c.key.path;return!!r.isPrefixOf(l)&&(l.length===i&&(a=a.add(c.wr)),!0)},o),C.resolve(this.Cr(a))}Cr(e){let t=[];return e.forEach(r=>{let i=this.Dr(r);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){G(this.Fr(t.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return C.forEach(t.mutations,i=>{let s=new ze(i.key,t.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,t){let r=new ze(t,0),i=this.br.firstAfterOrEqual(r);return C.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,C.resolve()}Fr(e,t){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){let t=this.vr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}};var Lg=class{constructor(e){this.Mr=e,this.docs=function(){return new Te(B.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let r=t.key,i=this.docs.get(r),s=i?i.size:0,o=this.Mr(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let r=this.docs.get(t);return C.resolve(r?r.document.mutableCopy():We.newInvalidDocument(t))}getEntries(e,t){let r=yt();return t.forEach(i=>{let s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():We.newInvalidDocument(i))}),C.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let s=yt(),o=t.path,a=new B(o.child("")),c=this.docs.getIteratorFrom(a);for(;c.hasNext();){let{key:l,value:{document:d}}=c.getNext();if(!o.isPrefixOf(l.path))break;l.path.length>o.length+1||Mm(UT(d),r)<=0||(i.has(d.key)||Qa(t,d))&&(s=s.insert(d.key,d.mutableCopy()))}return C.resolve(s)}getAllFromCollectionGroup(e,t,r,i){z()}Or(e,t){return C.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new Vg(this)}getSize(e){return C.resolve(this.size)}},Vg=class extends vl{constructor(e){super(),this.cr=e}applyChanges(e){let t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this.cr.addEntry(e,i)):this.cr.removeEntry(r)}),C.waitFor(t)}getFromCache(e,t){return this.cr.getEntry(e,t)}getAllFromCache(e,t){return this.cr.getEntries(e,t)}};var Ug=class{constructor(e){this.persistence=e,this.Nr=new hn(t=>hi(t),Ha),this.lastRemoteSnapshotVersion=H.min(),this.highestTargetId=0,this.Lr=0,this.Br=new Fa,this.targetCount=0,this.kr=Rs.Bn()}forEachTarget(e,t){return this.Nr.forEach((r,i)=>t(i)),C.resolve()}getLastRemoteSnapshotVersion(e){return C.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return C.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),C.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.Lr&&(this.Lr=t),C.resolve()}Kn(e){this.Nr.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this.kr=new Rs(t),this.highestTargetId=t),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,t){return this.Kn(t),this.targetCount+=1,C.resolve()}updateTargetData(e,t){return this.Kn(t),C.resolve()}removeTargetData(e,t){return this.Nr.delete(t.target),this.Br.gr(t.targetId),this.targetCount-=1,C.resolve()}removeTargets(e,t,r){let i=0,s=[];return this.Nr.forEach((o,a)=>{a.sequenceNumber<=t&&r.get(a.targetId)===null&&(this.Nr.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),C.waitFor(s).next(()=>i)}getTargetCount(e){return C.resolve(this.targetCount)}getTargetData(e,t){let r=this.Nr.get(t)||null;return C.resolve(r)}addMatchingKeys(e,t,r){return this.Br.Rr(t,r),C.resolve()}removeMatchingKeys(e,t,r){this.Br.mr(t,r);let i=this.persistence.referenceDelegate,s=[];return i&&t.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),C.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.Br.gr(t),C.resolve()}getMatchingKeysForTargetId(e,t){let r=this.Br.yr(t);return C.resolve(r)}containsKey(e,t){return C.resolve(this.Br.containsKey(t))}};var El=class{constructor(e,t){this.qr={},this.overlays={},this.Qr=new At(0),this.Kr=!1,this.Kr=!0,this.$r=new xg,this.referenceDelegate=e(this),this.Ur=new Ug(this),this.indexManager=new Tg,this.remoteDocumentCache=function(i){return new Lg(i)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new dl(t),this.Gr=new Og(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new Mg,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.qr[e.toKey()];return r||(r=new Fg(t,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,t,r){O("MemoryPersistence","Starting transaction:",e);let i=new Bg(this.Qr.next());return this.referenceDelegate.zr(),r(i).next(s=>this.referenceDelegate.jr(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Hr(e,t){return C.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,t)))}},Bg=class extends el{constructor(e){super(),this.currentSequenceNumber=e}},Il=class n{constructor(e){this.persistence=e,this.Jr=new Fa,this.Yr=null}static Zr(e){return new n(e)}get Xr(){if(this.Yr)return this.Yr;throw z()}addReference(e,t,r){return this.Jr.addReference(r,t),this.Xr.delete(r.toString()),C.resolve()}removeReference(e,t,r){return this.Jr.removeReference(r,t),this.Xr.add(r.toString()),C.resolve()}markPotentiallyOrphaned(e,t){return this.Xr.add(t.toString()),C.resolve()}removeTarget(e,t){this.Jr.gr(t.targetId).forEach(i=>this.Xr.add(i.toString()));let r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(s=>this.Xr.add(s.toString()))}).next(()=>r.removeTargetData(e,t))}zr(){this.Yr=new Set}jr(e){let t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return C.forEach(this.Xr,r=>{let i=B.fromPath(r);return this.ei(e,i).next(s=>{s||t.removeEntry(i,H.min())})}).next(()=>(this.Yr=null,t.apply(e)))}updateLimboDocument(e,t){return this.ei(e,t).next(r=>{r?this.Xr.delete(t.toString()):this.Xr.add(t.toString())})}Wr(e){return 0}ei(e,t){return C.or([()=>C.resolve(this.Jr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Hr(e,t)])}};var $g=class{constructor(e){this.serializer=e}O(e,t,r,i){let s=new tl("createOrUpgrade",t);r<1&&i>=1&&(function(c){c.createObjectStore("owner")}(e),function(c){c.createObjectStore("mutationQueues",{keyPath:"userId"}),c.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",LI,{unique:!0}),c.createObjectStore("documentMutations")}(e),IT(e),function(c){c.createObjectStore("remoteDocuments")}(e));let o=C.resolve();return r<3&&i>=3&&(r!==0&&(function(c){c.deleteObjectStore("targetDocuments"),c.deleteObjectStore("targets"),c.deleteObjectStore("targetGlobal")}(e),IT(e)),o=o.next(()=>function(c){let l=c.store("targetGlobal"),d={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:H.min().toTimestamp(),targetCount:0};return l.put("targetGlobalKey",d)}(s))),r<4&&i>=4&&(r!==0&&(o=o.next(()=>function(c,l){return l.store("mutations").U().next(d=>{c.deleteObjectStore("mutations"),c.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",LI,{unique:!0});let p=l.store("mutations"),m=d.map(w=>p.put(w));return C.waitFor(m)})}(e,s))),o=o.next(()=>{(function(c){c.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),r<5&&i>=5&&(o=o.next(()=>this.ni(s))),r<6&&i>=6&&(o=o.next(()=>(function(c){c.createObjectStore("remoteDocumentGlobal")}(e),this.ri(s)))),r<7&&i>=7&&(o=o.next(()=>this.ii(s))),r<8&&i>=8&&(o=o.next(()=>this.si(e,s))),r<9&&i>=9&&(o=o.next(()=>{(function(c){c.objectStoreNames.contains("remoteDocumentChanges")&&c.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&i>=10&&(o=o.next(()=>this.oi(s))),r<11&&i>=11&&(o=o.next(()=>{(function(c){c.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(c){c.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&i>=12&&(o=o.next(()=>{(function(c){let l=c.createObjectStore("documentOverlays",{keyPath:KO});l.createIndex("collectionPathOverlayIndex",QO,{unique:!1}),l.createIndex("collectionGroupOverlayIndex",YO,{unique:!1})})(e)})),r<13&&i>=13&&(o=o.next(()=>function(c){let l=c.createObjectStore("remoteDocumentsV14",{keyPath:LO});l.createIndex("documentKeyIndex",VO),l.createIndex("collectionGroupIndex",UO)}(e)).next(()=>this._i(e,s)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&i>=14&&(o=o.next(()=>this.ai(e,s))),r<15&&i>=15&&(o=o.next(()=>function(c){c.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),c.createObjectStore("indexState",{keyPath:qO}).createIndex("sequenceNumberIndex",GO,{unique:!1}),c.createObjectStore("indexEntries",{keyPath:WO}).createIndex("documentKeyIndex",HO,{unique:!1})}(e))),r<16&&i>=16&&(o=o.next(()=>{t.objectStore("indexState").clear()}).next(()=>{t.objectStore("indexEntries").clear()})),r<17&&i>=17&&(o=o.next(()=>{(function(c){c.createObjectStore("globals",{keyPath:"name"})})(e)})),o}ri(e){let t=0;return e.store("remoteDocuments").J((r,i)=>{t+=yl(i)}).next(()=>{let r={byteSize:t};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}ni(e){let t=e.store("mutationQueues"),r=e.store("mutations");return t.U().next(i=>C.forEach(i,s=>{let o=IDBKeyRange.bound([s.userId,-1],[s.userId,s.lastAcknowledgedBatchId]);return r.U("userMutationsIndex",o).next(a=>C.forEach(a,c=>{G(c.userId===s.userId);let l=ri(this.serializer,c);return x0(e,s.userId,l).next(()=>{})}))}))}ii(e){let t=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(i=>{let s=[];return r.J((o,a)=>{let c=new ae(o),l=function(p){return[0,ft(p)]}(c);s.push(t.get(l).next(d=>d?C.resolve():(p=>t.put({targetId:0,path:ft(p),sequenceNumber:i.highestListenSequenceNumber}))(c)))}).next(()=>C.waitFor(s))})}si(e,t){e.createObjectStore("collectionParents",{keyPath:zO});let r=t.store("collectionParents"),i=new xa,s=o=>{if(i.add(o)){let a=o.lastSegment(),c=o.popLast();return r.put({collectionId:a,parent:ft(c)})}};return t.store("remoteDocuments").J({H:!0},(o,a)=>{let c=new ae(o);return s(c.popLast())}).next(()=>t.store("documentMutations").J({H:!0},([o,a,c],l)=>{let d=nn(a);return s(d.popLast())}))}oi(e){let t=e.store("targets");return t.J((r,i)=>{let s=ma(i),o=k0(this.serializer,s);return t.put(o)})}_i(e,t){let r=t.store("remoteDocuments"),i=[];return r.J((s,o)=>{let a=t.store("remoteDocumentsV14"),c=function(p){return p.document?new B(ae.fromString(p.document.name).popFirst(5)):p.noDocument?B.fromSegments(p.noDocument.path):p.unknownDocument?B.fromSegments(p.unknownDocument.path):z()}(o).path.toArray(),l={prefixPath:c.slice(0,c.length-2),collectionGroup:c[c.length-2],documentId:c[c.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};i.push(a.put(l))}).next(()=>C.waitFor(i))}ai(e,t){let r=t.store("mutations"),i=V0(this.serializer),s=new El(Il.Zr,this.serializer.ct);return r.U().next(o=>{let a=new Map;return o.forEach(c=>{var l;let d=(l=a.get(c.userId))!==null&&l!==void 0?l:ee();ri(this.serializer,c).keys().forEach(p=>d=d.add(p)),a.set(c.userId,d)}),C.forEach(a,(c,l)=>{let d=new qe(l),p=pl.lt(this.serializer,d),m=s.getIndexManager(d),w=_l.lt(d,this.serializer,m,s.referenceDelegate);return new wl(i,w,p,m).recalculateAndSaveOverlaysForDocumentKeys(new Aa(t,At.oe),c).next()})})}};function IT(n){n.createObjectStore("targetDocuments",{keyPath:$O}).createIndex("documentTargetsIndex",jO,{unique:!0}),n.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",BO,{unique:!0}),n.createObjectStore("targetGlobal")}var Pp="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",jg=class n{constructor(e,t,r,i,s,o,a,c,l,d,p=17){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.ui=s,this.window=o,this.document=a,this.ci=l,this.li=d,this.hi=p,this.Qr=null,this.Kr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Pi=null,this.inForeground=!1,this.Ii=null,this.Ti=null,this.Ei=Number.NEGATIVE_INFINITY,this.di=m=>Promise.resolve(),!n.D())throw new M(P.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new Cg(this,i),this.Ai=t+"main",this.serializer=new dl(c),this.Ri=new Er(this.Ai,this.hi,new $g(this.serializer)),this.$r=new mg,this.Ur=new bg(this.referenceDelegate,this.serializer),this.remoteDocumentCache=V0(this.serializer),this.Gr=new gg,this.window&&this.window.localStorage?this.Vi=this.window.localStorage:(this.Vi=null,d===!1&&ke("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.mi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new M(P.FAILED_PRECONDITION,Pp);return this.fi(),this.gi(),this.pi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Ur.getHighestSequenceNumber(e))}).then(e=>{this.Qr=new At(e,this.ci)}).then(()=>{this.Kr=!0}).catch(e=>(this.Ri&&this.Ri.close(),Promise.reject(e)))}yi(e){return this.di=t=>y(this,null,function*(){if(this.started)return e(t)}),e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ri.L(t=>y(this,null,function*(){t.newVersion===null&&(yield e())}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.ui.enqueueAndForget(()=>y(this,null,function*(){this.started&&(yield this.mi())})))}mi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>zc(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.wi(e).next(t=>{t||(this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)))})}).next(()=>this.Si(e)).next(t=>this.isPrimary&&!t?this.bi(e).next(()=>!1):!!t&&this.Di(e).next(()=>!0))).catch(e=>{if(Or(e))return O("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return O("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.ui.enqueueRetryable(()=>this.di(e)),this.isPrimary=e})}wi(e){return pa(e).get("owner").next(t=>C.resolve(this.vi(t)))}Ci(e){return zc(e).delete(this.clientId)}Fi(){return y(this,null,function*(){if(this.isPrimary&&!this.Mi(this.Ei,18e5)){this.Ei=Date.now();let e=yield this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",t=>{let r=Ke(t,"clientMetadata");return r.U().next(i=>{let s=this.xi(i,18e5),o=i.filter(a=>s.indexOf(a)===-1);return C.forEach(o,a=>r.delete(a.clientId)).next(()=>o)})}).catch(()=>[]);if(this.Vi)for(let t of e)this.Vi.removeItem(this.Oi(t.clientId))}})}pi(){this.Ti=this.ui.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.mi().then(()=>this.Fi()).then(()=>this.pi()))}vi(e){return!!e&&e.ownerId===this.clientId}Si(e){return this.li?C.resolve(!0):pa(e).get("owner").next(t=>{if(t!==null&&this.Mi(t.leaseTimestampMs,5e3)&&!this.Ni(t.ownerId)){if(this.vi(t)&&this.networkEnabled)return!0;if(!this.vi(t)){if(!t.allowTabSynchronization)throw new M(P.FAILED_PRECONDITION,Pp);return!1}}return!(!this.networkEnabled||!this.inForeground)||zc(e).U().next(r=>this.xi(r,5e3).find(i=>{if(this.clientId!==i.clientId){let s=!this.networkEnabled&&i.networkEnabled,o=!this.inForeground&&i.inForeground,a=this.networkEnabled===i.networkEnabled;if(s||o&&a)return!0}return!1})===void 0)}).next(t=>(this.isPrimary!==t&&O("IndexedDbPersistence",`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}shutdown(){return y(this,null,function*(){this.Kr=!1,this.Li(),this.Ti&&(this.Ti.cancel(),this.Ti=null),this.Bi(),this.ki(),yield this.Ri.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{let t=new Aa(e,At.oe);return this.bi(t).next(()=>this.Ci(t))}),this.Ri.close(),this.qi()})}xi(e,t){return e.filter(r=>this.Mi(r.updateTimeMs,t)&&!this.Ni(r.clientId))}Qi(){return this.runTransaction("getActiveClients","readonly",e=>zc(e).U().next(t=>this.xi(t,18e5).map(r=>r.clientId)))}get started(){return this.Kr}getGlobalsCache(){return this.$r}getMutationQueue(e,t){return _l.lt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new Ag(e,this.serializer.ct.databaseId)}getDocumentOverlayCache(e){return pl.lt(this.serializer,e)}getBundleCache(){return this.Gr}runTransaction(e,t,r){O("IndexedDbPersistence","Starting transaction:",e);let i=t==="readonly"?"readonly":"readwrite",s=function(c){return c===17?ZO:c===16?XO:c===15?Fm:c===14?WT:c===13?GT:c===12?JO:c===11?qT:void z()}(this.hi),o;return this.Ri.runTransaction(e,i,s,a=>(o=new Aa(a,this.Qr?this.Qr.next():At.oe),t==="readwrite-primary"?this.wi(o).next(c=>!!c||this.Si(o)).next(c=>{if(!c)throw ke(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)),new M(P.FAILED_PRECONDITION,BT);return r(o)}).next(c=>this.Di(o).next(()=>c)):this.Ki(o).next(()=>r(o)))).then(a=>(o.raiseOnCommittedEvent(),a))}Ki(e){return pa(e).get("owner").next(t=>{if(t!==null&&this.Mi(t.leaseTimestampMs,5e3)&&!this.Ni(t.ownerId)&&!this.vi(t)&&!(this.li||this.allowTabSynchronization&&t.allowTabSynchronization))throw new M(P.FAILED_PRECONDITION,Pp)})}Di(e){let t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return pa(e).put("owner",t)}static D(){return Er.D()}bi(e){let t=pa(e);return t.get("owner").next(r=>this.vi(r)?(O("IndexedDbPersistence","Releasing primary lease."),t.delete("owner")):C.resolve())}Mi(e,t){let r=Date.now();return!(e<r-t)&&(!(e>r)||(ke(`Detected an update time that is in the future: ${e} > ${r}`),!1))}fi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Ii=()=>{this.ui.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.mi()))},this.document.addEventListener("visibilitychange",this.Ii),this.inForeground=this.document.visibilityState==="visible")}Bi(){this.Ii&&(this.document.removeEventListener("visibilitychange",this.Ii),this.Ii=null)}gi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.Pi=()=>{this.Li();let t=/(?:Version|Mobile)\/1[456]/;yf()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.ui.enterRestrictedMode(!0),this.ui.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Pi))}ki(){this.Pi&&(this.window.removeEventListener("pagehide",this.Pi),this.Pi=null)}Ni(e){var t;try{let r=((t=this.Vi)===null||t===void 0?void 0:t.getItem(this.Oi(e)))!==null;return O("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return ke("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}Li(){if(this.Vi)try{this.Vi.setItem(this.Oi(this.clientId),String(Date.now()))}catch(e){ke("Failed to set zombie client id.",e)}}qi(){if(this.Vi)try{this.Vi.removeItem(this.Oi(this.clientId))}catch{}}Oi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}};function pa(n){return Ke(n,"owner")}function zc(n){return Ke(n,"clientMetadata")}function Gm(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}var zg=class n{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.$i=r,this.Ui=i}static Wi(e,t){let r=ee(),i=ee();for(let s of t.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new n(e,t.fromCache,r,i)}};var qg=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var Tl=class{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return yf()?8:$T(Ne())>0?6:4}()}initialize(e,t){this.Ji=e,this.indexManager=t,this.Gi=!0}getDocumentsMatchingQuery(e,t,r,i){let s={result:null};return this.Yi(e,t).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.Zi(e,t,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;let o=new qg;return this.Xi(e,t,o).next(a=>{if(s.result=a,this.zi)return this.es(e,t,o,a.size)})}).next(()=>s.result)}es(e,t,r,i){return r.documentReadCount<this.ji?(cs()<=re.DEBUG&&O("QueryEngine","SDK will not create cache indexes for query:",ls(t),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),C.resolve()):(cs()<=re.DEBUG&&O("QueryEngine","Query:",ls(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Hi*i?(cs()<=re.DEBUG&&O("QueryEngine","The SDK decides to create cache indexes for query:",ls(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,pt(t))):C.resolve())}Yi(e,t){if(QI(t))return C.resolve(null);let r=pt(t);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=ul(t,null,"F"),r=pt(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{let o=ee(...s);return this.Ji.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(c=>{let l=this.ts(t,a);return this.ns(t,l,o,c.readTime)?this.Yi(e,ul(t,null,"F")):this.rs(e,l,t,c)}))})))}Zi(e,t,r,i){return QI(t)||i.isEqual(H.min())?C.resolve(null):this.Ji.getDocuments(e,r).next(s=>{let o=this.ts(t,s);return this.ns(t,o,r,i)?C.resolve(null):(cs()<=re.DEBUG&&O("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),ls(t)),this.rs(e,o,t,VT(i,-1)).next(a=>a))})}ts(e,t){let r=new ve(s0(e));return t.forEach((i,s)=>{Qa(e,s)&&(r=r.add(s))}),r}ns(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;let s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Xi(e,t,r){return cs()<=re.DEBUG&&O("QueryEngine","Using full collection scan to execute query:",ls(t)),this.Ji.getDocumentsMatchingQuery(e,t,Ft.min(),r)}rs(e,t,r,i){return this.Ji.getDocumentsMatchingQuery(e,r,i).next(s=>(t.forEach(o=>{s=s.insert(o.key,o)}),s))}};var Gg=class{constructor(e,t,r,i){this.persistence=e,this.ss=t,this.serializer=i,this.os=new Te(Z),this._s=new hn(s=>hi(s),Ha),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new wl(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.os))}};function U0(n,e,t,r){return new Gg(n,e,t,r)}function B0(n,e){return y(this,null,function*(){let t=V(n);return yield t.persistence.runTransaction("Handle user change","readonly",r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,t.ls(e),t.mutationQueue.getAllMutationBatches(r))).next(s=>{let o=[],a=[],c=ee();for(let l of i){o.push(l.batchId);for(let d of l.mutations)c=c.add(d.key)}for(let l of s){a.push(l.batchId);for(let d of l.mutations)c=c.add(d.key)}return t.localDocuments.getDocuments(r,c).next(l=>({hs:l,removedBatchIds:o,addedBatchIds:a}))})})})}function k1(n,e){let t=V(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{let i=e.batch.keys(),s=t.cs.newChangeBuffer({trackRemovals:!0});return function(a,c,l,d){let p=l.batch,m=p.keys(),w=C.resolve();return m.forEach(D=>{w=w.next(()=>d.getEntry(c,D)).next(k=>{let S=l.docVersions.get(D);G(S!==null),k.version.compareTo(S)<0&&(p.applyToRemoteDocument(k,l),k.isValidDocument()&&(k.setReadTime(l.commitVersion),d.addEntry(k)))})}),w.next(()=>a.mutationQueue.removeMutationBatch(c,p))}(t,r,e,s).next(()=>s.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let c=ee();for(let l=0;l<a.mutationResults.length;++l)a.mutationResults[l].transformResults.length>0&&(c=c.add(a.batch.mutations[l].key));return c}(e))).next(()=>t.localDocuments.getDocuments(r,i))})}function $0(n){let e=V(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Ur.getLastRemoteSnapshotVersion(t))}function O1(n,e){let t=V(n),r=e.snapshotVersion,i=t.os;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{let o=t.cs.newChangeBuffer({trackRemovals:!0});i=t.os;let a=[];e.targetChanges.forEach((d,p)=>{let m=i.get(p);if(!m)return;a.push(t.Ur.removeMatchingKeys(s,d.removedDocuments,p).next(()=>t.Ur.addMatchingKeys(s,d.addedDocuments,p)));let w=m.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(p)!==null?w=w.withResumeToken(Fe.EMPTY_BYTE_STRING,H.min()).withLastLimboFreeSnapshotVersion(H.min()):d.resumeToken.approximateByteSize()>0&&(w=w.withResumeToken(d.resumeToken,r)),i=i.insert(p,w),function(k,S,x){return k.resumeToken.approximateByteSize()===0||S.snapshotVersion.toMicroseconds()-k.snapshotVersion.toMicroseconds()>=3e8?!0:x.addedDocuments.size+x.modifiedDocuments.size+x.removedDocuments.size>0}(m,w,d)&&a.push(t.Ur.updateTargetData(s,w))});let c=yt(),l=ee();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(s,d))}),a.push(j0(s,o,e.documentUpdates).next(d=>{c=d.Ps,l=d.Is})),!r.isEqual(H.min())){let d=t.Ur.getLastRemoteSnapshotVersion(s).next(p=>t.Ur.setTargetsMetadata(s,s.currentSequenceNumber,r));a.push(d)}return C.waitFor(a).next(()=>o.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,c,l)).next(()=>c)}).then(s=>(t.os=i,s))}function j0(n,e,t){let r=ee(),i=ee();return t.forEach(s=>r=r.add(s)),e.getEntries(n,r).next(s=>{let o=yt();return t.forEach((a,c)=>{let l=s.get(a);c.isFoundDocument()!==l.isFoundDocument()&&(i=i.add(a)),c.isNoDocument()&&c.version.isEqual(H.min())?(e.removeEntry(a,c.readTime),o=o.insert(a,c)):!l.isValidDocument()||c.version.compareTo(l.version)>0||c.version.compareTo(l.version)===0&&l.hasPendingWrites?(e.addEntry(c),o=o.insert(a,c)):O("LocalStore","Ignoring outdated watch update for ",a,". Current version:",l.version," Watch version:",c.version)}),{Ps:o,Is:i}})}function M1(n,e){let t=V(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function Cs(n,e){let t=V(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return t.Ur.getTargetData(r,e).next(s=>s?(i=s,C.resolve(i)):t.Ur.allocateTargetId(r).next(o=>(i=new Ss(e,o,"TargetPurposeListen",r.currentSequenceNumber),t.Ur.addTargetData(r,i).next(()=>i))))}).then(r=>{let i=t.os.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.os=t.os.insert(r.targetId,r),t._s.set(e,r.targetId)),r})}function Ps(n,e,t){return y(this,null,function*(){let r=V(n),i=r.os.get(e),s=t?"readwrite":"readwrite-primary";try{t||(yield r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i)))}catch(o){if(!Or(o))throw o;O("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.os=r.os.remove(e),r._s.delete(i.target)})}function Al(n,e,t){let r=V(n),i=H.min(),s=ee();return r.persistence.runTransaction("Execute query","readwrite",o=>function(c,l,d){let p=V(c),m=p._s.get(d);return m!==void 0?C.resolve(p.os.get(m)):p.Ur.getTargetData(l,d)}(r,o,pt(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(o,a.targetId).next(c=>{s=c})}).next(()=>r.ss.getDocumentsMatchingQuery(o,e,t?i:H.min(),t?s:ee())).next(a=>(G0(r,i0(e),a),{documents:a,Ts:s})))}function z0(n,e){let t=V(n),r=V(t.Ur),i=t.os.get(e);return i?Promise.resolve(i.target):t.persistence.runTransaction("Get target data","readonly",s=>r.ot(s,e).next(o=>o?o.target:null))}function q0(n,e){let t=V(n),r=t.us.get(e)||H.min();return t.persistence.runTransaction("Get new document changes","readonly",i=>t.cs.getAllFromCollectionGroup(i,e,VT(r,-1),Number.MAX_SAFE_INTEGER)).then(i=>(G0(t,e,i),i))}function G0(n,e,t){let r=n.us.get(e)||H.min();t.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),n.us.set(e,r)}function x1(n,e,t,r){return y(this,null,function*(){let i=V(n),s=ee(),o=yt();for(let l of t){let d=e.Es(l.metadata.name);l.document&&(s=s.add(d));let p=e.ds(l);p.setReadTime(e.As(l.metadata.readTime)),o=o.insert(d,p)}let a=i.cs.newChangeBuffer({trackRemovals:!0}),c=yield Cs(i,function(d){return pt(Vs(ae.fromString(`__bundle__/docs/${d}`)))}(r));return i.persistence.runTransaction("Apply bundle documents","readwrite",l=>j0(l,a,o).next(d=>(a.apply(l),d)).next(d=>i.Ur.removeMatchingKeysForTargetId(l,c.targetId).next(()=>i.Ur.addMatchingKeys(l,s,c.targetId)).next(()=>i.localDocuments.getLocalViewOfDocuments(l,d.Ps,d.Is)).next(()=>d.Ps)))})}function F1(r,i){return y(this,arguments,function*(n,e,t=ee()){let s=yield Cs(n,pt(zm(e.bundledQuery))),o=V(n);return o.persistence.runTransaction("Save named query","readwrite",a=>{let c=Me(e.readTime);if(s.snapshotVersion.compareTo(c)>=0)return o.Gr.saveNamedQuery(a,e);let l=s.withResumeToken(Fe.EMPTY_BYTE_STRING,c);return o.os=o.os.insert(l.targetId,l),o.Ur.updateTargetData(a,l).next(()=>o.Ur.removeMatchingKeysForTargetId(a,s.targetId)).next(()=>o.Ur.addMatchingKeys(a,t,s.targetId)).next(()=>o.Gr.saveNamedQuery(a,e))})})}function TT(n,e){return`firestore_clients_${n}_${e}`}function AT(n,e,t){let r=`firestore_mutations_${n}_${t}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}function Np(n,e){return`firestore_targets_${n}_${e}`}var bl=class n{constructor(e,t,r,i){this.user=e,this.batchId=t,this.state=r,this.error=i}static Rs(e,t,r){let i=JSON.parse(r),s,o=typeof i=="object"&&["pending","acknowledged","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return o&&i.error&&(o=typeof i.error.message=="string"&&typeof i.error.code=="string",o&&(s=new M(i.error.code,i.error.message))),o?new n(e,t,i.state,s):(ke("SharedClientState",`Failed to parse mutation state for ID '${t}': ${r}`),null)}Vs(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},wa=class n{constructor(e,t,r){this.targetId=e,this.state=t,this.error=r}static Rs(e,t){let r=JSON.parse(t),i,s=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return s&&r.error&&(s=typeof r.error.message=="string"&&typeof r.error.code=="string",s&&(i=new M(r.error.code,r.error.message))),s?new n(e,r.state,i):(ke("SharedClientState",`Failed to parse target state for ID '${e}': ${t}`),null)}Vs(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},Dl=class n{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Rs(e,t){let r=JSON.parse(t),i=typeof r=="object"&&r.activeTargetIds instanceof Array,s=Bm();for(let o=0;i&&o<r.activeTargetIds.length;++o)i=jT(r.activeTargetIds[o]),s=s.add(r.activeTargetIds[o]);return i?new n(e,s):(ke("SharedClientState",`Failed to parse client data for instance '${e}': ${t}`),null)}},Wg=class n{constructor(e,t){this.clientId=e,this.onlineState=t}static Rs(e){let t=JSON.parse(e);return typeof t=="object"&&["Unknown","Online","Offline"].indexOf(t.onlineState)!==-1&&typeof t.clientId=="string"?new n(t.clientId,t.onlineState):(ke("SharedClientState",`Failed to parse online state: ${e}`),null)}},La=class{constructor(){this.activeTargetIds=Bm()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}},Ea=class{constructor(e,t,r,i,s){this.window=e,this.ui=t,this.persistenceKey=r,this.ps=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.ys=this.ws.bind(this),this.Ss=new Te(Z),this.started=!1,this.bs=[];let o=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=s,this.Ds=TT(this.persistenceKey,this.ps),this.vs=function(c){return`firestore_sequence_number_${c}`}(this.persistenceKey),this.Ss=this.Ss.insert(this.ps,new La),this.Cs=new RegExp(`^firestore_clients_${o}_([^_]*)$`),this.Fs=new RegExp(`^firestore_mutations_${o}_(\\d+)(?:_(.*))?$`),this.Ms=new RegExp(`^firestore_targets_${o}_(\\d+)$`),this.xs=function(c){return`firestore_online_state_${c}`}(this.persistenceKey),this.Os=function(c){return`firestore_bundle_loaded_v2_${c}`}(this.persistenceKey),this.window.addEventListener("storage",this.ys)}static D(e){return!(!e||!e.localStorage)}start(){return y(this,null,function*(){let e=yield this.syncEngine.Qi();for(let r of e){if(r===this.ps)continue;let i=this.getItem(TT(this.persistenceKey,r));if(i){let s=Dl.Rs(r,i);s&&(this.Ss=this.Ss.insert(s.clientId,s))}}this.Ns();let t=this.storage.getItem(this.xs);if(t){let r=this.Ls(t);r&&this.Bs(r)}for(let r of this.bs)this.ws(r);this.bs=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0})}writeSequenceNumber(e){this.setItem(this.vs,JSON.stringify(e))}getAllActiveQueryTargets(){return this.ks(this.Ss)}isActiveQueryTarget(e){let t=!1;return this.Ss.forEach((r,i)=>{i.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this.qs(e,"pending")}updateMutationState(e,t,r){this.qs(e,t,r),this.Qs(e)}addLocalQueryTarget(e){let t="not-current";if(this.isActiveQueryTarget(e)){let r=this.storage.getItem(Np(this.persistenceKey,e));if(r){let i=wa.Rs(e,r);i&&(t=i.state)}}return this.Ks.fs(e),this.Ns(),t}removeLocalQueryTarget(e){this.Ks.gs(e),this.Ns()}isLocalQueryTarget(e){return this.Ks.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(Np(this.persistenceKey,e))}updateQueryState(e,t,r){this.$s(e,t,r)}handleUserChange(e,t,r){t.forEach(i=>{this.Qs(i)}),this.currentUser=e,r.forEach(i=>{this.addPendingMutation(i)})}setOnlineState(e){this.Us(e)}notifyBundleLoaded(e){this.Ws(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.ys),this.removeItem(this.Ds),this.started=!1)}getItem(e){let t=this.storage.getItem(e);return O("SharedClientState","READ",e,t),t}setItem(e,t){O("SharedClientState","SET",e,t),this.storage.setItem(e,t)}removeItem(e){O("SharedClientState","REMOVE",e),this.storage.removeItem(e)}ws(e){let t=e;if(t.storageArea===this.storage){if(O("SharedClientState","EVENT",t.key,t.newValue),t.key===this.Ds)return void ke("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.ui.enqueueRetryable(()=>y(this,null,function*(){if(this.started){if(t.key!==null){if(this.Cs.test(t.key)){if(t.newValue==null){let r=this.Gs(t.key);return this.zs(r,null)}{let r=this.js(t.key,t.newValue);if(r)return this.zs(r.clientId,r)}}else if(this.Fs.test(t.key)){if(t.newValue!==null){let r=this.Hs(t.key,t.newValue);if(r)return this.Js(r)}}else if(this.Ms.test(t.key)){if(t.newValue!==null){let r=this.Ys(t.key,t.newValue);if(r)return this.Zs(r)}}else if(t.key===this.xs){if(t.newValue!==null){let r=this.Ls(t.newValue);if(r)return this.Bs(r)}}else if(t.key===this.vs){let r=function(s){let o=At.oe;if(s!=null)try{let a=JSON.parse(s);G(typeof a=="number"),o=a}catch(a){ke("SharedClientState","Failed to read sequence number from WebStorage",a)}return o}(t.newValue);r!==At.oe&&this.sequenceNumberHandler(r)}else if(t.key===this.Os){let r=this.Xs(t.newValue);yield Promise.all(r.map(i=>this.syncEngine.eo(i)))}}}else this.bs.push(t)}))}}get Ks(){return this.Ss.get(this.ps)}Ns(){this.setItem(this.Ds,this.Ks.Vs())}qs(e,t,r){let i=new bl(this.currentUser,e,t,r),s=AT(this.persistenceKey,this.currentUser,e);this.setItem(s,i.Vs())}Qs(e){let t=AT(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Us(e){let t={clientId:this.ps,onlineState:e};this.storage.setItem(this.xs,JSON.stringify(t))}$s(e,t,r){let i=Np(this.persistenceKey,e),s=new wa(e,t,r);this.setItem(i,s.Vs())}Ws(e){let t=JSON.stringify(Array.from(e));this.setItem(this.Os,t)}Gs(e){let t=this.Cs.exec(e);return t?t[1]:null}js(e,t){let r=this.Gs(e);return Dl.Rs(r,t)}Hs(e,t){let r=this.Fs.exec(e),i=Number(r[1]),s=r[2]!==void 0?r[2]:null;return bl.Rs(new qe(s),i,t)}Ys(e,t){let r=this.Ms.exec(e),i=Number(r[1]);return wa.Rs(i,t)}Ls(e){return Wg.Rs(e)}Xs(e){return JSON.parse(e)}Js(e){return y(this,null,function*(){if(e.user.uid===this.currentUser.uid)return this.syncEngine.no(e.batchId,e.state,e.error);O("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)})}Zs(e){return this.syncEngine.ro(e.targetId,e.state,e.error)}zs(e,t){let r=t?this.Ss.insert(e,t):this.Ss.remove(e),i=this.ks(this.Ss),s=this.ks(r),o=[],a=[];return s.forEach(c=>{i.has(c)||o.push(c)}),i.forEach(c=>{s.has(c)||a.push(c)}),this.syncEngine.io(o,a).then(()=>{this.Ss=r})}Bs(e){this.Ss.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}ks(e){let t=Bm();return e.forEach((r,i)=>{t=t.unionWith(i.activeTargetIds)}),t}},Sl=class{constructor(){this.so=new La,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e){return this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,t,r){this.oo[e]=t}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new La,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var Hg=class{_o(e){}shutdown(){}};var Rl=class{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){O("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(let e of this.ho)e(0)}lo(){O("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(let e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var qc=null;function kp(){return qc===null?qc=function(){return 268435456+Math.round(2147483648*Math.random())}():qc++,"0x"+qc.toString(16)}var L1={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};var Kg=class{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}};var ut="WebChannelConnection",Qg=class extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;let r=t.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+t.host,this.vo=`projects/${i}/databases/${s}`,this.Co=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get Fo(){return!1}Mo(t,r,i,s,o){let a=kp(),c=this.xo(t,r.toUriEncodedString());O("RestConnection",`Sending RPC '${t}' ${a}:`,c,i);let l={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(l,s,o),this.No(t,c,l,i).then(d=>(O("RestConnection",`Received RPC '${t}' ${a}: `,d),d),d=>{throw un("RestConnection",`RPC '${t}' ${a} failed with error: `,d,"url: ",c,"request:",i),d})}Lo(t,r,i,s,o,a){return this.Mo(t,r,i,s,o)}Oo(t,r,i){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Ls}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,o)=>t[o]=s),i&&i.headers.forEach((s,o)=>t[o]=s)}xo(t,r){let i=L1[t];return`${this.Do}/v1/${r}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,t,r,i){let s=kp();return new Promise((o,a)=>{let c=new Tp;c.setWithCredentials(!0),c.listenOnce(bp.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case la.NO_ERROR:let d=c.getResponseJson();O(ut,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(d)),o(d);break;case la.TIMEOUT:O(ut,`RPC '${e}' ${s} timed out`),a(new M(P.DEADLINE_EXCEEDED,"Request time out"));break;case la.HTTP_ERROR:let p=c.getStatus();if(O(ut,`RPC '${e}' ${s} failed with status:`,p,"response text:",c.getResponseText()),p>0){let m=c.getResponseJson();Array.isArray(m)&&(m=m[0]);let w=m?.error;if(w&&w.status&&w.message){let D=function(S){let x=S.toLowerCase().replace(/_/g,"-");return Object.values(P).indexOf(x)>=0?x:P.UNKNOWN}(w.status);a(new M(D,w.message))}else a(new M(P.UNKNOWN,"Server responded with status "+c.getStatus()))}else a(new M(P.UNAVAILABLE,"Connection failed."));break;default:z()}}finally{O(ut,`RPC '${e}' ${s} completed.`)}});let l=JSON.stringify(i);O(ut,`RPC '${e}' ${s} sending request:`,i),c.send(t,"POST",l,r,15)})}Bo(e,t,r){let i=kp(),s=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=Rp(),a=Sp(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;l!==void 0&&(c.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(c.xmlHttpFactory=new Ap({})),this.Oo(c.initMessageHeaders,t,r),c.encodeInitMessageHeaders=!0;let d=s.join("");O(ut,`Creating RPC '${e}' stream ${i}: ${d}`,c);let p=o.createWebChannel(d,c),m=!1,w=!1,D=new Kg({Io:S=>{w?O(ut,`Not sending because RPC '${e}' stream ${i} is closed:`,S):(m||(O(ut,`Opening RPC '${e}' stream ${i} transport.`),p.open(),m=!0),O(ut,`RPC '${e}' stream ${i} sending:`,S),p.send(S))},To:()=>p.close()}),k=(S,x,$)=>{S.listen(x,F=>{try{$(F)}catch(U){setTimeout(()=>{throw U},0)}})};return k(p,is.EventType.OPEN,()=>{w||(O(ut,`RPC '${e}' stream ${i} transport opened.`),D.yo())}),k(p,is.EventType.CLOSE,()=>{w||(w=!0,O(ut,`RPC '${e}' stream ${i} transport closed`),D.So())}),k(p,is.EventType.ERROR,S=>{w||(w=!0,un(ut,`RPC '${e}' stream ${i} transport errored:`,S),D.So(new M(P.UNAVAILABLE,"The operation could not be completed")))}),k(p,is.EventType.MESSAGE,S=>{var x;if(!w){let $=S.data[0];G(!!$);let F=$,U=F.error||((x=F[0])===null||x===void 0?void 0:x.error);if(U){O(ut,`RPC '${e}' stream ${i} received error:`,U);let J=U.status,W=function(E){let T=je[E];if(T!==void 0)return _0(T)}(J),I=U.message;W===void 0&&(W=P.INTERNAL,I="Unknown error status: "+J+" with message "+U.message),w=!0,D.So(new M(W,I)),p.close()}else O(ut,`RPC '${e}' stream ${i} received:`,$),D.bo($)}}),k(a,Dp.STAT_EVENT,S=>{S.stat===Bc.PROXY?O(ut,`RPC '${e}' stream ${i} detected buffering proxy`):S.stat===Bc.NOPROXY&&O(ut,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{D.wo()},0),D}};function W0(){return typeof window<"u"?window:null}function Qc(){return typeof document<"u"?document:null}function Ya(n){return new lg(n,!0)}var Va=class{constructor(e,t,r=1e3,i=1.5,s=6e4){this.ui=e,this.timerId=t,this.ko=r,this.qo=i,this.Qo=s,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();let t=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),i=Math.max(0,t-r);i>0&&O("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Ko} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,i,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}};var Cl=class{constructor(e,t,r,i,s,o,a,c){this.ui=e,this.Ho=r,this.Jo=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=c,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new Va(e,t)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}stop(){return y(this,null,function*(){this.n_()&&(yield this.close(0))})}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}__(){return y(this,null,function*(){if(this.r_())return this.close(0)})}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}close(e,t){return y(this,null,function*(){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():t&&t.code===P.RESOURCE_EXHAUSTED?(ke(t.toString()),ke("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):t&&t.code===P.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,yield this.listener.mo(t)})}l_(){}auth(){this.state=1;let e=this.h_(this.Yo),t=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Yo===t&&this.P_(r,i)},r=>{e(()=>{let i=new M(P.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(i)})})}P_(e,t){let r=this.h_(this.Yo);this.stream=this.T_(e,t),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(i=>{r(()=>this.I_(i))}),this.stream.onMessage(i=>{r(()=>++this.e_==1?this.E_(i):this.onNext(i))})}i_(){this.state=5,this.t_.Go(()=>y(this,null,function*(){this.state=0,this.start()}))}I_(e){return O("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return t=>{this.ui.enqueueAndForget(()=>this.Yo===e?t():(O("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},Yg=class extends Cl{constructor(e,t,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,o),this.serializer=s}T_(e,t){return this.connection.Bo("Listen",e,t)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();let t=E1(this.serializer,e),r=function(s){if(!("targetChange"in s))return H.min();let o=s.targetChange;return o.targetIds&&o.targetIds.length?H.min():o.readTime?Me(o.readTime):H.min()}(e);return this.listener.d_(t,r)}A_(e){let t={};t.database=fg(this.serializer),t.addTarget=function(s,o){let a,c=o.target;if(a=ol(c)?{documents:D0(s,c)}:{query:S0(s,c)._t},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=w0(s,o.resumeToken);let l=hg(s,o.expectedCount);l!==null&&(a.expectedCount=l)}else if(o.snapshotVersion.compareTo(H.min())>0){a.readTime=Ds(s,o.snapshotVersion.toTimestamp());let l=hg(s,o.expectedCount);l!==null&&(a.expectedCount=l)}return a}(this.serializer,e);let r=T1(this.serializer,e);r&&(t.labels=r),this.a_(t)}R_(e){let t={};t.database=fg(this.serializer),t.removeTarget=e,this.a_(t)}},Jg=class extends Cl{constructor(e,t,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,o),this.serializer=s}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,t){return this.connection.Bo("Write",e,t)}E_(e){return G(!!e.streamToken),this.lastStreamToken=e.streamToken,G(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){G(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();let t=I1(e.writeResults,e.commitTime),r=Me(e.commitTime);return this.listener.g_(r,t)}p_(){let e={};e.database=fg(this.serializer),this.a_(e)}m_(e){let t={streamToken:this.lastStreamToken,writes:e.map(r=>Ma(this.serializer,r))};this.a_(t)}};var Xg=class extends class{}{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.y_=!1}w_(){if(this.y_)throw new M(P.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,t,r,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Mo(e,dg(t,r),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===P.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new M(P.UNKNOWN,s.toString())})}Lo(e,t,r,i,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Lo(e,dg(t,r),i,o,a,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===P.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new M(P.UNKNOWN,o.toString())})}terminate(){this.y_=!0,this.connection.terminate()}},Zg=class{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(ke(t),this.D_=!1):O("OnlineStateTracker",t)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}};var em=class{constructor(e,t,r,i,s){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=s,this.k_._o(o=>{r.enqueueAndForget(()=>y(this,null,function*(){Mr(this)&&(O("RemoteStore","Restarting streams for network reachability change."),yield function(c){return y(this,null,function*(){let l=V(c);l.L_.add(4),yield Us(l),l.q_.set("Unknown"),l.L_.delete(4),yield Ja(l)})}(this))}))}),this.q_=new Zg(r,i)}};function Ja(n){return y(this,null,function*(){if(Mr(n))for(let e of n.B_)yield e(!0)})}function Us(n){return y(this,null,function*(){for(let e of n.B_)yield e(!1)})}function Ql(n,e){let t=V(n);t.N_.has(e.targetId)||(t.N_.set(e.targetId,e),Km(t)?Hm(t):$s(t).r_()&&Wm(t,e))}function Ns(n,e){let t=V(n),r=$s(t);t.N_.delete(e),r.r_()&&H0(t,e),t.N_.size===0&&(r.r_()?r.o_():Mr(t)&&t.q_.set("Unknown"))}function Wm(n,e){if(n.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(H.min())>0){let t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}$s(n).A_(e)}function H0(n,e){n.Q_.xe(e),$s(n).R_(e)}function Hm(n){n.Q_=new cg({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>n.N_.get(e)||null,tt:()=>n.datastore.serializer.databaseId}),$s(n).start(),n.q_.v_()}function Km(n){return Mr(n)&&!$s(n).n_()&&n.N_.size>0}function Mr(n){return V(n).L_.size===0}function K0(n){n.Q_=void 0}function V1(n){return y(this,null,function*(){n.q_.set("Online")})}function U1(n){return y(this,null,function*(){n.N_.forEach((e,t)=>{Wm(n,e)})})}function B1(n,e){return y(this,null,function*(){K0(n),Km(n)?(n.q_.M_(e),Hm(n)):n.q_.set("Unknown")})}function $1(n,e,t){return y(this,null,function*(){if(n.q_.set("Online"),e instanceof ll&&e.state===2&&e.cause)try{yield function(i,s){return y(this,null,function*(){let o=s.cause;for(let a of s.targetIds)i.N_.has(a)&&(yield i.remoteSyncer.rejectListen(a,o),i.N_.delete(a),i.Q_.removeTarget(a))})}(n,e)}catch(r){O("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),yield Pl(n,r)}else if(e instanceof ys?n.Q_.Ke(e):e instanceof cl?n.Q_.He(e):n.Q_.We(e),!t.isEqual(H.min()))try{let r=yield $0(n.localStore);t.compareTo(r)>=0&&(yield function(s,o){let a=s.Q_.rt(o);return a.targetChanges.forEach((c,l)=>{if(c.resumeToken.approximateByteSize()>0){let d=s.N_.get(l);d&&s.N_.set(l,d.withResumeToken(c.resumeToken,o))}}),a.targetMismatches.forEach((c,l)=>{let d=s.N_.get(c);if(!d)return;s.N_.set(c,d.withResumeToken(Fe.EMPTY_BYTE_STRING,d.snapshotVersion)),H0(s,c);let p=new Ss(d.target,c,l,d.sequenceNumber);Wm(s,p)}),s.remoteSyncer.applyRemoteEvent(a)}(n,t))}catch(r){O("RemoteStore","Failed to raise snapshot:",r),yield Pl(n,r)}})}function Pl(n,e,t){return y(this,null,function*(){if(!Or(e))throw e;n.L_.add(1),yield Us(n),n.q_.set("Offline"),t||(t=()=>$0(n.localStore)),n.asyncQueue.enqueueRetryable(()=>y(this,null,function*(){O("RemoteStore","Retrying IndexedDB access"),yield t(),n.L_.delete(1),yield Ja(n)}))})}function Q0(n,e){return e().catch(t=>Pl(n,t,e))}function Bs(n){return y(this,null,function*(){let e=V(n),t=Rr(e),r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;j1(e);)try{let i=yield M1(e.localStore,r);if(i===null){e.O_.length===0&&t.o_();break}r=i.batchId,z1(e,i)}catch(i){yield Pl(e,i)}Y0(e)&&J0(e)})}function j1(n){return Mr(n)&&n.O_.length<10}function z1(n,e){n.O_.push(e);let t=Rr(n);t.r_()&&t.V_&&t.m_(e.mutations)}function Y0(n){return Mr(n)&&!Rr(n).n_()&&n.O_.length>0}function J0(n){Rr(n).start()}function q1(n){return y(this,null,function*(){Rr(n).p_()})}function G1(n){return y(this,null,function*(){let e=Rr(n);for(let t of n.O_)e.m_(t.mutations)})}function W1(n,e,t){return y(this,null,function*(){let r=n.O_.shift(),i=og.from(r,e,t);yield Q0(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),yield Bs(n)})}function H1(n,e){return y(this,null,function*(){e&&Rr(n).V_&&(yield function(r,i){return y(this,null,function*(){if(function(o){return y0(o)&&o!==P.ABORTED}(i.code)){let s=r.O_.shift();Rr(r).s_(),yield Q0(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),yield Bs(r)}})}(n,e)),Y0(n)&&J0(n)})}function bT(n,e){return y(this,null,function*(){let t=V(n);t.asyncQueue.verifyOperationInProgress(),O("RemoteStore","RemoteStore received new credentials");let r=Mr(t);t.L_.add(3),yield Us(t),r&&t.q_.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t.L_.delete(3),yield Ja(t)})}function tm(n,e){return y(this,null,function*(){let t=V(n);e?(t.L_.delete(2),yield Ja(t)):e||(t.L_.add(2),yield Us(t),t.q_.set("Unknown"))})}function $s(n){return n.K_||(n.K_=function(t,r,i){let s=V(t);return s.w_(),new Yg(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(n.datastore,n.asyncQueue,{Eo:V1.bind(null,n),Ro:U1.bind(null,n),mo:B1.bind(null,n),d_:$1.bind(null,n)}),n.B_.push(e=>y(this,null,function*(){e?(n.K_.s_(),Km(n)?Hm(n):n.q_.set("Unknown")):(yield n.K_.stop(),K0(n))}))),n.K_}function Rr(n){return n.U_||(n.U_=function(t,r,i){let s=V(t);return s.w_(),new Jg(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(n.datastore,n.asyncQueue,{Eo:()=>Promise.resolve(),Ro:q1.bind(null,n),mo:H1.bind(null,n),f_:G1.bind(null,n),g_:W1.bind(null,n)}),n.B_.push(e=>y(this,null,function*(){e?(n.U_.s_(),yield Bs(n)):(yield n.U_.stop(),n.O_.length>0&&(O("RemoteStore",`Stopping write stream with ${n.O_.length} pending writes`),n.O_=[]))}))),n.U_}var nm=class n{constructor(e,t,r,i,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new Ge,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,s){let o=Date.now()+r,a=new n(e,t,o,i,s);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new M(P.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function js(n,e){if(ke("AsyncQueue",`${e}: ${n}`),Or(n))return new M(P.UNAVAILABLE,`${e}: ${n}`);throw n}var Nl=class n{constructor(e){this.comparator=e?(t,r)=>e(t,r)||B.comparator(t.key,r.key):(t,r)=>B.comparator(t.key,r.key),this.keyedMap=ga(),this.sortedSet=new Te(this.comparator)}static emptySet(e){return new n(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){let t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){let t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){let i=t.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){let e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){let r=new n;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}};var kl=class{constructor(){this.W_=new Te(B.comparator)}track(e){let t=e.doc.key,r=this.W_.get(t);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(t,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(t):e.type===1&&r.type===2?this.W_=this.W_.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):z():this.W_=this.W_.insert(t,e)}G_(){let e=[];return this.W_.inorderTraversal((t,r)=>{e.push(r)}),e}},ks=class n{constructor(e,t,r,i,s,o,a,c,l){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=c,this.hasCachedResults=l}static fromInitialDocuments(e,t,r,i,s){let o=[];return t.forEach(a=>{o.push({type:0,doc:a})}),new n(e,t,Nl.emptySet(t),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Ka(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}};var rm=class{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}},im=class{constructor(){this.queries=DT(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(t,r){let i=V(t),s=i.queries;i.queries=DT(),s.forEach((o,a)=>{for(let c of a.j_)c.onError(r)})})(this,new M(P.ABORTED,"Firestore shutting down"))}};function DT(){return new hn(n=>r0(n),Ka)}function Qm(n,e){return y(this,null,function*(){let t=V(n),r=3,i=e.query,s=t.queries.get(i);s?!s.H_()&&e.J_()&&(r=2):(s=new rm,r=e.J_()?0:1);try{switch(r){case 0:s.z_=yield t.onListen(i,!0);break;case 1:s.z_=yield t.onListen(i,!1);break;case 2:yield t.onFirstRemoteStoreListen(i)}}catch(o){let a=js(o,`Initialization of query '${ls(e.query)}' failed`);return void e.onError(a)}t.queries.set(i,s),s.j_.push(e),e.Z_(t.onlineState),s.z_&&e.X_(s.z_)&&Jm(t)})}function Ym(n,e){return y(this,null,function*(){let t=V(n),r=e.query,i=3,s=t.queries.get(r);if(s){let o=s.j_.indexOf(e);o>=0&&(s.j_.splice(o,1),s.j_.length===0?i=e.J_()?0:1:!s.H_()&&e.J_()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}})}function K1(n,e){let t=V(n),r=!1;for(let i of e){let s=i.query,o=t.queries.get(s);if(o){for(let a of o.j_)a.X_(i)&&(r=!0);o.z_=i}}r&&Jm(t)}function Q1(n,e,t){let r=V(n),i=r.queries.get(e);if(i)for(let s of i.j_)s.onError(t);r.queries.delete(e)}function Jm(n){n.Y_.forEach(e=>{e.next()})}var sm,ST;(ST=sm||(sm={})).ea="default",ST.Cache="cache";var Ua=class{constructor(e,t,r){this.query=e,this.ta=t,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){let r=[];for(let i of e.docChanges)i.type!==3&&r.push(i);e=new ks(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.na?this.ia(e)&&(this.ta.next(e),t=!0):this.sa(e,this.onlineState)&&(this.oa(e),t=!0),this.ra=e,t}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let t=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),t=!0),t}sa(e,t){if(!e.fromCache||!this.J_())return!0;let r=t!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}ia(e){if(e.docChanges.length>0)return!0;let t=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}oa(e){e=ks.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==sm.Cache}};var om=class{constructor(e,t){this.aa=e,this.byteLength=t}ua(){return"metadata"in this.aa}};var Ol=class{constructor(e){this.serializer=e}Es(e){return on(this.serializer,e)}ds(e){return e.metadata.exists?b0(this.serializer,e.document,!1):We.newNoDocument(this.Es(e.metadata.name),this.As(e.metadata.readTime))}As(e){return Me(e)}},am=class{constructor(e,t,r){this.ca=e,this.localStore=t,this.serializer=r,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=X0(e)}la(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.aa.namedQuery)this.queries.push(e.aa.namedQuery);else if(e.aa.documentMetadata){this.documents.push({metadata:e.aa.documentMetadata}),e.aa.documentMetadata.exists||++t;let r=ae.fromString(e.aa.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.aa.document&&(this.documents[this.documents.length-1].document=e.aa.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}ha(e){let t=new Map,r=new Ol(this.serializer);for(let i of e)if(i.metadata.queries){let s=r.Es(i.metadata.name);for(let o of i.metadata.queries){let a=(t.get(o)||ee()).add(s);t.set(o,a)}}return t}complete(){return y(this,null,function*(){let e=yield x1(this.localStore,new Ol(this.serializer),this.documents,this.ca.id),t=this.ha(this.documents);for(let r of this.queries)yield F1(this.localStore,r,t.get(r.name));return this.progress.taskState="Success",{progress:this.progress,Pa:this.collectionGroups,Ia:e}})}};function X0(n){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:n.totalDocuments,totalBytes:n.totalBytes}}var Ml=class{constructor(e){this.key=e}},xl=class{constructor(e){this.key=e}},Fl=class{constructor(e,t){this.query=e,this.Ta=t,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=ee(),this.mutatedKeys=ee(),this.Aa=s0(e),this.Ra=new Nl(this.Aa)}get Va(){return this.Ta}ma(e,t){let r=t?t.fa:new kl,i=t?t.Ra:this.Ra,s=t?t.mutatedKeys:this.mutatedKeys,o=i,a=!1,c=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,l=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((d,p)=>{let m=i.get(d),w=Qa(this.query,p)?p:null,D=!!m&&this.mutatedKeys.has(m.key),k=!!w&&(w.hasLocalMutations||this.mutatedKeys.has(w.key)&&w.hasCommittedMutations),S=!1;m&&w?m.data.isEqual(w.data)?D!==k&&(r.track({type:3,doc:w}),S=!0):this.ga(m,w)||(r.track({type:2,doc:w}),S=!0,(c&&this.Aa(w,c)>0||l&&this.Aa(w,l)<0)&&(a=!0)):!m&&w?(r.track({type:0,doc:w}),S=!0):m&&!w&&(r.track({type:1,doc:m}),S=!0,(c||l)&&(a=!0)),S&&(w?(o=o.add(w),s=k?s.add(d):s.delete(d)):(o=o.delete(d),s=s.delete(d)))}),this.query.limit!==null)for(;o.size>this.query.limit;){let d=this.query.limitType==="F"?o.last():o.first();o=o.delete(d.key),s=s.delete(d.key),r.track({type:1,doc:d})}return{Ra:o,fa:r,ns:a,mutatedKeys:s}}ga(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){let s=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;let o=e.fa.G_();o.sort((d,p)=>function(w,D){let k=S=>{switch(S){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return z()}};return k(w)-k(D)}(d.type,p.type)||this.Aa(d.doc,p.doc)),this.pa(r),i=i!=null&&i;let a=t&&!i?this.ya():[],c=this.da.size===0&&this.current&&!i?1:0,l=c!==this.Ea;return this.Ea=c,o.length!==0||l?{snapshot:new ks(this.query,e.Ra,s,o,e.mutatedKeys,c===0,l,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:a}:{wa:a}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new kl,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(t=>this.Ta=this.Ta.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ta=this.Ta.delete(t)),this.current=e.current)}ya(){if(!this.current)return[];let e=this.da;this.da=ee(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});let t=[];return e.forEach(r=>{this.da.has(r)||t.push(new xl(r))}),this.da.forEach(r=>{e.has(r)||t.push(new Ml(r))}),t}ba(e){this.Ta=e.Ts,this.da=ee();let t=this.ma(e.documents);return this.applyChanges(t,!0)}Da(){return ks.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}},um=class{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}},cm=class{constructor(e){this.key=e,this.va=!1}},lm=class{constructor(e,t,r,i,s,o){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Ca={},this.Fa=new hn(a=>r0(a),Ka),this.Ma=new Map,this.xa=new Set,this.Oa=new Te(B.comparator),this.Na=new Map,this.La=new Fa,this.Ba={},this.ka=new Map,this.qa=Rs.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}};function Y1(n,e,t=!0){return y(this,null,function*(){let r=Yl(n),i,s=r.Fa.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.Da()):i=yield Z0(r,e,t,!0),i})}function J1(n,e){return y(this,null,function*(){let t=Yl(n);yield Z0(t,e,!0,!1)})}function Z0(n,e,t,r){return y(this,null,function*(){let i=yield Cs(n.localStore,pt(e)),s=i.targetId,o=t?n.sharedClientState.addLocalQueryTarget(s):"not-current",a;return r&&(a=yield Xm(n,e,s,o==="current",i.resumeToken)),n.isPrimaryClient&&t&&Ql(n.remoteStore,i),a})}function Xm(n,e,t,r,i){return y(this,null,function*(){n.Ka=(p,m,w)=>function(k,S,x,$){return y(this,null,function*(){let F=S.view.ma(x);F.ns&&(F=yield Al(k.localStore,S.query,!1).then(({documents:I})=>S.view.ma(I,F)));let U=$&&$.targetChanges.get(S.targetId),J=$&&$.targetMismatches.get(S.targetId)!=null,W=S.view.applyChanges(F,k.isPrimaryClient,U,J);return hm(k,S.targetId,W.wa),W.snapshot})}(n,p,m,w);let s=yield Al(n.localStore,e,!0),o=new Fl(e,s.Ts),a=o.ma(s.documents),c=ka.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),l=o.applyChanges(a,n.isPrimaryClient,c);hm(n,t,l.wa);let d=new um(e,t,o);return n.Fa.set(e,d),n.Ma.has(t)?n.Ma.get(t).push(e):n.Ma.set(t,[e]),l.snapshot})}function X1(n,e,t){return y(this,null,function*(){let r=V(n),i=r.Fa.get(e),s=r.Ma.get(i.targetId);if(s.length>1)return r.Ma.set(i.targetId,s.filter(o=>!Ka(o,e))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||(yield Ps(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),t&&Ns(r.remoteStore,i.targetId),Os(r,i.targetId)}).catch(kr))):(Os(r,i.targetId),yield Ps(r.localStore,i.targetId,!0))})}function Z1(n,e){return y(this,null,function*(){let t=V(n),r=t.Fa.get(e),i=t.Ma.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),Ns(t.remoteStore,r.targetId))})}function eM(n,e,t){return y(this,null,function*(){let r=ny(n);try{let i=yield function(o,a){let c=V(o),l=Oe.now(),d=a.reduce((w,D)=>w.add(D.key),ee()),p,m;return c.persistence.runTransaction("Locally write mutations","readwrite",w=>{let D=yt(),k=ee();return c.cs.getEntries(w,d).next(S=>{D=S,D.forEach((x,$)=>{$.isValidDocument()||(k=k.add(x))})}).next(()=>c.localDocuments.getOverlayedDocuments(w,D)).next(S=>{p=S;let x=[];for(let $ of a){let F=p1($,p.get($.key).overlayedDocument);F!=null&&x.push(new Gt($.key,F,YT(F.value.mapValue),Re.exists(!0)))}return c.mutationQueue.addMutationBatch(w,l,x,a)}).next(S=>{m=S;let x=S.applyToLocalDocumentSet(p,k);return c.documentOverlayCache.saveOverlays(w,S.batchId,x)})}).then(()=>({batchId:m.batchId,changes:a0(p)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(o,a,c){let l=o.Ba[o.currentUser.toKey()];l||(l=new Te(Z)),l=l.insert(a,c),o.Ba[o.currentUser.toKey()]=l}(r,i.batchId,t),yield jn(r,i.changes),yield Bs(r.remoteStore)}catch(i){let s=js(i,"Failed to persist write");t.reject(s)}})}function eA(n,e){return y(this,null,function*(){let t=V(n);try{let r=yield O1(t.localStore,e);e.targetChanges.forEach((i,s)=>{let o=t.Na.get(s);o&&(G(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?o.va=!0:i.modifiedDocuments.size>0?G(o.va):i.removedDocuments.size>0&&(G(o.va),o.va=!1))}),yield jn(t,r,e)}catch(r){yield kr(r)}})}function RT(n,e,t){let r=V(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){let i=[];r.Fa.forEach((s,o)=>{let a=o.view.Z_(e);a.snapshot&&i.push(a.snapshot)}),function(o,a){let c=V(o);c.onlineState=a;let l=!1;c.queries.forEach((d,p)=>{for(let m of p.j_)m.Z_(a)&&(l=!0)}),l&&Jm(c)}(r.eventManager,e),i.length&&r.Ca.d_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function tM(n,e,t){return y(this,null,function*(){let r=V(n);r.sharedClientState.updateQueryState(e,"rejected",t);let i=r.Na.get(e),s=i&&i.key;if(s){let o=new Te(B.comparator);o=o.insert(s,We.newNoDocument(s,H.min()));let a=ee().add(s),c=new Na(H.min(),new Map,new Te(Z),o,a);yield eA(r,c),r.Oa=r.Oa.remove(s),r.Na.delete(e),ty(r)}else yield Ps(r.localStore,e,!1).then(()=>Os(r,e,t)).catch(kr)})}function nM(n,e){return y(this,null,function*(){let t=V(n),r=e.batch.batchId;try{let i=yield k1(t.localStore,e);ey(t,r,null),Zm(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),yield jn(t,i)}catch(i){yield kr(i)}})}function rM(n,e,t){return y(this,null,function*(){let r=V(n);try{let i=yield function(o,a){let c=V(o);return c.persistence.runTransaction("Reject batch","readwrite-primary",l=>{let d;return c.mutationQueue.lookupMutationBatch(l,a).next(p=>(G(p!==null),d=p.keys(),c.mutationQueue.removeMutationBatch(l,p))).next(()=>c.mutationQueue.performConsistencyCheck(l)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(l,d,a)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(l,d)).next(()=>c.localDocuments.getDocuments(l,d))})}(r.localStore,e);ey(r,e,t),Zm(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),yield jn(r,i)}catch(i){yield kr(i)}})}function iM(n,e){return y(this,null,function*(){let t=V(n);Mr(t.remoteStore)||O("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{let r=yield function(o){let a=V(o);return a.persistence.runTransaction("Get highest unacknowledged batch id","readonly",c=>a.mutationQueue.getHighestUnacknowledgedBatchId(c))}(t.localStore);if(r===-1)return void e.resolve();let i=t.ka.get(r)||[];i.push(e),t.ka.set(r,i)}catch(r){let i=js(r,"Initialization of waitForPendingWrites() operation failed");e.reject(i)}})}function Zm(n,e){(n.ka.get(e)||[]).forEach(t=>{t.resolve()}),n.ka.delete(e)}function ey(n,e,t){let r=V(n),i=r.Ba[r.currentUser.toKey()];if(i){let s=i.get(e);s&&(t?s.reject(t):s.resolve(),i=i.remove(e)),r.Ba[r.currentUser.toKey()]=i}}function Os(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(let r of n.Ma.get(e))n.Fa.delete(r),t&&n.Ca.$a(r,t);n.Ma.delete(e),n.isPrimaryClient&&n.La.gr(e).forEach(r=>{n.La.containsKey(r)||tA(n,r)})}function tA(n,e){n.xa.delete(e.path.canonicalString());let t=n.Oa.get(e);t!==null&&(Ns(n.remoteStore,t),n.Oa=n.Oa.remove(e),n.Na.delete(t),ty(n))}function hm(n,e,t){for(let r of t)r instanceof Ml?(n.La.addReference(r.key,e),sM(n,r)):r instanceof xl?(O("SyncEngine","Document no longer in limbo: "+r.key),n.La.removeReference(r.key,e),n.La.containsKey(r.key)||tA(n,r.key)):z()}function sM(n,e){let t=e.key,r=t.path.canonicalString();n.Oa.get(t)||n.xa.has(r)||(O("SyncEngine","New document in limbo: "+t),n.xa.add(r),ty(n))}function ty(n){for(;n.xa.size>0&&n.Oa.size<n.maxConcurrentLimboResolutions;){let e=n.xa.values().next().value;n.xa.delete(e);let t=new B(ae.fromString(e)),r=n.qa.next();n.Na.set(r,new cm(t)),n.Oa=n.Oa.insert(t,r),Ql(n.remoteStore,new Ss(pt(Vs(t.path)),r,"TargetPurposeLimboResolution",At.oe))}}function jn(n,e,t){return y(this,null,function*(){let r=V(n),i=[],s=[],o=[];r.Fa.isEmpty()||(r.Fa.forEach((a,c)=>{o.push(r.Ka(c,e,t).then(l=>{var d;if((l||t)&&r.isPrimaryClient){let p=l?!l.fromCache:(d=t?.targetChanges.get(c.targetId))===null||d===void 0?void 0:d.current;r.sharedClientState.updateQueryState(c.targetId,p?"current":"not-current")}if(l){i.push(l);let p=zg.Wi(c.targetId,l);s.push(p)}}))}),yield Promise.all(o),r.Ca.d_(i),yield function(c,l){return y(this,null,function*(){let d=V(c);try{yield d.persistence.runTransaction("notifyLocalViewChanges","readwrite",p=>C.forEach(l,m=>C.forEach(m.$i,w=>d.persistence.referenceDelegate.addReference(p,m.targetId,w)).next(()=>C.forEach(m.Ui,w=>d.persistence.referenceDelegate.removeReference(p,m.targetId,w)))))}catch(p){if(!Or(p))throw p;O("LocalStore","Failed to update sequence numbers: "+p)}for(let p of l){let m=p.targetId;if(!p.fromCache){let w=d.os.get(m),D=w.snapshotVersion,k=w.withLastLimboFreeSnapshotVersion(D);d.os=d.os.insert(m,k)}}})}(r.localStore,s))})}function oM(n,e){return y(this,null,function*(){let t=V(n);if(!t.currentUser.isEqual(e)){O("SyncEngine","User change. New user:",e.toKey());let r=yield B0(t.localStore,e);t.currentUser=e,function(s,o){s.ka.forEach(a=>{a.forEach(c=>{c.reject(new M(P.CANCELLED,o))})}),s.ka.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),yield jn(t,r.hs)}})}function aM(n,e){let t=V(n),r=t.Na.get(e);if(r&&r.va)return ee().add(r.key);{let i=ee(),s=t.Ma.get(e);if(!s)return i;for(let o of s){let a=t.Fa.get(o);i=i.unionWith(a.view.Va)}return i}}function uM(n,e){return y(this,null,function*(){let t=V(n),r=yield Al(t.localStore,e.query,!0),i=e.view.ba(r);return t.isPrimaryClient&&hm(t,e.targetId,i.wa),i})}function cM(n,e){return y(this,null,function*(){let t=V(n);return q0(t.localStore,e).then(r=>jn(t,r))})}function lM(n,e,t,r){return y(this,null,function*(){let i=V(n),s=yield function(a,c){let l=V(a),d=V(l.mutationQueue);return l.persistence.runTransaction("Lookup mutation documents","readonly",p=>d.Mn(p,c).next(m=>m?l.localDocuments.getDocuments(p,m):C.resolve(null)))}(i.localStore,e);s!==null?(t==="pending"?yield Bs(i.remoteStore):t==="acknowledged"||t==="rejected"?(ey(i,e,r||null),Zm(i,e),function(a,c){V(V(a).mutationQueue).On(c)}(i.localStore,e)):z(),yield jn(i,s)):O("SyncEngine","Cannot apply mutation batch with id: "+e)})}function hM(n,e){return y(this,null,function*(){let t=V(n);if(Yl(t),ny(t),e===!0&&t.Qa!==!0){let r=t.sharedClientState.getAllActiveQueryTargets(),i=yield CT(t,r.toArray());t.Qa=!0,yield tm(t.remoteStore,!0);for(let s of i)Ql(t.remoteStore,s)}else if(e===!1&&t.Qa!==!1){let r=[],i=Promise.resolve();t.Ma.forEach((s,o)=>{t.sharedClientState.isLocalQueryTarget(o)?r.push(o):i=i.then(()=>(Os(t,o),Ps(t.localStore,o,!0))),Ns(t.remoteStore,o)}),yield i,yield CT(t,r),function(o){let a=V(o);a.Na.forEach((c,l)=>{Ns(a.remoteStore,l)}),a.La.pr(),a.Na=new Map,a.Oa=new Te(B.comparator)}(t),t.Qa=!1,yield tm(t.remoteStore,!1)}})}function CT(n,e,t){return y(this,null,function*(){let r=V(n),i=[],s=[];for(let o of e){let a,c=r.Ma.get(o);if(c&&c.length!==0){a=yield Cs(r.localStore,pt(c[0]));for(let l of c){let d=r.Fa.get(l),p=yield uM(r,d);p.snapshot&&s.push(p.snapshot)}}else{let l=yield z0(r.localStore,o);a=yield Cs(r.localStore,l),yield Xm(r,nA(l),o,!1,a.resumeToken)}i.push(a)}return r.Ca.d_(s),i})}function nA(n){return n0(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function dM(n){return function(t){return V(V(t).persistence).Qi()}(V(n).localStore)}function fM(n,e,t,r){return y(this,null,function*(){let i=V(n);if(i.Qa)return void O("SyncEngine","Ignoring unexpected query state notification.");let s=i.Ma.get(e);if(s&&s.length>0)switch(t){case"current":case"not-current":{let o=yield q0(i.localStore,i0(s[0])),a=Na.createSynthesizedRemoteEventForCurrentChange(e,t==="current",Fe.EMPTY_BYTE_STRING);yield jn(i,o,a);break}case"rejected":yield Ps(i.localStore,e,!0),Os(i,e,r);break;default:z()}})}function pM(n,e,t){return y(this,null,function*(){let r=Yl(n);if(r.Qa){for(let i of e){if(r.Ma.has(i)&&r.sharedClientState.isActiveQueryTarget(i)){O("SyncEngine","Adding an already active target "+i);continue}let s=yield z0(r.localStore,i),o=yield Cs(r.localStore,s);yield Xm(r,nA(s),o.targetId,!1,o.resumeToken),Ql(r.remoteStore,o)}for(let i of t)r.Ma.has(i)&&(yield Ps(r.localStore,i,!1).then(()=>{Ns(r.remoteStore,i),Os(r,i)}).catch(kr))}})}function Yl(n){let e=V(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=eA.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=aM.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=tM.bind(null,e),e.Ca.d_=K1.bind(null,e.eventManager),e.Ca.$a=Q1.bind(null,e.eventManager),e}function ny(n){let e=V(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=nM.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=rM.bind(null,e),e}function gM(n,e,t){let r=V(n);(function(s,o,a){return y(this,null,function*(){try{let c=yield o.getMetadata();if(yield function(w,D){let k=V(w),S=Me(D.createTime);return k.persistence.runTransaction("hasNewerBundle","readonly",x=>k.Gr.getBundleMetadata(x,D.id)).then(x=>!!x&&x.createTime.compareTo(S)>=0)}(s.localStore,c))return yield o.close(),a._completeWith(function(w){return{taskState:"Success",documentsLoaded:w.totalDocuments,bytesLoaded:w.totalBytes,totalDocuments:w.totalDocuments,totalBytes:w.totalBytes}}(c)),Promise.resolve(new Set);a._updateProgress(X0(c));let l=new am(c,s.localStore,o.serializer),d=yield o.Ua();for(;d;){let m=yield l.la(d);m&&a._updateProgress(m),d=yield o.Ua()}let p=yield l.complete();return yield jn(s,p.Ia,void 0),yield function(w,D){let k=V(w);return k.persistence.runTransaction("Save bundle","readwrite",S=>k.Gr.saveBundleMetadata(S,D))}(s.localStore,c),a._completeWith(p.progress),Promise.resolve(p.Pa)}catch(c){return un("SyncEngine",`Loading bundle failed with ${c}`),a._failWith(c),Promise.resolve(new Set)}})})(r,e,t).then(i=>{r.sharedClientState.notifyBundleLoaded(i)})}var Ba=class{constructor(){this.synchronizeTabs=!1}initialize(e){return y(this,null,function*(){this.serializer=Ya(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),yield this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)})}createGarbageCollectionScheduler(e,t){return null}createIndexBackfillerScheduler(e,t){return null}createLocalStore(e){return U0(this.persistence,new Tl,e.initialUser,this.serializer)}createPersistence(e){return new El(Il.Zr,this.serializer)}createSharedClientState(e){return new Sl}terminate(){return y(this,null,function*(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),yield this.persistence.shutdown()})}};var Ll=class n extends Ba{constructor(e,t,r){super(),this.Wa=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.synchronizeTabs=!1}initialize(e){return y(this,null,function*(){yield Ht(n.prototype,this,"initialize").call(this,e),yield this.Wa.initialize(this,e),yield ny(this.Wa.syncEngine),yield Bs(this.Wa.remoteStore),yield this.persistence.yi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))})}createLocalStore(e){return U0(this.persistence,new Tl,e.initialUser,this.serializer)}createGarbageCollectionScheduler(e,t){let r=this.persistence.referenceDelegate.garbageCollector;return new Sg(r,e.asyncQueue,t)}createIndexBackfillerScheduler(e,t){let r=new qp(t,this.persistence);return new zp(e.asyncQueue,r)}createPersistence(e){let t=Gm(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?xt.withCacheSize(this.cacheSizeBytes):xt.DEFAULT;return new jg(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,W0(),Qc(),this.serializer,this.sharedClientState,!!this.forceOwnership)}createSharedClientState(e){return new Sl}},dm=class n extends Ll{constructor(e,t){super(e,t,!1),this.Wa=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}initialize(e){return y(this,null,function*(){yield Ht(n.prototype,this,"initialize").call(this,e);let t=this.Wa.syncEngine;this.sharedClientState instanceof Ea&&(this.sharedClientState.syncEngine={no:lM.bind(null,t),ro:fM.bind(null,t),io:pM.bind(null,t),Qi:dM.bind(null,t),eo:cM.bind(null,t)},yield this.sharedClientState.start()),yield this.persistence.yi(r=>y(this,null,function*(){yield hM(this.Wa.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())}))})}createSharedClientState(e){let t=W0();if(!Ea.D(t))throw new M(P.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");let r=Gm(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new Ea(t,e.asyncQueue,r,e.clientId,e.initialUser)}},$a=class{initialize(e,t){return y(this,null,function*(){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>RT(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=oM.bind(null,this.syncEngine),yield tm(this.remoteStore,this.syncEngine.isPrimaryClient))})}createEventManager(e){return function(){return new im}()}createDatastore(e){let t=Ya(e.databaseInfo.databaseId),r=function(s){return new Qg(s)}(e.databaseInfo);return function(s,o,a,c){return new Xg(s,o,a,c)}(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return function(r,i,s,o,a){return new em(r,i,s,o,a)}(this.localStore,this.datastore,e.asyncQueue,t=>RT(this.syncEngine,t,0),function(){return Rl.D()?new Rl:new Hg}())}createSyncEngine(e,t){return function(i,s,o,a,c,l,d){let p=new lm(i,s,o,a,c,l);return d&&(p.Qa=!0),p}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}terminate(){return y(this,null,function*(){var e,t;yield function(i){return y(this,null,function*(){let s=V(i);O("RemoteStore","RemoteStore shutting down."),s.L_.add(5),yield Us(s),s.k_.shutdown(),s.q_.set("Unknown")})}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(t=this.eventManager)===null||t===void 0||t.terminate()})}};function PT(n,e=10240){let t=0;return{read(){return y(this,null,function*(){if(t<n.byteLength){let i={value:n.slice(t,t+e),done:!1};return t+=e,i}return{done:!0}})},cancel(){return y(this,null,function*(){})},releaseLock(){},closed:Promise.resolve()}}var Ms=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Ga(this.observer.next,e)}error(e){this.observer.error?this.Ga(this.observer.error,e):ke("Uncaught Error in snapshot listener:",e.toString())}za(){this.muted=!0}Ga(e,t){this.muted||setTimeout(()=>{this.muted||e(t)},0)}};var fm=class{constructor(e,t){this.ja=e,this.serializer=t,this.metadata=new Ge,this.buffer=new Uint8Array,this.Ha=function(){return new TextDecoder("utf-8")}(),this.Ja().then(r=>{r&&r.ua()?this.metadata.resolve(r.aa.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(r?.aa)}`))},r=>this.metadata.reject(r))}close(){return this.ja.cancel()}getMetadata(){return y(this,null,function*(){return this.metadata.promise})}Ua(){return y(this,null,function*(){return yield this.getMetadata(),this.Ja()})}Ja(){return y(this,null,function*(){let e=yield this.Ya();if(e===null)return null;let t=this.Ha.decode(e),r=Number(t);isNaN(r)&&this.Za(`length string (${t}) is not valid number`);let i=yield this.Xa(r);return new om(JSON.parse(i),e.length+r)})}eu(){return this.buffer.findIndex(e=>e===123)}Ya(){return y(this,null,function*(){for(;this.eu()<0&&!(yield this.tu()););if(this.buffer.length===0)return null;let e=this.eu();e<0&&this.Za("Reached the end of bundle when a length string is expected.");let t=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),t})}Xa(e){return y(this,null,function*(){for(;this.buffer.length<e;)(yield this.tu())&&this.Za("Reached the end of bundle when more is expected.");let t=this.Ha.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),t})}Za(e){throw this.ja.cancel(),new Error(`Invalid bundle format: ${e}`)}tu(){return y(this,null,function*(){let e=yield this.ja.read();if(!e.done){let t=new Uint8Array(this.buffer.length+e.value.length);t.set(this.buffer),t.set(e.value,this.buffer.length),this.buffer=t}return e.done})}};var pm=class{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}lookup(e){return y(this,null,function*(){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new M(P.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;let t=yield function(i,s){return y(this,null,function*(){let o=V(i),a={documents:s.map(p=>Oa(o.serializer,p))},c=yield o.Lo("BatchGetDocuments",o.serializer.databaseId,ae.emptyPath(),a,s.length),l=new Map;c.forEach(p=>{let m=w1(o.serializer,p);l.set(m.key.toString(),m)});let d=[];return s.forEach(p=>{let m=l.get(p.toString());G(!!m),d.push(m)}),d})}(this.datastore,e);return t.forEach(r=>this.recordVersion(r)),t})}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastTransactionError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new Sr(e,this.precondition(e))),this.writtenDocs.add(e.toString())}commit(){return y(this,null,function*(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;let e=this.readVersions;this.mutations.forEach(t=>{e.delete(t.key.toString())}),e.forEach((t,r)=>{let i=B.fromPath(r);this.mutations.push(new Ra(i,this.precondition(i)))}),yield function(r,i){return y(this,null,function*(){let s=V(r),o={writes:i.map(a=>Ma(s.serializer,a))};yield s.Mo("Commit",s.serializer.databaseId,ae.emptyPath(),o)})}(this.datastore,this.mutations),this.committed=!0})}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw z();t=H.min()}let r=this.readVersions.get(e.key.toString());if(r){if(!t.isEqual(r))throw new M(P.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){let t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(H.min())?Re.exists(!1):Re.updateTime(t):Re.none()}preconditionForUpdate(e){let t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(H.min()))throw new M(P.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Re.updateTime(t)}return Re.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}};var gm=class{constructor(e,t,r,i,s){this.asyncQueue=e,this.datastore=t,this.options=r,this.updateFunction=i,this.deferred=s,this.nu=r.maxAttempts,this.t_=new Va(this.asyncQueue,"transaction_retry")}ru(){this.nu-=1,this.iu()}iu(){this.t_.Go(()=>y(this,null,function*(){let e=new pm(this.datastore),t=this.su(e);t&&t.then(r=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(r)}).catch(i=>{this.ou(i)}))}).catch(r=>{this.ou(r)})}))}su(e){try{let t=this.updateFunction(e);return!Wa(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}ou(e){this.nu>0&&this._u(e)?(this.nu-=1,this.asyncQueue.enqueueAndForget(()=>(this.iu(),Promise.resolve()))):this.deferred.reject(e)}_u(e){if(e.name==="FirebaseError"){let t=e.code;return t==="aborted"||t==="failed-precondition"||t==="already-exists"||!y0(t)}return!1}};var mm=class{constructor(e,t,r,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=qe.UNAUTHENTICATED,this.clientId=Xc.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,s=>y(this,null,function*(){O("FirestoreClient","Received user=",s.uid),yield this.authCredentialListener(s),this.user=s})),this.appCheckCredentials.start(r,s=>(O("FirestoreClient","Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new M(P.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();let e=new Ge;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(()=>y(this,null,function*(){try{this._onlineComponents&&(yield this._onlineComponents.terminate()),this._offlineComponents&&(yield this._offlineComponents.terminate()),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){let r=js(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}};function Yc(n,e){return y(this,null,function*(){n.asyncQueue.verifyOperationInProgress(),O("FirestoreClient","Initializing OfflineComponentProvider");let t=n.configuration;yield e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(i=>y(this,null,function*(){r.isEqual(i)||(yield B0(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e})}function ym(n,e){return y(this,null,function*(){n.asyncQueue.verifyOperationInProgress();let t=yield ry(n);O("FirestoreClient","Initializing OnlineComponentProvider"),yield e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>bT(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,i)=>bT(e.remoteStore,i)),n._onlineComponents=e})}function rA(n){return n.name==="FirebaseError"?n.code===P.FAILED_PRECONDITION||n.code===P.UNIMPLEMENTED:!(typeof DOMException<"u"&&n instanceof DOMException)||n.code===22||n.code===20||n.code===11}function ry(n){return y(this,null,function*(){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){O("FirestoreClient","Using user provided OfflineComponentProvider");try{yield Yc(n,n._uninitializedComponentsProvider._offline)}catch(e){let t=e;if(!rA(t))throw t;un("Error using user provided cache. Falling back to memory cache: "+t),yield Yc(n,new Ba)}}else O("FirestoreClient","Using default OfflineComponentProvider"),yield Yc(n,new Ba);return n._offlineComponents})}function Jl(n){return y(this,null,function*(){return n._onlineComponents||(n._uninitializedComponentsProvider?(O("FirestoreClient","Using user provided OnlineComponentProvider"),yield ym(n,n._uninitializedComponentsProvider._online)):(O("FirestoreClient","Using default OnlineComponentProvider"),yield ym(n,new $a))),n._onlineComponents})}function iA(n){return ry(n).then(e=>e.persistence)}function iy(n){return ry(n).then(e=>e.localStore)}function sA(n){return Jl(n).then(e=>e.remoteStore)}function sy(n){return Jl(n).then(e=>e.syncEngine)}function mM(n){return Jl(n).then(e=>e.datastore)}function xs(n){return y(this,null,function*(){let e=yield Jl(n),t=e.eventManager;return t.onListen=Y1.bind(null,e.syncEngine),t.onUnlisten=X1.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=J1.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=Z1.bind(null,e.syncEngine),t})}function yM(n){return n.asyncQueue.enqueue(()=>y(this,null,function*(){let e=yield iA(n),t=yield sA(n);return e.setNetworkEnabled(!0),function(i){let s=V(i);return s.L_.delete(0),Ja(s)}(t)}))}function _M(n){return n.asyncQueue.enqueue(()=>y(this,null,function*(){let e=yield iA(n),t=yield sA(n);return e.setNetworkEnabled(!1),function(i){return y(this,null,function*(){let s=V(i);s.L_.add(0),yield Us(s),s.q_.set("Offline")})}(t)}))}function vM(n,e){let t=new Ge;return n.asyncQueue.enqueueAndForget(()=>y(this,null,function*(){return function(i,s,o){return y(this,null,function*(){try{let a=yield function(l,d){let p=V(l);return p.persistence.runTransaction("read document","readonly",m=>p.localDocuments.getDocument(m,d))}(i,s);a.isFoundDocument()?o.resolve(a):a.isNoDocument()?o.resolve(null):o.reject(new M(P.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(a){let c=js(a,`Failed to get document '${s} from cache`);o.reject(c)}})}(yield iy(n),e,t)})),t.promise}function oA(n,e,t={}){let r=new Ge;return n.asyncQueue.enqueueAndForget(()=>y(this,null,function*(){return function(s,o,a,c,l){let d=new Ms({next:m=>{o.enqueueAndForget(()=>Ym(s,p));let w=m.docs.has(a);!w&&m.fromCache?l.reject(new M(P.UNAVAILABLE,"Failed to get document because the client is offline.")):w&&m.fromCache&&c&&c.source==="server"?l.reject(new M(P.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):l.resolve(m)},error:m=>l.reject(m)}),p=new Ua(Vs(a.path),d,{includeMetadataChanges:!0,_a:!0});return Qm(s,p)}(yield xs(n),n.asyncQueue,e,t,r)})),r.promise}function wM(n,e){let t=new Ge;return n.asyncQueue.enqueueAndForget(()=>y(this,null,function*(){return function(i,s,o){return y(this,null,function*(){try{let a=yield Al(i,s,!0),c=new Fl(s,a.Ts),l=c.ma(a.documents),d=c.applyChanges(l,!1);o.resolve(d.snapshot)}catch(a){let c=js(a,`Failed to execute query '${s} against cache`);o.reject(c)}})}(yield iy(n),e,t)})),t.promise}function aA(n,e,t={}){let r=new Ge;return n.asyncQueue.enqueueAndForget(()=>y(this,null,function*(){return function(s,o,a,c,l){let d=new Ms({next:m=>{o.enqueueAndForget(()=>Ym(s,p)),m.fromCache&&c.source==="server"?l.reject(new M(P.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):l.resolve(m)},error:m=>l.reject(m)}),p=new Ua(a,d,{includeMetadataChanges:!0,_a:!0});return Qm(s,p)}(yield xs(n),n.asyncQueue,e,t,r)})),r.promise}function EM(n,e){let t=new Ms(e);return n.asyncQueue.enqueueAndForget(()=>y(this,null,function*(){return function(i,s){V(i).Y_.add(s),s.next()}(yield xs(n),t)})),()=>{t.za(),n.asyncQueue.enqueueAndForget(()=>y(this,null,function*(){return function(i,s){V(i).Y_.delete(s)}(yield xs(n),t)}))}}function IM(n,e,t,r){let i=function(o,a){let c;return c=typeof o=="string"?v0().encode(o):o,function(d,p){return new fm(d,p)}(function(d,p){if(d instanceof Uint8Array)return PT(d,p);if(d instanceof ArrayBuffer)return PT(new Uint8Array(d),p);if(d instanceof ReadableStream)return d.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(c),a)}(t,Ya(e));n.asyncQueue.enqueueAndForget(()=>y(this,null,function*(){gM(yield sy(n),i,r)}))}function TM(n,e){return n.asyncQueue.enqueue(()=>y(this,null,function*(){return function(r,i){let s=V(r);return s.persistence.runTransaction("Get named query","readonly",o=>s.Gr.getNamedQuery(o,i))}(yield iy(n),e)}))}function uA(n){let e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}var NT=new Map;function oy(n,e,t){if(!t)throw new M(P.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function AM(n,e,t,r){if(e===!0&&r===!0)throw new M(P.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function kT(n){if(!B.isDocumentKey(n))throw new M(P.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function OT(n){if(B.isDocumentKey(n))throw new M(P.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function Xl(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{let e=function(r){return r.constructor?r.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":z()}function ce(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new M(P.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let t=Xl(n);throw new M(P.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function cA(n,e){if(e<=0)throw new M(P.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}var Vl=class{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new M(P.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(t=e.ssl)===null||t===void 0||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new M(P.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}AM("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=uA((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new M(P.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new M(P.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new M(P.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},gi=class{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Vl({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new M(P.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(e){if(this._settingsFrozen)throw new M(P.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Vl(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new Op;switch(r.type){case"firstParty":return new Lp(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new M(P.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){let r=NT.get(t);r&&(O("ComponentProvider","Removing Datastore"),NT.delete(t),r.terminate())}(this),Promise.resolve()}};function lA(n,e,t,r={}){var i;let s=(n=ce(n,gi))._getSettings(),o=`${e}:${t}`;if(s.host!=="firestore.googleapis.com"&&s.host!==o&&un("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),r.mockUserToken){let a,c;if(typeof r.mockUserToken=="string")a=r.mockUserToken,c=qe.MOCK_USER;else{a=dc(r.mockUserToken,(i=n._app)===null||i===void 0?void 0:i.options.projectId);let l=r.mockUserToken.sub||r.mockUserToken.user_id;if(!l)throw new M(P.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new qe(l)}n._authCredentials=new Mp(new Jc(a,c))}}var Ze=class n{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new n(this.firestore,e,this._query)}},xe=class n{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new an(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new n(this.firestore,e,this._key)}},an=class n extends Ze{constructor(e,t,r){super(e,t,Vs(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new xe(this.firestore,null,new B(e))}withConverter(e){return new n(this.firestore,e,this._path)}};function hA(n,e,...t){if(n=ie(n),oy("collection","path",e),n instanceof gi){let r=ae.fromString(e,...t);return OT(r),new an(n,null,r)}{if(!(n instanceof xe||n instanceof an))throw new M(P.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(ae.fromString(e,...t));return OT(r),new an(n.firestore,null,r)}}function bM(n,e){if(n=ce(n,gi),oy("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new M(P.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new Ze(n,null,function(r){return new qt(ae.emptyPath(),r)}(e))}function ay(n,e,...t){if(n=ie(n),arguments.length===1&&(e=Xc.newId()),oy("doc","path",e),n instanceof gi){let r=ae.fromString(e,...t);return kT(r),new xe(n,null,new B(r))}{if(!(n instanceof xe||n instanceof an))throw new M(P.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(ae.fromString(e,...t));return kT(r),new xe(n.firestore,n instanceof an?n.converter:null,new B(r))}}function DM(n,e){return n=ie(n),e=ie(e),(n instanceof xe||n instanceof an)&&(e instanceof xe||e instanceof an)&&n.firestore===e.firestore&&n.path===e.path&&n.converter===e.converter}function dA(n,e){return n=ie(n),e=ie(e),n instanceof Ze&&e instanceof Ze&&n.firestore===e.firestore&&Ka(n._query,e._query)&&n.converter===e.converter}var _m=class{constructor(){this.au=Promise.resolve(),this.uu=[],this.cu=!1,this.lu=[],this.hu=null,this.Pu=!1,this.Iu=!1,this.Tu=[],this.t_=new Va(this,"async_queue_retry"),this.Eu=()=>{let t=Qc();t&&O("AsyncQueue","Visibility state changed to "+t.visibilityState),this.t_.jo()};let e=Qc();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this.Eu)}get isShuttingDown(){return this.cu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.du(),this.Au(e)}enterRestrictedMode(e){if(!this.cu){this.cu=!0,this.Iu=e||!1;let t=Qc();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.Eu)}}enqueue(e){if(this.du(),this.cu)return new Promise(()=>{});let t=new Ge;return this.Au(()=>this.cu&&this.Iu?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.uu.push(e),this.Ru()))}Ru(){return y(this,null,function*(){if(this.uu.length!==0){try{yield this.uu[0](),this.uu.shift(),this.t_.reset()}catch(e){if(!Or(e))throw e;O("AsyncQueue","Operation failed with retryable error: "+e)}this.uu.length>0&&this.t_.Go(()=>this.Ru())}})}Au(e){let t=this.au.then(()=>(this.Pu=!0,e().catch(r=>{this.hu=r,this.Pu=!1;let i=function(o){let a=o.message||"";return o.stack&&(a=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),a}(r);throw ke("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.Pu=!1,r))));return this.au=t,t}enqueueAfterDelay(e,t,r){this.du(),this.Tu.indexOf(e)>-1&&(t=0);let i=nm.createAndSchedule(this,e,t,r,s=>this.Vu(s));return this.lu.push(i),i}du(){this.hu&&z()}verifyOperationInProgress(){}mu(){return y(this,null,function*(){let e;do e=this.au,yield e;while(e!==this.au)})}fu(e){for(let t of this.lu)if(t.timerId===e)return!0;return!1}gu(e){return this.mu().then(()=>{this.lu.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(let t of this.lu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.mu()})}pu(e){this.Tu.push(e)}Vu(e){let t=this.lu.indexOf(e);this.lu.splice(t,1)}};function vm(n){return function(t,r){if(typeof t!="object"||t===null)return!1;let i=t;for(let s of r)if(s in i&&typeof i[s]=="function")return!0;return!1}(n,["next","error","complete"])}var wm=class{constructor(){this._progressObserver={},this._taskCompletionResolver=new Ge,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,r){this._progressObserver={next:e,error:t,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}};var GU=-1,be=class extends gi{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=function(){return new _m}(),this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return this._firestoreClient||pA(this),this._firestoreClient.terminate()}};function fA(n,e){let t=typeof n=="object"?n:Rn(),r=typeof n=="string"?n:e||"(default)",i=Sn(t,"firestore").getImmediate({identifier:r});if(!i._initialized){let s=hc("firestore");s&&lA(i,...s)}return i}function et(n){return n._firestoreClient||pA(n),n._firestoreClient.verifyNotTerminated(),n._firestoreClient}function pA(n){var e,t,r;let i=n._freezeSettings(),s=function(a,c,l,d){return new Gp(a,c,l,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,uA(d.experimentalLongPollingOptions),d.useFetchStreams)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,i);n._firestoreClient=new mm(n._authCredentials,n._appCheckCredentials,n._queue,s),!((t=i.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(n._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.localCache.kind,_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider})}function SM(n,e){mA(n=ce(n,be));let t=et(n);if(t._uninitializedComponentsProvider)throw new M(P.FAILED_PRECONDITION,"SDK cache is already specified.");un("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let r=n._freezeSettings(),i=new $a;return gA(t,i,new Ll(i,r.cacheSizeBytes,e?.forceOwnership))}function RM(n){mA(n=ce(n,be));let e=et(n);if(e._uninitializedComponentsProvider)throw new M(P.FAILED_PRECONDITION,"SDK cache is already specified.");un("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let t=n._freezeSettings(),r=new $a;return gA(e,r,new dm(r,t.cacheSizeBytes))}function gA(n,e,t){let r=new Ge;return n.asyncQueue.enqueue(()=>y(this,null,function*(){try{yield Yc(n,t),yield ym(n,e),r.resolve()}catch(i){let s=i;if(!rA(s))throw s;un("Error enabling indexeddb cache. Falling back to memory cache: "+s),r.reject(s)}})).then(()=>r.promise)}function CM(n){if(n._initialized&&!n._terminated)throw new M(P.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");let e=new Ge;return n._queue.enqueueAndForgetEvenWhileRestricted(()=>y(this,null,function*(){try{yield function(r){return y(this,null,function*(){if(!Er.D())return Promise.resolve();let i=r+"main";yield Er.delete(i)})}(Gm(n._databaseId,n._persistenceKey)),e.resolve()}catch(t){e.reject(t)}})),e.promise}function PM(n){return function(t){let r=new Ge;return t.asyncQueue.enqueueAndForget(()=>y(this,null,function*(){return iM(yield sy(t),r)})),r.promise}(et(n=ce(n,be)))}function NM(n){return yM(et(n=ce(n,be)))}function kM(n){return _M(et(n=ce(n,be)))}function OM(n,e){let t=et(n=ce(n,be)),r=new wm;return IM(t,n._databaseId,e,r),r}function MM(n,e){return TM(et(n=ce(n,be)),e).then(t=>t?new Ze(n,null,t.query):null)}function mA(n){if(n._initialized||n._terminated)throw new M(P.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}var Fs=class n{constructor(e){this._byteString=e}static fromBase64String(e){try{return new n(Fe.fromBase64String(e))}catch(t){throw new M(P.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new n(Fe.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}};var Cr=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new M(P.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new He(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var Bn=class{constructor(e){this._methodName=e}};var ja=class{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new M(P.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new M(P.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Z(this._lat,e._lat)||Z(this._long,e._long)}};var za=class{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0}(this._values,e._values)}};var xM=/^__.*__$/,Em=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new Gt(e,this.data,this.fieldMask,t,this.fieldTransforms):new Dr(e,this.data,t,this.fieldTransforms)}},Ul=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new Gt(e,this.data,this.fieldMask,t,this.fieldTransforms)}};function yA(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw z()}}var Bl=class n{constructor(e,t,r,i,s,o){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.yu(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get wu(){return this.settings.wu}Su(e){return new n(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}bu(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Su({path:r,Du:!1});return i.vu(e),i}Cu(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Su({path:r,Du:!1});return i.yu(),i}Fu(e){return this.Su({path:void 0,Du:!0})}Mu(e){return $l(e,this.settings.methodName,this.settings.xu||!1,this.path,this.settings.Ou)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}yu(){if(this.path)for(let e=0;e<this.path.length;e++)this.vu(this.path.get(e))}vu(e){if(e.length===0)throw this.Mu("Document fields must not be empty");if(yA(this.wu)&&xM.test(e))throw this.Mu('Document fields cannot begin and end with "__"')}},Im=class{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||Ya(e)}Nu(e,t,r,i=!1){return new Bl({wu:e,methodName:t,Ou:r,path:He.emptyPath(),Du:!1,xu:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function vi(n){let e=n._freezeSettings(),t=Ya(n._databaseId);return new Im(n._databaseId,!!e.ignoreUndefinedProperties,t)}function Zl(n,e,t,r,i,s={}){let o=n.Nu(s.merge||s.mergeFields?2:0,e,t,i);ly("Data must be an object, but it was:",o,r);let a=wA(r,o),c,l;if(s.merge)c=new bt(o.fieldMask),l=o.fieldTransforms;else if(s.mergeFields){let d=[];for(let p of s.mergeFields){let m=Sm(e,p,t);if(!o.contains(m))throw new M(P.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);IA(d,m)||d.push(m)}c=new bt(d),l=o.fieldTransforms.filter(p=>c.covers(p.field))}else c=null,l=o.fieldTransforms;return new Em(new ct(a),c,l)}var qa=class n extends Bn{_toFieldTransform(e){if(e.wu!==2)throw e.wu===1?e.Mu(`${this._methodName}() can only appear at the top level of your update data`):e.Mu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof n}};function _A(n,e,t){return new Bl({wu:3,Ou:e.settings.Ou,methodName:n._methodName,Du:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}var Tm=class n extends Bn{_toFieldTransform(e){return new di(e.path,new Ar)}isEqual(e){return e instanceof n}},Am=class n extends Bn{constructor(e,t){super(e),this.Lu=t}_toFieldTransform(e){let t=_A(this,e,!0),r=this.Lu.map(s=>wi(s,t)),i=new Vn(r);return new di(e.path,i)}isEqual(e){return e instanceof n&&bn(this.Lu,e.Lu)}},bm=class n extends Bn{constructor(e,t){super(e),this.Lu=t}_toFieldTransform(e){let t=_A(this,e,!0),r=this.Lu.map(s=>wi(s,t)),i=new Un(r);return new di(e.path,i)}isEqual(e){return e instanceof n&&bn(this.Lu,e.Lu)}},Dm=class n extends Bn{constructor(e,t){super(e),this.Bu=t}_toFieldTransform(e){let t=new br(e.serializer,l0(e.serializer,this.Bu));return new di(e.path,t)}isEqual(e){return e instanceof n&&this.Bu===e.Bu}};function uy(n,e,t,r){let i=n.Nu(1,e,t);ly("Data must be an object, but it was:",i,r);let s=[],o=ct.empty();_i(r,(c,l)=>{let d=hy(e,c,t);l=ie(l);let p=i.Cu(d);if(l instanceof qa)s.push(d);else{let m=wi(l,p);m!=null&&(s.push(d),o.set(d,m))}});let a=new bt(s);return new Ul(o,a,i.fieldTransforms)}function cy(n,e,t,r,i,s){let o=n.Nu(1,e,t),a=[Sm(e,r,t)],c=[i];if(s.length%2!=0)throw new M(P.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let m=0;m<s.length;m+=2)a.push(Sm(e,s[m])),c.push(s[m+1]);let l=[],d=ct.empty();for(let m=a.length-1;m>=0;--m)if(!IA(l,a[m])){let w=a[m],D=c[m];D=ie(D);let k=o.Cu(w);if(D instanceof qa)l.push(w);else{let S=wi(D,k);S!=null&&(l.push(w),d.set(w,S))}}let p=new bt(l);return new Ul(d,p,o.fieldTransforms)}function vA(n,e,t,r=!1){return wi(t,n.Nu(r?4:3,e))}function wi(n,e){if(EA(n=ie(n)))return ly("Unsupported field value:",e,n),wA(n,e);if(n instanceof Bn)return function(r,i){if(!yA(i.wu))throw i.Mu(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Mu(`${r._methodName}() is not currently supported inside arrays`);let s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.Du&&e.wu!==4)throw e.Mu("Nested arrays are not supported");return function(r,i){let s=[],o=0;for(let a of r){let c=wi(a,i.Fu(o));c==null&&(c={nullValue:"NULL_VALUE"}),s.push(c),o++}return{arrayValue:{values:s}}}(n,e)}return function(r,i){if((r=ie(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return l0(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){let s=Oe.fromDate(r);return{timestampValue:Ds(i.serializer,s)}}if(r instanceof Oe){let s=new Oe(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Ds(i.serializer,s)}}if(r instanceof ja)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Fs)return{bytesValue:w0(i.serializer,r._byteString)};if(r instanceof xe){let s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.Mu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:jm(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof za)return function(o,a){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:o.toArray().map(c=>{if(typeof c!="number")throw a.Mu("VectorValues must only contain numeric values.");return $m(a.serializer,c)})}}}}}}(r,i);throw i.Mu(`Unsupported field value: ${Xl(r)}`)}(n,e)}function wA(n,e){let t={};return HT(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):_i(n,(r,i)=>{let s=wi(i,e.bu(r));s!=null&&(t[r]=s)}),{mapValue:{fields:t}}}function EA(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Oe||n instanceof ja||n instanceof Fs||n instanceof xe||n instanceof Bn||n instanceof za)}function ly(n,e,t){if(!EA(t)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(t)){let r=Xl(t);throw r==="an object"?e.Mu(n+" a custom object"):e.Mu(n+" "+r)}}function Sm(n,e,t){if((e=ie(e))instanceof Cr)return e._internalPath;if(typeof e=="string")return hy(n,e);throw $l("Field path arguments must be of type string or ",n,!1,void 0,t)}var FM=new RegExp("[~\\*/\\[\\]]");function hy(n,e,t){if(e.search(FM)>=0)throw $l(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Cr(...e.split("."))._internalPath}catch{throw $l(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function $l(n,e,t,r,i){let s=r&&!r.isEmpty(),o=i!==void 0,a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(s||o)&&(c+=" (found",s&&(c+=` in field ${r}`),o&&(c+=` in document ${i}`),c+=")"),new M(P.INVALID_ARGUMENT,a+n+c)}function IA(n,e){return n.some(t=>t.isEqual(e))}var mi=class{constructor(e,t,r,i,s){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new xe(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new Rm(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let t=this._document.data.field(eh("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}},Rm=class extends mi{data(){return super.data()}};function eh(n,e){return typeof e=="string"?hy(n,e):e instanceof Cr?e._internalPath:e._delegate._internalPath}function TA(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new M(P.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Ga=class{},yi=class extends Ga{};function AA(n,e,...t){let r=[];e instanceof Ga&&r.push(e),r=r.concat(t),function(s){let o=s.filter(c=>c instanceof Cm).length,a=s.filter(c=>c instanceof jl).length;if(o>1||o>0&&a>0)throw new M(P.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(let i of r)n=i._apply(n);return n}var jl=class n extends yi{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=this._parse(e);return SA(e._query,t),new Ze(e.firestore,e.converter,ig(e._query,t))}_parse(e){let t=vi(e.firestore);return function(s,o,a,c,l,d,p){let m;if(l.isKeyField()){if(d==="array-contains"||d==="array-contains-any")throw new M(P.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on documentId().`);if(d==="in"||d==="not-in"){xT(p,d);let w=[];for(let D of p)w.push(MT(c,s,D));m={arrayValue:{values:w}}}else m=MT(c,s,p)}else d!=="in"&&d!=="not-in"&&d!=="array-contains-any"||xT(p,d),m=vA(a,o,p,d==="in"||d==="not-in");return se.create(l,d,m)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}};function bA(n,e,t){let r=e,i=eh("where",n);return jl._create(i,r,t)}var Cm=class n extends Ga{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new n(e,t)}_parse(e){let t=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return t.length===1?t[0]:ge.create(t,this._getOperator())}_apply(e){let t=this._parse(e);return t.getFilters().length===0?e:(function(i,s){let o=i,a=s.getFlattenedFilters();for(let c of a)SA(o,c),o=ig(o,c)}(e._query,t),new Ze(e.firestore,e.converter,ig(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}};var Pm=class n extends yi{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new n(e,t)}_apply(e){let t=function(i,s,o){if(i.startAt!==null)throw new M(P.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new M(P.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new li(s,o)}(e._query,this._field,this._direction);return new Ze(e.firestore,e.converter,function(i,s){let o=i.explicitOrderBy.concat([s]);return new qt(i.path,i.collectionGroup,o,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,t))}};function LM(n,e="asc"){let t=e,r=eh("orderBy",n);return Pm._create(r,t)}var zl=class n extends yi{constructor(e,t,r){super(),this.type=e,this._limit=t,this._limitType=r}static _create(e,t,r){return new n(e,t,r)}_apply(e){return new Ze(e.firestore,e.converter,ul(e._query,this._limit,this._limitType))}};function VM(n){return cA("limit",n),zl._create("limit",n,"F")}function UM(n){return cA("limitToLast",n),zl._create("limitToLast",n,"L")}var ql=class n extends yi{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=DA(e,this.type,this._docOrFields,this._inclusive);return new Ze(e.firestore,e.converter,function(i,s){return new qt(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,s,i.endAt)}(e._query,t))}};function BM(...n){return ql._create("startAt",n,!0)}function $M(...n){return ql._create("startAfter",n,!1)}var Gl=class n extends yi{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=DA(e,this.type,this._docOrFields,this._inclusive);return new Ze(e.firestore,e.converter,function(i,s){return new qt(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,i.startAt,s)}(e._query,t))}};function jM(...n){return Gl._create("endBefore",n,!1)}function zM(...n){return Gl._create("endAt",n,!0)}function DA(n,e,t,r){if(t[0]=ie(t[0]),t[0]instanceof mi)return function(s,o,a,c,l){if(!c)throw new M(P.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${a}().`);let d=[];for(let p of ms(s))if(p.field.isKeyField())d.push(ci(o,c.key));else{let m=c.data.field(p.field);if(Hl(m))throw new M(P.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+p.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(m===null){let w=p.field.canonicalString();throw new M(P.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${w}' (used as the orderBy) does not exist.`)}d.push(m)}return new ln(d,l)}(n._query,n.firestore._databaseId,e,t[0]._document,r);{let i=vi(n.firestore);return function(o,a,c,l,d,p){let m=o.explicitOrderBy;if(d.length>m.length)throw new M(P.INVALID_ARGUMENT,`Too many arguments provided to ${l}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);let w=[];for(let D=0;D<d.length;D++){let k=d[D];if(m[D].field.isKeyField()){if(typeof k!="string")throw new M(P.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${l}(), but got a ${typeof k}`);if(!Um(o)&&k.indexOf("/")!==-1)throw new M(P.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${l}() must be a plain document ID, but '${k}' contains a slash.`);let S=o.path.child(ae.fromString(k));if(!B.isDocumentKey(S))throw new M(P.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${l}() must result in a valid document path, but '${S}' is not because it contains an odd number of segments.`);let x=new B(S);w.push(ci(a,x))}else{let S=vA(c,l,k);w.push(S)}}return new ln(w,p)}(n._query,n.firestore._databaseId,i,e,t,r)}}function MT(n,e,t){if(typeof(t=ie(t))=="string"){if(t==="")throw new M(P.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Um(e)&&t.indexOf("/")!==-1)throw new M(P.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);let r=e.path.child(ae.fromString(t));if(!B.isDocumentKey(r))throw new M(P.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return ci(n,new B(r))}if(t instanceof xe)return ci(n,t._key);throw new M(P.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Xl(t)}.`)}function xT(n,e){if(!Array.isArray(n)||n.length===0)throw new M(P.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function SA(n,e){let t=function(i,s){for(let o of i)for(let a of o.getFlattenedFilters())if(s.indexOf(a.op)>=0)return a.op;return null}(n.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new M(P.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new M(P.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}var Wl=class{convertValue(e,t="none"){switch(ui(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Ae(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Ir(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw z()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){let r={};return _i(e,(i,s)=>{r[i]=this.convertValue(s,t)}),r}convertVectorValue(e){var t,r,i;let s=(i=(r=(t=e.fields)===null||t===void 0?void 0:t.value.arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.map(o=>Ae(o.doubleValue));return new za(s)}convertGeoPoint(e){return new ja(Ae(e.latitude),Ae(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":let r=Lm(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(ba(e));default:return null}}convertTimestamp(e){let t=Ln(e);return new Oe(t.seconds,t.nanos)}convertDocumentKey(e,t){let r=ae.fromString(e);G(N0(r));let i=new Es(r.get(1),r.get(3)),s=new B(r.popFirst(5));return i.isEqual(t)||ke(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}};function th(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}var Nm=class extends Wl{constructor(e){super(),this.firestore=e}convertBytes(e){return new Fs(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new xe(this.firestore,null,t)}};var Fn=class{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},Pr=class extends mi{constructor(e,t,r,i,s,o){super(e,t,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let t=new _s(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){let r=this._document.data.field(eh("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}},_s=class extends Pr{data(e={}){return super.data(e)}},Nr=class{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new Fn(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){let e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new _s(this._firestore,this._userDataWriter,r.key,r,new Fn(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new M(P.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(a=>{let c=new _s(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Fn(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);return a.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>s||a.type!==3).map(a=>{let c=new _s(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Fn(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter),l=-1,d=-1;return a.type!==0&&(l=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),d=o.indexOf(a.doc.key)),{type:qM(a.type),doc:c,oldIndex:l,newIndex:d}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}};function qM(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return z()}}function GM(n,e){return n instanceof Pr&&e instanceof Pr?n._firestore===e._firestore&&n._key.isEqual(e._key)&&(n._document===null?e._document===null:n._document.isEqual(e._document))&&n._converter===e._converter:n instanceof Nr&&e instanceof Nr&&n._firestore===e._firestore&&dA(n.query,e.query)&&n.metadata.isEqual(e.metadata)&&n._snapshot.isEqual(e._snapshot)}function RA(n){n=ce(n,xe);let e=ce(n.firestore,be);return oA(et(e),n._key).then(t=>dy(e,n,t))}var $n=class extends Wl{constructor(e){super(),this.firestore=e}convertBytes(e){return new Fs(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new xe(this.firestore,null,t)}};function WM(n){n=ce(n,xe);let e=ce(n.firestore,be),t=et(e),r=new $n(e);return vM(t,n._key).then(i=>new Pr(e,r,n._key,i,new Fn(i!==null&&i.hasLocalMutations,!0),n.converter))}function HM(n){n=ce(n,xe);let e=ce(n.firestore,be);return oA(et(e),n._key,{source:"server"}).then(t=>dy(e,n,t))}function CA(n){n=ce(n,Ze);let e=ce(n.firestore,be),t=et(e),r=new $n(e);return TA(n._query),aA(t,n._query).then(i=>new Nr(e,r,n,i))}function KM(n){n=ce(n,Ze);let e=ce(n.firestore,be),t=et(e),r=new $n(e);return wM(t,n._query).then(i=>new Nr(e,r,n,i))}function QM(n){n=ce(n,Ze);let e=ce(n.firestore,be),t=et(e),r=new $n(e);return aA(t,n._query,{source:"server"}).then(i=>new Nr(e,r,n,i))}function PA(n,e,t){n=ce(n,xe);let r=ce(n.firestore,be),i=th(n.converter,e,t);return nh(r,[Zl(vi(r),"setDoc",n._key,i,n.converter!==null,t).toMutation(n._key,Re.none())])}function NA(n,e,t,...r){n=ce(n,xe);let i=ce(n.firestore,be),s=vi(i),o;return o=typeof(e=ie(e))=="string"||e instanceof Cr?cy(s,"updateDoc",n._key,e,t,r):uy(s,"updateDoc",n._key,e),nh(i,[o.toMutation(n._key,Re.exists(!0))])}function kA(n){return nh(ce(n.firestore,be),[new Sr(n._key,Re.none())])}function OA(n,e){let t=ce(n.firestore,be),r=ay(n),i=th(n.converter,e);return nh(t,[Zl(vi(n.firestore),"addDoc",r._key,i,n.converter!==null,{}).toMutation(r._key,Re.exists(!1))]).then(()=>r)}function YM(n,...e){var t,r,i;n=ie(n);let s={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||vm(e[o])||(s=e[o],o++);let a={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(vm(e[o])){let p=e[o];e[o]=(t=p.next)===null||t===void 0?void 0:t.bind(p),e[o+1]=(r=p.error)===null||r===void 0?void 0:r.bind(p),e[o+2]=(i=p.complete)===null||i===void 0?void 0:i.bind(p)}let c,l,d;if(n instanceof xe)l=ce(n.firestore,be),d=Vs(n._key.path),c={next:p=>{e[o]&&e[o](dy(l,n,p))},error:e[o+1],complete:e[o+2]};else{let p=ce(n,Ze);l=ce(p.firestore,be),d=p._query;let m=new $n(l);c={next:w=>{e[o]&&e[o](new Nr(l,m,p,w))},error:e[o+1],complete:e[o+2]},TA(n._query)}return function(m,w,D,k){let S=new Ms(k),x=new Ua(w,S,D);return m.asyncQueue.enqueueAndForget(()=>y(this,null,function*(){return Qm(yield xs(m),x)})),()=>{S.za(),m.asyncQueue.enqueueAndForget(()=>y(this,null,function*(){return Ym(yield xs(m),x)}))}}(et(l),d,a,c)}function JM(n,e){return EM(et(n=ce(n,be)),vm(e)?e:{next:e})}function nh(n,e){return function(r,i){let s=new Ge;return r.asyncQueue.enqueueAndForget(()=>y(this,null,function*(){return eM(yield sy(r),i,s)})),s.promise}(et(n),e)}function dy(n,e,t){let r=t.docs.get(e._key),i=new $n(n);return new Pr(n,i,e._key,r,new Fn(t.hasPendingWrites,t.fromCache),e.converter)}var XM={maxAttempts:5};var FT=class{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=vi(e)}set(e,t,r){this._verifyNotCommitted();let i=_r(e,this._firestore),s=th(i.converter,t,r),o=Zl(this._dataReader,"WriteBatch.set",i._key,s,i.converter!==null,r);return this._mutations.push(o.toMutation(i._key,Re.none())),this}update(e,t,r,...i){this._verifyNotCommitted();let s=_r(e,this._firestore),o;return o=typeof(t=ie(t))=="string"||t instanceof Cr?cy(this._dataReader,"WriteBatch.update",s._key,t,r,i):uy(this._dataReader,"WriteBatch.update",s._key,t),this._mutations.push(o.toMutation(s._key,Re.exists(!0))),this}delete(e){this._verifyNotCommitted();let t=_r(e,this._firestore);return this._mutations=this._mutations.concat(new Sr(t._key,Re.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new M(P.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}};function _r(n,e){if((n=ie(n)).firestore!==e)throw new M(P.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}var km=class extends class{constructor(t,r){this._firestore=t,this._transaction=r,this._dataReader=vi(t)}get(t){let r=_r(t,this._firestore),i=new Nm(this._firestore);return this._transaction.lookup([r._key]).then(s=>{if(!s||s.length!==1)return z();let o=s[0];if(o.isFoundDocument())return new mi(this._firestore,i,o.key,o,r.converter);if(o.isNoDocument())return new mi(this._firestore,i,r._key,null,r.converter);throw z()})}set(t,r,i){let s=_r(t,this._firestore),o=th(s.converter,r,i),a=Zl(this._dataReader,"Transaction.set",s._key,o,s.converter!==null,i);return this._transaction.set(s._key,a),this}update(t,r,i,...s){let o=_r(t,this._firestore),a;return a=typeof(r=ie(r))=="string"||r instanceof Cr?cy(this._dataReader,"Transaction.update",o._key,r,i,s):uy(this._dataReader,"Transaction.update",o._key,r),this._transaction.update(o._key,a),this}delete(t){let r=_r(t,this._firestore);return this._transaction.delete(r._key),this}}{constructor(e,t){super(e,t),this._firestore=e}get(e){let t=_r(e,this._firestore),r=new $n(this._firestore);return super.get(e).then(i=>new Pr(this._firestore,r,t._key,i._document,new Fn(!1,!1),t.converter))}};function ZM(n,e,t){n=ce(n,be);let r=Object.assign(Object.assign({},XM),t);return function(s){if(s.maxAttempts<1)throw new M(P.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(s,o,a){let c=new Ge;return s.asyncQueue.enqueueAndForget(()=>y(this,null,function*(){let l=yield mM(s);new gm(s.asyncQueue,l,a,o,c).ru()})),c.promise}(et(n),i=>e(new km(n,i)),r)}function ex(){return new qa("deleteField")}function MA(){return new Tm("serverTimestamp")}function xA(...n){return new Am("arrayUnion",n)}function FA(...n){return new bm("arrayRemove",n)}function tx(n){return new Dm("increment",n)}(function(e,t=!0){(function(i){Ls=i})(jt),$t(new mt("firestore",(r,{instanceIdentifier:i,options:s})=>{let o=r.getProvider("app").getImmediate(),a=new be(new xp(r.getProvider("auth-internal")),new Up(r.getProvider("app-check-internal")),function(l,d){if(!Object.prototype.hasOwnProperty.apply(l.options,["projectId"]))throw new M(P.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Es(l.options.projectId,d)}(o,i),o);return s=Object.assign({useFetchStreams:t},s),a._setSettings(s),a},"PUBLIC").setMultipleInstances(!0)),_e(MI,"4.7.0",e),_e(MI,"4.7.0","esm2017")})();var Xa=class{constructor(e){return e}},LA="firestore",fy=class{constructor(){return Qr(LA)}};var py=new te("angularfire2.firestore-instances");function nx(n,e){let t=es(LA,n,e);return t&&new Xa(t)}function rx(n){return(e,t)=>{let r=e.runOutsideAngular(()=>n(t));return new Xa(r)}}var VA={provide:fy,deps:[[new Ue,py]]},UA={provide:Xa,useFactory:nx,deps:[[new Ue,py],zt]},R2=(()=>{class n{constructor(){_e("angularfire",Xt.full,"fst")}static \u0275fac=function(r){return new(r||n)};static \u0275mod=Xn({type:n});static \u0275inj=Jn({providers:[UA,VA]})}return n})();function C2(n,...e){return _e("angularfire",Xt.full,"fst"),gt([UA,VA,{provide:py,useFactory:rx(n),multi:!0,deps:[Pe,Rt,lr,Cn,[new Ue,Zr],[new Ue,cr],...e]}])}var P2=fe(OA,!0);var N2=fe(FA,!0),k2=fe(xA,!0);var O2=fe(hA,!0);var M2=fe(kA,!0);var x2=fe(ay,!0);var F2=fe(RA,!0);var L2=fe(CA,!0);var V2=fe(fA,!0);var U2=fe(AA,!0);var B2=fe(MA,!0),$2=fe(PA,!0);var j2=fe(NA,!0);var z2=fe(bA,!0);var WA="firebasestorage.googleapis.com",HA="storageBucket",ix=2*60*1e3,sx=10*60*1e3;var Ce=class n extends at{constructor(e,t,r=0){super(gy(e),`Firebase Storage: ${t} (${gy(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,n.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return gy(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}},Le=function(n){return n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment",n}(Le||{});function gy(n){return"storage/"+n}function Ey(){let n="An unknown error occurred, please check the error payload for server response.";return new Ce(Le.UNKNOWN,n)}function ox(n){return new Ce(Le.OBJECT_NOT_FOUND,"Object '"+n+"' does not exist.")}function ax(n){return new Ce(Le.QUOTA_EXCEEDED,"Quota for bucket '"+n+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function ux(){let n="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new Ce(Le.UNAUTHENTICATED,n)}function cx(){return new Ce(Le.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function lx(n){return new Ce(Le.UNAUTHORIZED,"User does not have permission to access '"+n+"'.")}function hx(){return new Ce(Le.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function dx(){return new Ce(Le.CANCELED,"User canceled the upload/download.")}function fx(n){return new Ce(Le.INVALID_URL,"Invalid URL '"+n+"'.")}function px(n){return new Ce(Le.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function gx(){return new Ce(Le.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+HA+"' property when initializing the app?")}function mx(){return new Ce(Le.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function yx(){return new Ce(Le.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function _x(n){return new Ce(Le.UNSUPPORTED_ENVIRONMENT,`${n} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function my(n){return new Ce(Le.INVALID_ARGUMENT,n)}function KA(){return new Ce(Le.APP_DELETED,"The Firebase app was deleted.")}function vx(n){return new Ce(Le.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function eu(n,e){return new Ce(Le.INVALID_FORMAT,"String does not match format '"+n+"': "+e)}function Za(n){throw new Ce(Le.INTERNAL_ERROR,"Internal error: "+n)}var Wt=class n{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){let e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let r;try{r=n.makeFromUrl(e,t)}catch{return new n(e,"")}if(r.path==="")return r;throw px(e)}static makeFromUrl(e,t){let r=null,i="([A-Za-z0-9.\\-_]+)";function s(U){U.path.charAt(U.path.length-1)==="/"&&(U.path_=U.path_.slice(0,-1))}let o="(/(.*))?$",a=new RegExp("^gs://"+i+o,"i"),c={bucket:1,path:3};function l(U){U.path_=decodeURIComponent(U.path)}let d="v[A-Za-z0-9_]+",p=t.replace(/[.]/g,"\\."),m="(/([^?#]*).*)?$",w=new RegExp(`^https?://${p}/${d}/b/${i}/o${m}`,"i"),D={bucket:1,path:3},k=t===WA?"(?:storage.googleapis.com|storage.cloud.google.com)":t,S="([^?#]*)",x=new RegExp(`^https?://${k}/${i}/${S}`,"i"),F=[{regex:a,indices:c,postModify:s},{regex:w,indices:D,postModify:l},{regex:x,indices:{bucket:1,path:2},postModify:l}];for(let U=0;U<F.length;U++){let J=F[U],W=J.regex.exec(e);if(W){let I=W[J.indices.bucket],_=W[J.indices.path];_||(_=""),r=new n(I,_),J.postModify(r);break}}if(r==null)throw fx(e);return r}},yy=class{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}};function wx(n,e,t){let r=1,i=null,s=null,o=!1,a=0;function c(){return a===2}let l=!1;function d(...S){l||(l=!0,e.apply(null,S))}function p(S){i=setTimeout(()=>{i=null,n(w,c())},S)}function m(){s&&clearTimeout(s)}function w(S,...x){if(l){m();return}if(S){m(),d.call(null,S,...x);return}if(c()||o){m(),d.call(null,S,...x);return}r<64&&(r*=2);let F;a===1?(a=2,F=0):F=(r+Math.random())*1e3,p(F)}let D=!1;function k(S){D||(D=!0,m(),!l&&(i!==null?(S||(a=2),clearTimeout(i),p(0)):S||(a=1)))}return p(0),s=setTimeout(()=>{o=!0,k(!0)},t),k}function Ex(n){n(!1)}function Ix(n){return n!==void 0}function Tx(n){return typeof n=="object"&&!Array.isArray(n)}function Iy(n){return typeof n=="string"||n instanceof String}function BA(n){return Ty()&&n instanceof Blob}function Ty(){return typeof Blob<"u"}function $A(n,e,t,r){if(r<e)throw my(`Invalid value for '${n}'. Expected ${e} or greater.`);if(r>t)throw my(`Invalid value for '${n}'. Expected ${t} or less.`)}function oh(n,e,t){let r=e;return t==null&&(r=`https://${e}`),`${t}://${r}/v0${n}`}function QA(n){let e=encodeURIComponent,t="?";for(let r in n)if(n.hasOwnProperty(r)){let i=e(r)+"="+e(n[r]);t=t+i+"&"}return t=t.slice(0,-1),t}var qs=function(n){return n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT",n}(qs||{});function Ax(n,e){let t=n>=500&&n<600,i=[408,429].indexOf(n)!==-1,s=e.indexOf(n)!==-1;return t||i||s}var _y=class{constructor(e,t,r,i,s,o,a,c,l,d,p,m=!0){this.url_=e,this.method_=t,this.headers_=r,this.body_=i,this.successCodes_=s,this.additionalRetryCodes_=o,this.callback_=a,this.errorCallback_=c,this.timeout_=l,this.progressCallback_=d,this.connectionFactory_=p,this.retry=m,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((w,D)=>{this.resolve_=w,this.reject_=D,this.start_()})}start_(){let e=(r,i)=>{if(i){r(!1,new zs(!1,null,!0));return}let s=this.connectionFactory_();this.pendingConnection_=s;let o=a=>{let c=a.loaded,l=a.lengthComputable?a.total:-1;this.progressCallback_!==null&&this.progressCallback_(c,l)};this.progressCallback_!==null&&s.addUploadProgressListener(o),s.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&s.removeUploadProgressListener(o),this.pendingConnection_=null;let a=s.getErrorCode()===qs.NO_ERROR,c=s.getStatus();if(!a||Ax(c,this.additionalRetryCodes_)&&this.retry){let d=s.getErrorCode()===qs.ABORT;r(!1,new zs(!1,null,d));return}let l=this.successCodes_.indexOf(c)!==-1;r(!0,new zs(l,s))})},t=(r,i)=>{let s=this.resolve_,o=this.reject_,a=i.connection;if(i.wasSuccessCode)try{let c=this.callback_(a,a.getResponse());Ix(c)?s(c):s()}catch(c){o(c)}else if(a!==null){let c=Ey();c.serverResponse=a.getErrorText(),this.errorCallback_?o(this.errorCallback_(a,c)):o(c)}else if(i.canceled){let c=this.appDelete_?KA():dx();o(c)}else{let c=hx();o(c)}};this.canceled_?t(!1,new zs(!1,null,!0)):this.backoffId_=wx(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&Ex(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}},zs=class{constructor(e,t,r){this.wasSuccessCode=e,this.connection=t,this.canceled=!!r}};function bx(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function Dx(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function Sx(n,e){e&&(n["X-Firebase-GMPID"]=e)}function Rx(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function Cx(n,e,t,r,i,s,o=!0){let a=QA(n.urlParams),c=n.url+a,l=Object.assign({},n.headers);return Sx(l,e),bx(l,t),Dx(l,s),Rx(l,r),new _y(c,n.method,l,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,i,o)}function Px(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function Nx(...n){let e=Px();if(e!==void 0){let t=new e;for(let r=0;r<n.length;r++)t.append(n[r]);return t.getBlob()}else{if(Ty())return new Blob(n);throw new Ce(Le.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function kx(n,e,t){return n.webkitSlice?n.webkitSlice(e,t):n.mozSlice?n.mozSlice(e,t):n.slice?n.slice(e,t):null}function Ox(n){if(typeof atob>"u")throw _x("base-64");return atob(n)}var dn={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"},tu=class{constructor(e,t){this.data=e,this.contentType=t||null}};function Mx(n,e){switch(n){case dn.RAW:return new tu(YA(e));case dn.BASE64:case dn.BASE64URL:return new tu(JA(n,e));case dn.DATA_URL:return new tu(Fx(e),Lx(e))}throw Ey()}function YA(n){let e=[];for(let t=0;t<n.length;t++){let r=n.charCodeAt(t);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|r&63);else if((r&64512)===55296)if(!(t<n.length-1&&(n.charCodeAt(t+1)&64512)===56320))e.push(239,191,189);else{let s=r,o=n.charCodeAt(++t);r=65536|(s&1023)<<10|o&1023,e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|r&63)}else(r&64512)===56320?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|r&63)}return new Uint8Array(e)}function xx(n){let e;try{e=decodeURIComponent(n)}catch{throw eu(dn.DATA_URL,"Malformed data URL.")}return YA(e)}function JA(n,e){switch(n){case dn.BASE64:{let i=e.indexOf("-")!==-1,s=e.indexOf("_")!==-1;if(i||s)throw eu(n,"Invalid character '"+(i?"-":"_")+"' found: is it base64url encoded?");break}case dn.BASE64URL:{let i=e.indexOf("+")!==-1,s=e.indexOf("/")!==-1;if(i||s)throw eu(n,"Invalid character '"+(i?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let t;try{t=Ox(e)}catch(i){throw i.message.includes("polyfill")?i:eu(n,"Invalid character found")}let r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}var ih=class{constructor(e){this.base64=!1,this.contentType=null;let t=e.match(/^data:([^,]+)?,/);if(t===null)throw eu(dn.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");let r=t[1]||null;r!=null&&(this.base64=Vx(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}};function Fx(n){let e=new ih(n);return e.base64?JA(dn.BASE64,e.rest):xx(e.rest)}function Lx(n){return new ih(n).contentType}function Vx(n,e){return n.length>=e.length?n.substring(n.length-e.length)===e:!1}var sh=class n{constructor(e,t){let r=0,i="";BA(e)?(this.data_=e,r=e.size,i=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=i}size(){return this.size_}type(){return this.type_}slice(e,t){if(BA(this.data_)){let r=this.data_,i=kx(r,e,t);return i===null?null:new n(i)}else{let r=new Uint8Array(this.data_.buffer,e,t-e);return new n(r,!0)}}static getBlob(...e){if(Ty()){let t=e.map(r=>r instanceof n?r.data_:r);return new n(Nx.apply(null,t))}else{let t=e.map(o=>Iy(o)?Mx(dn.RAW,o).data:o.data_),r=0;t.forEach(o=>{r+=o.byteLength});let i=new Uint8Array(r),s=0;return t.forEach(o=>{for(let a=0;a<o.length;a++)i[s++]=o[a]}),new n(i,!0)}}uploadData(){return this.data_}};function XA(n){let e;try{e=JSON.parse(n)}catch{return null}return Tx(e)?e:null}function Ux(n){if(n.length===0)return null;let e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function Bx(n,e){let t=e.split("/").filter(r=>r.length>0).join("/");return n.length===0?t:n+"/"+t}function ZA(n){let e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}function $x(n,e){return e}var tt=class{constructor(e,t,r,i){this.server=e,this.local=t||e,this.writable=!!r,this.xform=i||$x}},rh=null;function jx(n){return!Iy(n)||n.length<2?n:ZA(n)}function eb(){if(rh)return rh;let n=[];n.push(new tt("bucket")),n.push(new tt("generation")),n.push(new tt("metageneration")),n.push(new tt("name","fullPath",!0));function e(s,o){return jx(o)}let t=new tt("name");t.xform=e,n.push(t);function r(s,o){return o!==void 0?Number(o):o}let i=new tt("size");return i.xform=r,n.push(i),n.push(new tt("timeCreated")),n.push(new tt("updated")),n.push(new tt("md5Hash",null,!0)),n.push(new tt("cacheControl",null,!0)),n.push(new tt("contentDisposition",null,!0)),n.push(new tt("contentEncoding",null,!0)),n.push(new tt("contentLanguage",null,!0)),n.push(new tt("contentType",null,!0)),n.push(new tt("metadata","customMetadata",!0)),rh=n,rh}function zx(n,e){function t(){let r=n.bucket,i=n.fullPath,s=new Wt(r,i);return e._makeStorageReference(s)}Object.defineProperty(n,"ref",{get:t})}function qx(n,e,t){let r={};r.type="file";let i=t.length;for(let s=0;s<i;s++){let o=t[s];r[o.local]=o.xform(r,e[o.server])}return zx(r,n),r}function tb(n,e,t){let r=XA(e);return r===null?null:qx(n,r,t)}function Gx(n,e,t,r){let i=XA(e);if(i===null||!Iy(i.downloadTokens))return null;let s=i.downloadTokens;if(s.length===0)return null;let o=encodeURIComponent;return s.split(",").map(l=>{let d=n.bucket,p=n.fullPath,m="/b/"+o(d)+"/o/"+o(p),w=oh(m,t,r),D=QA({alt:"media",token:l});return w+D})[0]}function Wx(n,e){let t={},r=e.length;for(let i=0;i<r;i++){let s=e[i];s.writable&&(t[s.server]=n[s.local])}return JSON.stringify(t)}var nu=class{constructor(e,t,r,i){this.url=e,this.method=t,this.handler=r,this.timeout=i,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}};function nb(n){if(!n)throw Ey()}function Hx(n,e){function t(r,i){let s=tb(n,i,e);return nb(s!==null),s}return t}function Kx(n,e){function t(r,i){let s=tb(n,i,e);return nb(s!==null),Gx(s,i,n.host,n._protocol)}return t}function rb(n){function e(t,r){let i;return t.getStatus()===401?t.getErrorText().includes("Firebase App Check token is invalid")?i=cx():i=ux():t.getStatus()===402?i=ax(n.bucket):t.getStatus()===403?i=lx(n.path):i=r,i.status=t.getStatus(),i.serverResponse=r.serverResponse,i}return e}function ib(n){let e=rb(n);function t(r,i){let s=e(r,i);return r.getStatus()===404&&(s=ox(n.path)),s.serverResponse=i.serverResponse,s}return t}function Qx(n,e,t){let r=e.fullServerUrl(),i=oh(r,n.host,n._protocol),s="GET",o=n.maxOperationRetryTime,a=new nu(i,s,Kx(n,t),o);return a.errorHandler=ib(e),a}function Yx(n,e){let t=e.fullServerUrl(),r=oh(t,n.host,n._protocol),i="DELETE",s=n.maxOperationRetryTime;function o(c,l){}let a=new nu(r,i,o,s);return a.successCodes=[200,204],a.errorHandler=ib(e),a}function Jx(n,e){return n&&n.contentType||e&&e.type()||"application/octet-stream"}function Xx(n,e,t){let r=Object.assign({},t);return r.fullPath=n.path,r.size=e.size(),r.contentType||(r.contentType=Jx(null,e)),r}function Zx(n,e,t,r,i){let s=e.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};function a(){let F="";for(let U=0;U<2;U++)F=F+Math.random().toString().slice(2);return F}let c=a();o["Content-Type"]="multipart/related; boundary="+c;let l=Xx(e,r,i),d=Wx(l,t),p="--"+c+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+d+`\r
--`+c+`\r
Content-Type: `+l.contentType+`\r
\r
`,m=`\r
--`+c+"--",w=sh.getBlob(p,r,m);if(w===null)throw mx();let D={name:l.fullPath},k=oh(s,n.host,n._protocol),S="POST",x=n.maxUploadRetryTime,$=new nu(k,S,Hx(n,t),x);return $.urlParams=D,$.headers=o,$.body=w.uploadData(),$.errorHandler=rb(e),$}var Q2=256*1024;var jA=null,vy=class{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=qs.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=qs.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=qs.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,t,r,i){if(this.sent_)throw Za("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(t,e,!0),i!==void 0)for(let s in i)i.hasOwnProperty(s)&&this.xhr_.setRequestHeader(s,i[s].toString());return r!==void 0?this.xhr_.send(r):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw Za("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw Za("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw Za("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw Za("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}},wy=class extends vy{initXhr(){this.xhr_.responseType="text"}};function Ay(){return jA?jA():new wy}var Gs=class n{constructor(e,t){this._service=e,t instanceof Wt?this._location=t:this._location=Wt.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new n(e,t)}get root(){let e=new Wt(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return ZA(this._location.path)}get storage(){return this._service}get parent(){let e=Ux(this._location.path);if(e===null)return null;let t=new Wt(this._location.bucket,e);return new n(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw vx(e)}};function eF(n,e,t){n._throwIfRoot("uploadBytes");let r=Zx(n.storage,n._location,eb(),new sh(e,!0),t);return n.storage.makeRequestWithTokens(r,Ay).then(i=>({metadata:i,ref:n}))}function tF(n){n._throwIfRoot("getDownloadURL");let e=Qx(n.storage,n._location,eb());return n.storage.makeRequestWithTokens(e,Ay).then(t=>{if(t===null)throw yx();return t})}function nF(n){n._throwIfRoot("deleteObject");let e=Yx(n.storage,n._location);return n.storage.makeRequestWithTokens(e,Ay)}function rF(n,e){let t=Bx(n._location.path,e),r=new Wt(n._location.bucket,t);return new Gs(n.storage,r)}function iF(n){return/^[A-Za-z]+:\/\//.test(n)}function sF(n,e){return new Gs(n,e)}function sb(n,e){if(n instanceof ru){let t=n;if(t._bucket==null)throw gx();let r=new Gs(t,t._bucket);return e!=null?sb(r,e):r}else return e!==void 0?rF(n,e):n}function oF(n,e){if(e&&iF(e)){if(n instanceof ru)return sF(n,e);throw my("To use ref(service, url), the first argument must be a Storage instance.")}else return sb(n,e)}function zA(n,e){let t=e?.[HA];return t==null?null:Wt.makeFromBucketSpec(t,n)}function aF(n,e,t,r={}){n.host=`${e}:${t}`,n._protocol="http";let{mockUserToken:i}=r;i&&(n._overrideAuthToken=typeof i=="string"?i:dc(i,n.app.options.projectId))}var ru=class{constructor(e,t,r,i,s){this.app=e,this._authProvider=t,this._appCheckProvider=r,this._url=i,this._firebaseVersion=s,this._bucket=null,this._host=WA,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=ix,this._maxUploadRetryTime=sx,this._requests=new Set,i!=null?this._bucket=Wt.makeFromBucketSpec(i,this._host):this._bucket=zA(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Wt.makeFromBucketSpec(this._url,e):this._bucket=zA(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){$A("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){$A("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}_getAuthToken(){return y(this,null,function*(){if(this._overrideAuthToken)return this._overrideAuthToken;let e=this._authProvider.getImmediate({optional:!0});if(e){let t=yield e.getToken();if(t!==null)return t.accessToken}return null})}_getAppCheckToken(){return y(this,null,function*(){let e=this._appCheckProvider.getImmediate({optional:!0});return e?(yield e.getToken()).token:null})}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Gs(this,e)}_makeRequest(e,t,r,i,s=!0){if(this._deleted)return new yy(KA());{let o=Cx(e,this._appId,r,i,t,this._firebaseVersion,s);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}makeRequestWithTokens(e,t){return y(this,null,function*(){let[r,i]=yield Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,r,i).getPromise()})}},qA="@firebase/storage",GA="0.13.0";var ob="storage";function ab(n,e,t){return n=ie(n),eF(n,e,t)}function ub(n){return n=ie(n),tF(n)}function cb(n){return n=ie(n),nF(n)}function lb(n,e){return n=ie(n),oF(n,e)}function hb(n=Rn(),e){n=ie(n);let r=Sn(n,ob).getImmediate({identifier:e}),i=hc("storage");return i&&db(r,...i),r}function db(n,e,t,r={}){aF(n,e,t,r)}function uF(n,{instanceIdentifier:e}){let t=n.getProvider("app").getImmediate(),r=n.getProvider("auth-internal"),i=n.getProvider("app-check-internal");return new ru(t,r,i,e,jt)}function cF(){$t(new mt(ob,uF,"PUBLIC").setMultipleInstances(!0)),_e(qA,GA,""),_e(qA,GA,"esm2017")}cF();var iu=class{constructor(e){return e}},fb="storage",by=class{constructor(){return Qr(fb)}};var Dy=new te("angularfire2.storage-instances");function lF(n,e){let t=es(fb,n,e);return t&&new iu(t)}function hF(n){return(e,t)=>{let r=e.runOutsideAngular(()=>n(t));return new iu(r)}}var dF={provide:by,deps:[[new Ue,Dy]]},fF={provide:iu,useFactory:lF,deps:[[new Ue,Dy],zt]};function mB(n,...e){return _e("angularfire",Xt.full,"gcs"),gt([fF,dF,{provide:Dy,useFactory:hF(n),multi:!0,deps:[Pe,Rt,lr,Cn,[new Ue,Zr],[new Ue,cr],...e]}])}var yB=fe(cb,!0);var _B=fe(ub,!0);var vB=fe(hb,!0);var wB=fe(lb,!0);var EB=fe(ab,!0);export{xi as a,Ye as b,Li as c,VF as d,UF as e,BF as f,$F as g,jF as h,TD as i,bD as j,OD as k,eL as l,tL as m,TL as n,DS as o,AL as p,sr as q,iR as r,Yt as s,Iw as t,zL as u,qL as v,GL as w,PC as x,kC as y,An as z,KL as A,mE as B,ie as C,mt as D,ar as E,Zo as F,Rf as G,CP as H,$t as I,jt as J,yc as K,kf as L,_e as M,OE as N,ME as O,UP as P,DV as Q,SV as R,ca as S,wU as T,EU as U,IU as V,TU as W,AU as X,bU as Y,DU as Z,SU as _,kO as $,un as aa,BU as ba,M as ca,Oe as da,He as ea,B as fa,jU as ga,Es as ha,AM as ia,ce as ja,lA as ka,xe as la,hA as ma,bM as na,ay as oa,DM as pa,dA as qa,GU as ra,et as sa,SM as ta,RM as ua,CM as va,PM as wa,NM as xa,kM as ya,OM as za,MM as Aa,Fs as Ba,Cr as Ca,ja as Da,AA as Ea,bA as Fa,LM as Ga,VM as Ha,UM as Ia,BM as Ja,$M as Ka,jM as La,zM as Ma,Wl as Na,Pr as Oa,_s as Pa,Nr as Qa,GM as Ra,RA as Sa,WM as Ta,HM as Ua,CA as Va,KM as Wa,QM as Xa,PA as Ya,NA as Za,kA as _a,OA as $a,YM as ab,JM as bb,nh as cb,FT as db,ZM as eb,ex as fb,MA as gb,xA as hb,FA as ib,tx as jb,Xa as kb,R2 as lb,C2 as mb,P2 as nb,N2 as ob,k2 as pb,O2 as qb,M2 as rb,x2 as sb,F2 as tb,L2 as ub,V2 as vb,U2 as wb,B2 as xb,$2 as yb,j2 as zb,z2 as Ab,lb as Bb,iu as Cb,mB as Db,yB as Eb,_B as Fb,vB as Gb,wB as Hb,EB as Ib};
